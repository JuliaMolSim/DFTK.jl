<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analysing SCF convergence · DFTK.jl</title><meta name="title" content="Analysing SCF convergence · DFTK.jl"/><meta property="og:title" content="Analysing SCF convergence · DFTK.jl"/><meta property="twitter:title" content="Analysing SCF convergence · DFTK.jl"/><meta name="description" content="Documentation for DFTK.jl."/><meta property="og:description" content="Documentation for DFTK.jl."/><meta property="twitter:description" content="Documentation for DFTK.jl."/><meta property="og:url" content="https://docs.dftk.org/stable/examples/analysing_scf_convergence/"/><meta property="twitter:url" content="https://docs.dftk.org/stable/examples/analysing_scf_convergence/"/><link rel="canonical" href="https://docs.dftk.org/stable/examples/analysing_scf_convergence/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">General Tutorial</a></li><li><a class="tocitem" href="../../guide/tutorialmath/">Mathematical Tutorial</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../pseudopotentials/">Pseudopotentials</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../energy_cutoff_smearing/">Energy cutoff smearing</a></li><li><a class="tocitem" href="../hubbard/">Hubbard correction (DFT+U)</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../elastic_constants/">Elastic constants</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../phonons/">Phonon computations</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../../ecosystem/atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../../ecosystem/atomscalculators/">AtomsCalculators integration</a></li><li><a class="tocitem" href="../../ecosystem/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../ecosystem/atomistic_simulation_environment/">Atomistic simulation environment (ASE)</a></li><li><a class="tocitem" href="../../ecosystem/wannier/">Wannierization using Wannier.jl or Wannier90</a></li></ul></li><li><span class="tocitem">Tips and tricks</span><ul><li><a class="tocitem" href="../../tricks/achieving_convergence/">Achieving DFT convergence</a></li><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/gpu/">Using DFTK on GPUs</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../../tricks/compute_clusters/">Using DFTK on compute clusters</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li><li class="is-active"><a class="tocitem" href>Analysing SCF convergence</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Theoretical Background</span><ul><li><a class="tocitem" href="../../guide/periodic_problems/">Periodic problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/discretisation/">Comparing discretization techniques</a></li><li><a class="tocitem" href="../../guide/atomic_chains/">Modelling atomic chains</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Introduction to density-functional theory</a></li><li><a class="tocitem" href="../../guide/self_consistent_field/">Self-consistent field methods</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/setup/">Developer setup</a></li><li><a class="tocitem" href="../../developer/testsystem/">Unit test system</a></li><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/style_guide/">Developer&#39;s style guide</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li><li><a class="tocitem" href="../../developer/gpu_computations/">GPU computations</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li><li><a class="tocitem" href="../../research/">Research conducted with DFTK</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Analysing SCF convergence</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analysing SCF convergence</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/analysing_scf_convergence.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Analysing-SCF-convergence"><a class="docs-heading-anchor" href="#Analysing-SCF-convergence">Analysing SCF convergence</a><a id="Analysing-SCF-convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Analysing-SCF-convergence" title="Permalink"></a></h1><p>The goal of this example is to explain the differing convergence behaviour of SCF algorithms depending on the choice of the mixing. For this we look at the eigenpairs of the Jacobian governing the SCF convergence, that is</p><p class="math-container">\[1 - α P^{-1} \varepsilon^\dagger \qquad \text{with} \qquad \varepsilon^\dagger = (1-\chi_0 K).\]</p><p>where <span>$α$</span> is the damping <span>$P^{-1}$</span> is the mixing preconditioner (e.g. <a href="../../api/#DFTK.KerkerMixing"><code>KerkerMixing</code></a>, <a href="../../api/#DFTK.LdosMixing-Tuple{}"><code>LdosMixing</code></a>) and <span>$\varepsilon^\dagger$</span> is the dielectric operator.</p><p>We thus investigate the largest and smallest eigenvalues of <span>$(P^{-1} \varepsilon^\dagger)$</span> and <span>$\varepsilon^\dagger$</span>. The ratio of largest to smallest eigenvalue of this operator is the condition number</p><p class="math-container">\[\kappa = \frac{\lambda_\text{max}}{\lambda_\text{min}},\]</p><p>which can be related to the rate of convergence of the SCF. The smaller the condition number, the faster the convergence. For more details on SCF methods, see <a href="../../guide/self_consistent_field/#Self-consistent-field-methods">Self-consistent field methods</a>.</p><p>For our investigation we consider a crude aluminium setup:</p><pre><code class="language-julia hljs">using AtomsBuilder
using DFTK

system_Al = bulk(:Al; cubic=true) * (4, 1, 1)</code></pre><pre><code class="nohighlight hljs">FlexibleSystem(Al₁₆, periodicity = TTT):
    cell_vectors      : [    16.2        0        0;
                                0     4.05        0;
                                0        0     4.05]u&quot;Å&quot;
</code></pre><p>and we discretise:</p><pre><code class="language-julia hljs">using PseudoPotentialData

pseudopotentials = PseudoFamily(&quot;dojo.nc.sr.lda.v0_4_1.standard.upf&quot;)
model_Al = model_DFT(system_Al; functionals=LDA(), temperature=1e-3,
                     symmetries=false, pseudopotentials)
basis_Al = PlaneWaveBasis(model_Al; Ecut=7, kgrid=[1, 1, 1]);</code></pre><p>On aluminium (a metal) already for moderate system sizes (like the 8 layers we consider here) the convergence without mixing / preconditioner is slow:</p><pre><code class="language-julia hljs"># Note: DFTK uses the self-adapting LdosMixing() by default, so to truly disable
#       any preconditioning, we need to supply `mixing=SimpleMixing()` explicitly.
scfres_Al = self_consistent_field(basis_Al; tol=1e-12, mixing=SimpleMixing());</code></pre><pre><code class="nohighlight hljs">n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime 
---   ---------------   ---------   ---------   ----   ------
  1   -36.73472817766                   -0.88   12.0    1.32s
  2   -36.43586123219   +   -0.52       -1.27    1.0    283ms
  3   +121.7043629441   +    2.20        0.04   20.0    372ms
  4   -33.99025116023        2.19       -0.76   10.0    291ms
  5   -35.35009863882        0.13       -0.92    3.0    152ms
  6   -29.59204332180   +    0.76       -0.63    5.0    166ms
  7   -36.70348058402        0.85       -1.50    3.0    148ms
  8   -36.72626020289       -1.64       -1.80    2.0    110ms
  9   -36.73601706903       -2.01       -1.94    2.0    104ms
 10   -36.74135215704       -2.27       -2.19    1.0   96.3ms
 11   -36.73884163219   +   -2.60       -2.17    3.0    136ms
 12   -36.74173361769       -2.54       -2.40    1.0   97.7ms
 13   -36.74178469867       -4.29       -2.41    1.0   94.0ms
 14   -36.74231081779       -3.28       -2.59    2.0    107ms
 15   -36.71335467707   +   -1.54       -1.82    4.0    164ms
 16   -36.71125981629   +   -2.68       -1.79    4.0    159ms
 17   -36.73632509284       -1.60       -2.05    3.0    149ms
 18   -36.74054211467       -2.37       -2.38    2.0    125ms
 19   -36.74232554930       -2.75       -2.88    3.0    116ms
 20   -36.74246802278       -3.85       -3.36    2.0    107ms
 21   -36.74240944643   +   -4.23       -2.91    3.0    144ms
 22   -36.74245153789       -4.38       -3.26    2.0    125ms
 23   -36.74247980310       -4.55       -3.84    2.0    113ms
 24   -36.74247878707   +   -5.99       -3.85    3.0    136ms
 25   -36.74248019869       -5.85       -3.97    1.0   97.6ms
 26   -36.74248063072       -6.36       -4.56    2.0    109ms
 27   -36.74248008719   +   -6.26       -4.06    3.0    150ms
 28   -36.74248062054       -6.27       -4.64    2.0    122ms
 29   -36.74248060916   +   -7.94       -4.66    2.0    119ms
 30   -36.74248067143       -7.21       -5.22    3.0    217ms
 31   -36.74248067230       -9.06       -5.33    3.0    134ms
 32   -36.74248066069   +   -7.94       -4.99    3.0    1.09s
 33   -36.74248066729       -8.18       -5.06    3.0    134ms
 34   -36.74248067039       -8.51       -5.32    2.0    119ms
 35   -36.74248067242       -8.69       -5.73    2.0    102ms
 36   -36.74248067255       -9.88       -5.92    4.0    132ms
 37   -36.74248067259      -10.44       -5.99    1.0   93.1ms
 38   -36.74248067263      -10.35       -6.17    1.0   93.2ms
 39   -36.74248067268      -10.35       -6.56    2.0    108ms
 40   -36.74248067268   +  -11.56       -6.62    3.0    138ms
 41   -36.74248067267   +  -12.08       -6.61    2.0    109ms
 42   -36.74248067268      -11.14       -7.36    2.0    102ms
 43   -36.74248067268   +  -12.63       -7.26    3.0    161ms
 44   -36.74248067268      -12.57       -7.71    2.0    143ms
 45   -36.74248067268   +  -13.37       -7.51    2.0    143ms
 46   -36.74248067268      -13.30       -8.30    2.0    129ms
 47   -36.74248067268      -14.15       -8.20    3.0    136ms
 48   -36.74248067268      -13.85       -8.37    2.0    111ms
 49   -36.74248067268   +    -Inf       -8.61    2.0    104ms
 50   -36.74248067268   +  -14.15       -8.48    3.0    126ms
 51   -36.74248067268   +    -Inf       -8.42    3.0    133ms
 52   -36.74248067268   +    -Inf       -8.46    1.0    100ms
 53   -36.74248067268   +    -Inf       -8.93    3.0    118ms
 54   -36.74248067268   +    -Inf       -9.15    3.0    129ms
 55   -36.74248067268   +    -Inf       -9.58    2.0    128ms
 56   -36.74248067268   +    -Inf       -9.43    2.0    124ms
 57   -36.74248067268   +    -Inf       -9.46    2.0    111ms
 58   -36.74248067268      -14.15       -9.53    2.0    109ms
 59   -36.74248067268   +  -14.15       -9.72    2.0    110ms
 60   -36.74248067268   +    -Inf       -9.87    1.0   98.0ms
 61   -36.74248067268      -13.85       -9.92    2.0    145ms
 62   -36.74248067268   +  -13.85      -10.50    2.0    104ms
 63   -36.74248067268   +    -Inf      -10.00    3.0    147ms
 64   -36.74248067268   +    -Inf      -10.23    3.0    127ms
 65   -36.74248067268   +  -14.15      -10.11    3.0    139ms
 66   -36.74248067268   +    -Inf      -10.24    2.0    120ms
 67   -36.74248067268      -14.15      -10.51    2.0    123ms
 68   -36.74248067268   +    -Inf      -10.66    2.0    103ms
 69   -36.74248067268   +    -Inf      -11.28    2.0    103ms
 70   -36.74248067268      -13.85      -11.29    3.0    146ms
 71   -36.74248067268   +  -13.85      -11.55    2.0   98.9ms
 72   -36.74248067268   +    -Inf      -11.76    2.0    113ms
 73   -36.74248067268      -14.15      -11.55    3.0    140ms
 74   -36.74248067268   +  -14.15      -12.13    2.0    109ms
</code></pre><p>while when using the Kerker preconditioner it is much faster:</p><pre><code class="language-julia hljs">scfres_Al = self_consistent_field(basis_Al; tol=1e-12, mixing=KerkerMixing());</code></pre><pre><code class="nohighlight hljs">n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime 
---   ---------------   ---------   ---------   ----   ------
  1   -36.73406546836                   -0.88   12.0    945ms
  2   -36.74042648682       -2.20       -1.37    1.0    646ms
  3   -36.74196696666       -2.81       -2.12    5.0    130ms
  4   -36.74205605817       -4.05       -2.03    3.0    130ms
  5   -36.74243049046       -3.43       -2.58    1.0   98.7ms
  6   -36.74245314558       -4.64       -2.59    2.0   97.0ms
  7   -36.74247344843       -4.69       -3.22    2.0    102ms
  8   -36.74247953411       -5.22       -3.53    5.0    139ms
  9   -36.74248042085       -6.05       -3.68    2.0    103ms
 10   -36.74248045879       -7.42       -3.98    2.0    103ms
 11   -36.74248062424       -6.78       -4.44    3.0    119ms
 12   -36.74248066796       -7.36       -4.77    3.0    139ms
 13   -36.74248066983       -8.73       -5.02    3.0    120ms
 14   -36.74248067231       -8.60       -5.14    3.0    134ms
 15   -36.74248067259       -9.55       -5.71    1.0   99.3ms
 16   -36.74248067267      -10.12       -5.80    4.0    146ms
 17   -36.74248067268      -11.05       -6.28    1.0   95.3ms
 18   -36.74248067268      -11.93       -6.55    5.0    141ms
 19   -36.74248067268      -11.92       -6.72    1.0   95.3ms
 20   -36.74248067268      -12.44       -7.00    4.0    116ms
 21   -36.74248067268      -12.81       -7.59    3.0    131ms
 22   -36.74248067268   +  -13.85       -7.86    2.0    130ms
 23   -36.74248067268   +  -14.15       -8.11    2.0    105ms
 24   -36.74248067268      -14.15       -8.09    3.0    132ms
 25   -36.74248067268   +  -14.15       -8.56    2.0    103ms
 26   -36.74248067268      -13.67       -8.77    3.0    141ms
 27   -36.74248067268   +  -14.15       -9.26    1.0    100ms
 28   -36.74248067268   +  -14.15       -9.08    3.0    144ms
 29   -36.74248067268   +    -Inf       -9.54    2.0    114ms
 30   -36.74248067268      -13.85      -10.10    3.0    133ms
 31   -36.74248067268   +    -Inf      -10.40    3.0    135ms
 32   -36.74248067268   +  -13.85      -10.64    2.0    114ms
 33   -36.74248067268   +    -Inf      -10.90    2.0    133ms
 34   -36.74248067268   +    -Inf      -11.21    2.0    103ms
 35   -36.74248067268   +    -Inf      -11.46    2.0    114ms
 36   -36.74248067268   +  -13.85      -11.88    2.0    226ms
 37   -36.74248067268      -13.85      -12.17    2.0    104ms
</code></pre><p>Given this <code>scfres_Al</code> we construct functions representing <span>$\varepsilon^\dagger$</span> and <span>$P^{-1}$</span>:</p><pre><code class="language-julia hljs"># Function, which applies P^{-1} for the case of KerkerMixing
Pinv_Kerker(δρ) = DFTK.mix_density(KerkerMixing(), basis_Al, δρ)

# Function which applies ε† = 1 - χ0 K
function epsilon(δρ)
    δV   = apply_kernel(basis_Al, δρ; ρ=scfres_Al.ρ)
    χ0δV = apply_χ0(scfres_Al, δV).δρ
    δρ - χ0δV
end</code></pre><pre><code class="nohighlight hljs">epsilon (generic function with 1 method)</code></pre><p>With these functions available we can now compute the desired eigenvalues. For simplicity we only consider the first few largest ones.</p><pre><code class="language-julia hljs">using KrylovKit
λ_Simple, X_Simple = eigsolve(epsilon, randn(size(scfres_Al.ρ)), 3, :LM;
                              tol=1e-3, eager=true, verbosity=2)
λ_Simple_max = maximum(real.(λ_Simple))</code></pre><pre><code class="nohighlight hljs">44.02450283931571</code></pre><p>The smallest eigenvalue is a bit more tricky to obtain, so we will just assume</p><pre><code class="language-julia hljs">λ_Simple_min = 0.952</code></pre><pre><code class="nohighlight hljs">0.952</code></pre><p>This makes the condition number around 30:</p><pre><code class="language-julia hljs">cond_Simple = λ_Simple_max / λ_Simple_min</code></pre><pre><code class="nohighlight hljs">46.24422567155012</code></pre><p>This does not sound large compared to the condition numbers you might know from linear systems.</p><p>However, this is sufficient to cause a notable slowdown, which would be even more pronounced if we did not use Anderson, since we also would need to drastically reduce the damping (try it!).</p><p>Having computed the eigenvalues of the dielectric matrix we can now also look at the eigenmodes, which are responsible for the bad convergence behaviour. The largest eigenmode for example:</p><pre><code class="language-julia hljs">using Statistics
using Plots
mode_xy = mean(real.(X_Simple[1]), dims=3)[:, :, 1, 1]  # Average along z axis
heatmap(mode_xy&#39;, c=:RdBu_11, aspect_ratio=1, grid=false,
        legend=false, clim=(-0.006, 0.006))</code></pre><img src="data:image/png;base64,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vZA8y2QyBw4c+FR+gvGxY8ei0ejHTG8dpFKpVHNzc11dXf8f+qtf/er999//8dsMiER45MiRT1N1SSKRiEQihV5F/mVLYQOBQKEXkn+f1lOWTqd9Ph+nbBBJpVKBQKBzdMGnSaFO2ciRI4uKij5+mwGRCAEAKJRP4e8dAAB0HYkQAGA1EiEAwGokQgCA1fIwod5yhw4devvttw8fPnzNNdecWc+9Z8+ef/u3f0smkzfffPOkSZMKuMKeOX78+K9//et33nmnvLx83rx5EyZM6Pynl19++eWXX66pqbn99tsrKioKuMieeemll95+++3Tp0/X19cvWLCgrKwsG29qalq2bNnx48e/9KUvNTY2FnaRvbFt27aNGzfOnz9/6NCh2cj69etffPHFysrK2267raamprDL64FnnnkmHo9nvx4zZsysWbOyX+/bt+/pp59ub2+/6aabJk+eXLgF9pzjOL/4xS82b948bNiwefPmTZw40Rjjuu4vf/nLDRs2fOYzn/nGN77xiUWPA82HH374yiuvnBmZO3du9sJ77733nn32WWPMLbfccsEFFxRmfTl4R9hbU6ZMeeihhxYvXrxjx47O4L59+yZPnpxMJocOHXrFFVcMxg8PvPfee1966aXq6uqWlpYpU6Z0XtY/+9nPbrvttjFjxuzYsWPatGnJZLKw6+yBZ599NhQKjRkzZsWKFVOnTs2+wp4+fbqhoWHv3r2jR4++8cYbV6xYUehl9tDp06dvvfXWO+6448iRI9nIihUr5s2bd8455+zbt6+hoaG1tbWwK+yBe++9d/PmzR988MEHH3zQ3NycDTY1NU2ePPnUqVNVVVWzZs1av359YRfZA47jzJ49+/HHH6+rq8tkMm+++WY2vmTJku9+97v19fWrVq2aM2dOYRfZA21tbR/8wdq1a//iL/4i2xDy3nvvTZ06NRQKRSKRSy+9dOfOnYVe6R+46B3HcVzXHTdu3K9+9avO4H333bdgwYLs19/5znfmz59fmMX1QiwW6/x68eLFN910k+u6mUymvr7+hRdeyH594YUX/uIXvyjYEnstlUqVlpa++eabrus++eST06ZNy8aXLVs2efLkgi6t5775zW8+8cQTxphdu3ZlI1OmTPnXf/3X7NeNjY1PPPFE4VbXQyNGjOh8OJ2++93vXn/99dmvH3rooeuuu67f19VbP/3p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" /><p>This mode can be physically interpreted as the reason why this SCF converges slowly. For example in this case it displays a displacement of electron density from the centre to the extremal parts of the unit cell. This phenomenon is called charge-sloshing.</p><p>We repeat the exercise for the Kerker-preconditioned dielectric operator:</p><pre><code class="language-julia hljs">λ_Kerker, X_Kerker = eigsolve(Pinv_Kerker ∘ epsilon,
                              randn(size(scfres_Al.ρ)), 3, :LM;
                              tol=1e-3, eager=true, verbosity=2)

mode_xy = mean(real.(X_Kerker[1]), dims=3)[:, :, 1, 1]  # Average along z axis
heatmap(mode_xy&#39;, c=:RdBu_11, aspect_ratio=1, grid=false,
        legend=false, clim=(-0.006, 0.006))</code></pre><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAGQCAIAAAD9V4nPAAAABmJLR0QA/wD/AP+gvaeTAAAgAElEQVR4nO3de3zU1Z3/8TMzuUzuN3InEUiCyE0Uwn0BC3gtVrFaW7Vb1K7bh+tlF+tj99Hdrl1Xl4du1bZqt+1qXVfbbqku2v5A0cJyFwIICKJgIBByhRDI/TYzvz+mTanf90hIJgzxvJ5/hQ+T8z3z/Z7v+czA+XyPKxAIGAAAbOWOdAcAAIgkEiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAahdEInziiSdqa2sj3QsAgI0uiET4+uuvHzlyJNK9AADY6IJIhAAARAqJEABgNRIhAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWI1ECACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAaiRCAIDVSIQAAKuRCAEAViMRAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWI1ECACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAaiRCAIDVSIQAAKuRCAEAViMRAgCsFjXwJqqrq3/729+Wl5fHx8cvXLhw1qxZvX+1evXqd999Nysr6+67705NTR34sQAACK8wfCN877333n///by8PJ/Pd/311//0pz8Nxl944YUlS5bk5+eXlZXNmTOnp6dn4McCACC8XIFAIIzN/fCHP3zttdfWrVvn9/tHjx791FNPXX/99X6/f/z48Y8++uhNN90kf2v69Ok/+MEPpk2bFsaeAADQF+H8P8Lu7u7t27ePHz/eGHPs2LFDhw4tXLjQGON2uxcsWLBu3bowHgsAgLAIw/8RGmM++uij6667rq6ubtKkSatXrzbG1NbWJiYmxsXFBV+QlZW1a9euUL9eX1+/bNmyrKys4B9zc3MfeeSRsHQMAIDPFp5vhCUlJWVlZRs2bIiLi7vvvvuMMVFRUT6fr/cFPT09MTExoX7d6/WOGTNm8h9deumlYekVAABnFZ5vhB6PJz09PT09/fHHH587d+4LL7yQl5fX1tZ26tSp4GLRqqqqvLy8UL+enJx8ww038H+EAIDzLwzfCNvb23t/3rlzZ0FBgTEmJydnypQpy5cvN8a0trauWrVq0aJFAz8WAADhFYZvhN/4xjeOHz9+0UUXVVVV7dix4xe/+EUw/vjjj3/1q1/dsmXLrl27pkyZMmfOnIEfCwCA8ApD+UR7e/t7771XVVWVkZExc+bMlJSU3r86evTo+vXr8/Ly5s2b53aH/PZJ+QQAIFLC8I0wLi7uiiuukH9VWFh4++23D/wQAAAMEp41CgCwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAaiRCAIDVSIQAAKuRCAEAViMRAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWI1ECACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALBaVKQ7YIwxU0flTqx9r/2N9z4Vd8UlOl8clTXcGXRl5MmWfYlZzmBnbLIz2NjucwYb2ntks8eaOlQL3c6g2+1yBrMSYmSz+UmxzmCaV1yjtDiPMxjVckI2626udwb9xyudQd+JGmcw0NOlm01KE33ILhAtpOaKYyWJS2OMaXWJkyCvzvE2ccKrmjpls81d4lJ6o8QHwdxE0YGcRH3J0rziQqREB5xBeRU8KmiM6ak96gz6GvWLRbNp+txG5RSKZtWF8Kvg6W4xmI0xjR3i6tS2iGFT0yKuTkePXzabFCNGfn6yuDqZ8dHOoLxHjDEJAdEHeSFcp8Tt0FMnbhxjjL+5UbQQJYaNZ5i4HdyZ4sYxIS5ET+IwZ1DeI40degarahYnob5VXDK/XwzmtDhxwo0xw5O9zmBGXF9nsNjOJtmsp0VcnUBDtTPYU3/MGfReeZds9kx8IwQAWI1ECACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFa7IOoI26pPHHjlLWc8PlPUEWZOKnEGEy6dKlt2jUhwBnuik5zBk6rgZnv1adnspk8anMGKumZn0O0RHzXGF6TKZmeNSncGL80RvU1V5Wuudt3bnsN7ncHTO3c4gw37DjuD3apczxiTVCCKmbKmjHEGveNnOIOuuBTZbKdLlF5VN4sKp23HTjmDWz7RxZTHG9udwfh4cawpI8VVmDFCFE0aY8ZmigGW4hEVXZ5WMWY695fJZhu273EGT30iCqek1GJdVpsxZaIzGDtuujPoT8hwBtt6dGVeuTq3WypEXd32wydFs226UDUzLc4ZnFEsRt3U4eKGio8WNW3GmERVR+g6WeUMduzd4gzWb/9INttcKQZetCpwzBg30hlMuXyybNZTIuKBBHESmrrEqNtb3yKb3XRIXIi9leKG8vtEleeIbDEpGWNmFYthU5ov7vSkWDExertaZbP+6nJnsHX3Nmfw+K6DzmAJdYQAAHw2EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArHZBlE9U1rW8sEFsn3GRWnw880OxJcclLr1BTFL2Rc5glzfbGfzohFi5u7xM9MoYs3/rJ85gw0GxFN6j1nBXTpwlmz3dJnbJGaaW+Bckq12BGvXy+obNYhX4h78Qvd14WKyfPtUtlmUbYyaoLVdK1SLykth4ZzAqc4Rsts0tChJ214r9WV7bWOEMlpeJwgNjTFPVx86gNy3HGay+XJTi+PwjZLP5SeIk5EaLUpzuygPOYNXqTbLZvctFxcvmhjb5YqeZGUdkfPxJUeFTkCzKRcywUc7YabH5mDHGbDwkKkP+34YKZ/DoTrHkvaOxVjabnH+xM1hdqipA5one5iXpnbOG+cVp7Dq42xks/9+NzmDZOxWy2Q/U1myp0aLgZPYocZ+O7dA1JFlqz6bAsCJnUG5AtnKvPrebt4h9vmr3iNHo6xbvq7ykVDZbPa3YGUyKFVkmN1HM7e4QBWDNe8Rktf8Xorebd4ids5Y+L1v980Of/SUAAHx+kQgBAFYjEQIArEYiBABYjUQIALAaiRAAYLULonzCHzBd/oAzfrBFLCluek88Jz5tlFhuboxJnDrXGexKFvtXfFAtFugf2CkWGRtj6j5YJ+NOPR1irfaRTb+VL45LuMkZ/IuSTGdwWr7Yl6OnRi+aP7pmvzP4m/16l4a+K1N7Dhi1uDxjrHhgf86UBbLZNo94gP2GA6K3BzaLRdVNVaJKIZTWenF9D6wR9TnJ6TfLFuYUid5eEi8Gc8dhUb/xyUoRNMa8Vac3DeijUL/uVYfLmjxavHLifGewpkWUhRhjNuyrcwYPrPmdM+jrClGBoTRWfCCa7RZFAhvykp3BuSNUWYgxbp8olDq5RwxRWSmhh30ItT5xxn7zoRjM31A3qTEmvVTc1IHi2c7gYdWx9/fo8olQU1AfhZoAPdGiZOUDtanOrAKxJUXg9HHZbO0WMb2/pRJBXaceomfFN0IAgNVIhAAAq5EIAQBWIxECAKxGIgQAWC1sibCxsbGrSyzyPH78eGenWOgFAMCFIAzlE88999y//uu/dnd3t7e3X3PNNS+99FJiYqIxpqKi4sYbb6yvr29tbX300Ufvu+++gR/LhFggW79Pr7sd1dToDPaoUo0DteLB/PX79OYAg6S+vNwZrGwUT5oXb8AY30m9VLoyxMkZDHJx+fRPxELnXLUO3hjT7BObXRxVxS3nVCnRd3KJf32l6IAxpqGtW0T9Yi+U5qOixmBHzYDKJM6VPNwE1TGvX1yFhjY57vTJOadKib6TF/1otdgMoblL75ri8ouOnVJD9JwqJQYo1E06Qd3U8jJUNopKLTmlDB45YR6YLWYwOQn71XRtQkzv/a6UkMLwjTA3N3f9+vUnTpyorq4+duzYY489FowvXbp0zpw5VVVVW7du/c53vlN+fi8JAAB9EYZEuHjx4pKSEmNMSkrKVVdddfDgQWPM6dOn33zzzQcffNAYc/HFF1911VWvvvrqwI8FAEB4hXOxTFdX14oVK+bPn2+MqaysdLvdI0eODP7VxRdffPjw4VC/6FP/GgYAwHkQtkQYCATuu+++jIyMv/qrvzLGNDU1xcf/aV/yhISEU6fE7udBJ04M9HFfAAD0T9gS4dKlS3ft2rVixQqPx2OMyczMbG5u9vv9wb89depUVlZWqN/Nzs4OVzcAADgn4UmE3/nOd9auXbtq1ark5D88/bawsDAxMXHnzp3BP5aVlU2YMCEsxwIAIIzCUD6xbNmyZ5555vvf//7vf/97Y0xGRsYXvvCF2NjYO++88+GHH37++ec3bty4a9eu1157beDHAgAgvMKQCAOBwHXXXbdmzZrgH0ePHv2FL3zBGPP444//0z/901e+8pXc3NxVq1alpaUN/FihdJzSRWkBVaymKlhMU7soCOvpFKU5g6ezqcEZbO1zuYyvXZ+EkyEKqs6bzmbxpAWjKtWMMd0Bv2hBluudR52teiR09ojeugLiH1p6WkX52omucNZCnZU8nOyYKyBuEvlmTeiTc97I4dHt0701coDJIXoehbpJ5U0tylRDTBRyShk8csKUU6uchOV0bUJP72EUhkT4D//wDzLu9XqffPLJJ598cuCHAABgkPCsUQCA1UiEAACrkQgBAFYjEQIArEYiBABYLQyrRi8E3tRYGXdFi7hbrT5Ojot2BqNi451BM2hlFbHJGc5gQmxfr5EnTp+E9BhP//sUDrFJMSLq1r2KdosPZ7Hx4uqcT7EJeiTERoneBlxihEUleJ3BYTH64laqFecDJw8nOybfgnyzJvTJOW/k8Ij2hPiU71cDTA7R8yjUTSpvalkXIicKOaUYY1qPV/a9b30nJ0w5tcpJWE7XJvT0HkZ8IwQAWI1ECACwGokQAGA1EiEAwGokQgCA1UiEAACrDb3yiWy1SjhrXKZ8sTtZbHkRpZbujs5JcgbLxs2SzVbvfOezuthfWUVFzmBBmliRLB8/70nPkc0WyJNT33ouXeur0rQ4ZzC1ON8ZDIRYKp3kEevIC/OSncGD+aOdwaaqA2fp4tl4YkQ5QVaB6IAxJkPWdbjFo/WTCsXu05NzE2WzlYcaP6OH/SYPJzsmi1sy4uW40yfnqDqNvi6x08U5SVYXXQ6PpBAFCQGf6JgcoqVp5c5gWWP7WbrYL/omDXFTq50b9EQhpxRjzMnyXX3vW99lqQlTTq1yEpbTtQkxvWfvrncG6/q8V8+nD92/XwMA4POBRAgAsBqJEABgNRIhAMBqJEIAgNVIhAAAq10Q5RNul4lRq2kvUmvTZ07OdQZzZoyXLbtSxLrbGI841gS1Anv05YWyWV/3XGew4WCZM+iJFmu1cybqqozLJoql0iNVQYJL7m+Qe5FstvALlziDX65tcQY3Hj7lDJ7q9slmJySLt1a6cIQzmD5xjDPoj0mQzcar3Sf+YvQwZ7ByZqkzWF6mqzKaqj52Br1p4oQXXj5VdGCcqjEwJjdRbd3gEWu4Y0de7AwWX6uLPa5evtcZ3NzQ1z1PZmbo7SCKrxV9kB0LeMStl5uopwt5cppOftEZPLpzmzPY0Vgrm03OFx0rKp0oOqCGR3y0/pTv94iBJ4do6cKj4vffqZDNftAkKkNSo0UJx+xRqc6gvElNiJvap25/OVHIKcUY0966yBms3bNJHKtbvK+MEnHrmRATppxa5SQsp2sTYnq/+pCYrDbvqJEtnBXfCAEAViMRAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNUuiDrCguzEu8aLepf4TLFrTOakEmcwYaKua/HHpTiDsoRlzDBRXXRz6XDZ7CZVslNx2Qhn0O0RHzXGF4hCImPMrFHpzmB+siiM09vhpOXJcMbMGc7gRG+MONa+w85gd1u3bDapQBRvZU0R9VgxJZc6g74YXesW7xJn7NIcUYrUOXuEM7glR29sdLzxMnGseHESpowUV2HGCL1BTIpX7fWjPl5GF4j9g/Kv1BWl3nSxc03xJ9XyxU6pxSFGwhRRhCc71u0WM4N+s8bMHpXhDHpUPej2QjHy29q6ZLOZ6i6bUSxGnRweoeoIAwEx8OQQLbpRFG7KYW+MKa084QxGq0rojHEjncGUyyfLZuVNLW9/OVFcq+ZVY0yKGvl7VTmm3+d3Bkdki/FpjJlVLEaCnFrlJCynaxNier8kIHajGjb2oGzhrPhGCACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFa7IMon4vOGjf7KPGfcFSeWwkdliZIGV4ZeL+5Te/1EqS2f0r3iVEzJ08t5cxLFSuXGdlFm4FbHykoQa5eNMflJotnkGLFmXW3DYgIhFh9HjRSbmKQlihcnjxWbmAR69Op2d5KoKIjKLhAtpIqdswJRer+kWPXe8pLEGZt1kejAiDRdldHcJbZG8kaJD4K56uLmJOpLFh+lroRbXDJfglhZHnuJLvvJShMbG2VMqZcvdvKkZcl4VI7YJUd2TL4F/WaNKVJ1DglqB6JxuWLZfUePWKBvjEmKEbekLBLIVFUKsSF6GwiIFgLp+c6gV22Xlpett2bzNzc6g64oMWw8w8Tt4M4UN44JUVEgb385UYzP0tVEaXHijE1VNUJ+v6hSkL9ujBmutmaTU6uchAMhtmbz5BU5g4mxYtR5R4hX9gXfCAEAViMRAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqF0T5hNubEDW8WMRjxWJck6jW+IbYyiDgEW9QrqqWT0NPUiuSjTH5apVwilol7FYrnVNi9WmXz8uPVh2TAh69pjkQK5ZQyzXcLrUi2fTo3Sdc8eoJ9Alie4FAtLqOapcJY4xHnTGvWgqf1ucTboxp7/Y5gzFqbxB5HeNUoYUJtQpcvVKWi/i9YtsEY0xUtqgRcifoR/6LV6ramFCHkx0LqLtEvlkT4uRkqhohecK71P4Gxpg4VYCREiuCcnjIgWSMkZ/+5RB1JYp9SKJCjNtAsnixiRK3pDtJ3CN+dZOa0De1k5woQm3BIWuE4tUJ96tNHhJVZYsJMWHKqVVeGzldmxDTuzs10xmMjupnRuMbIQDAaiRCAIDVSIQAAKuRCAEAViMRAgCsRiIEAFjtgiif8He09hz7xBkPsfuE2EbAHapyIEa0EFBvussnVgk3d4k198aYqqYOZ3CQdp+IVSvOJZcvRJ1DZ4sz6DshNpqQwXPcfUIshXfJjSa8etG8T1UfdPSIYGOHGAlVTZ2y2XPYfcIneusJsfuEXLjv8ojeunpEx9wdTbLZnrpjzqCvceC7T/S5ckBdhRC7RJh29RfHW8WwqWkRJ+Gcdp/wq90notzi9o+LlmUsxgTUEO0Wd7RpOemM9dRVylYHvPuEnopdIQrDnLrVDNbWrc+tvBD16pKd0+4TLlVXJssn5LVx+cRNaoxxd7WJFk4ddwZ76sWN4xG77zgOcfaXAADw+UUiBABYjUQIALAaiRAAYDUSIQDAaiRCAIDVSIQAAKtdEHWEbdUnDrzyljMenymqADMnlTiDCZdOlS27RiQ4gz3RYjubk6oobXv1adnspk8anMGKumZn0K2qAMcXiH1YjDGzRomdXC7NEb1N9YrtTlzturc9h/c6g6d37nAGG/Yddga723R5YlLBMGcwa8oYZ9A7foYz6IrTWwV1ukTpVXWzqHDaduyUM7jlkxOy2eON7c5gfLw41pSR4irMGCGKJo0xYzPFAEvxiPJTT6sYM537y2SzDdv3OIOnPqmWL3ZKLc6T8YwpE53B2HHTnUF/QoYz2NajdyUrV+d2S4Woq9t+WFTmtbXpQtXMNLEp2IxiMeqmDhc3VLzc/MuYxIAooXOdrHIGO/ZucQbrt38km22uFAMvOl7U22WMG+kMplw+WTbrKRHxQII4CU2q6HlvvaghNsZsOiQuxN5KcUP51SZZI7L1jmCzisWwKc0Xd3pSrJgYvV2tsll/dbkz2Lp7mzN4fNdBZ7Dkyrtks2fiGyEAwGokQgCA1UiEAACrkQgBAFYjEQIArBaGVaOdnZ3bt29///33u7q6/u7v/u7Mv/rlL3/5zjvv5OTk3H///Tk5OQM/FgAA4RWGRLhx48YHHnhg+PDhGzZsODMRPvPMM88+++wjjzyyadOm2bNn79u3LzZWbcdjTGVdywsbxPYZF6nFxzM/FJvRXOISO30YY5KyL3IGu7zZzuBHJ8TK3eVlolfGmP1bxaZRDQfFUniPWsNdOXGWbPZ0W6EzOEwt8S9IVrsCNerl9Q2bxSrwD38hervxsFg/fapb70U1QW25UqoWkZfEiq1kojJHyGbb3KIgYXet2K7otY0VzmB5mSg8MMY0VX3sDHrTxIez6stFKY7PP0I2m58kTkJutCjF6a484AxWrd4km927XFS8bG4Qm9FIMzOOyPj4k6LCpyBZlIuYYaOcsdNqqyJjzMZDojLk/22ocAaP7hRL3tsba2WzKfkXO4PVpaoCZJ7obV6S3jlrmF+cxq6Du53B8v/d6AyWvVMhm/1Abc2WGi0KTmaPEvfp2A5dQ5Kl9mwKDCtyBuUGZCv36nO7ectRZ7B2jxiNPrVBVXlJqWy2elqxM5gUK7JMbqKY290hCsCa94jJav8vRG837xAbyS19Xrb654c++0vOZv78+Xv37n3sscfODPp8vqeeeur555+//fbbf/zjHycmJr7++usDPxYAAOE1WP9HWFlZeezYsXnz5gX/eMUVV2zapD/8AgAQQYOVCGtra5OTk2Ni/vCvE5mZmTU14ktr0MmT4jEHAACcB4OVCL1eb2fnn/7NurOzMy5OPDApKD5e/B8SAADnwWAlwvz8/I6OjhMn/rB0orKyMj8/P9SLvV79VEAAAAbbYCXCzMzM2bNnv/rqq8aYxsbGlStXLl68eJCOBQBAv4WhfKKurm7mzJmdnZ3t7e1FRUXDhw9ft26dMWbZsmU33njjmjVr9u3bd80110ybNi1UC/6A6fIHnPGDLWJJcdN74jnxaaPEcnNjTOLUuc5gV7LYv+KDarFA/8BOscjYGFP3wToZd+rpEGu1j2z6rXxxXMJNzuBflGQ6g9Pyxb4cPTV60fzRNfudwd/s17s09F2Z2nPAqMXlGWPFA/tzpiyQzbZ5xAPsNxwQvT2wWSyqbqoSVQqhtNaL63tgjajPSU6/WbYwp0j09pJ4MZg7Dov6jU9WiqAx5q06vWlAH4X6da86XNbk0eKVE+c7gzUtoizEGLNhX50zeGDN75xBX1eICgylseID0Wy3KBLYkJfsDM4docpCjHH7RKHUyT1iiMpKCT3sQ6j1iTP2mw/FYP6GukmNMeml4qYOFM92Bg+rjr2/R5dPhJqC+ijUBOiJFiUrH6hNdWYViC0pAqePy2Zrt4jp/S2VCOo69RA9qzAkwoyMjHfeeedPLUb9oc1Zs2Z99NFH27Zty8nJmTRp0sAPBABA2IUhEUZFRY0aJQpajTHp6elXX331wA8BAMAg4VmjAACrkQgBAFYjEQIArEYiBABYLQyLZc4zuUC2fp9edzuqqdEZ7FGlGgdqxYP56/ed1+ej1peXO4OVjeJJ8+INGOM7qZdKV4Y4OYNBLi6f/olY6Jyr1sEbY5p9YrOLo6q45ZwqJfpOLvGvrxQdMMY0tHWLqF/shdJ8VNQY7KgZUJnEuZKHm6A65vWLq9DQJsedPjnnVCnRd/KiH60WmyE0d+ldU1x+0bFTaoieU6XEAIW6SSeom1pehspGUaklp5TBIyfMA7PFDCYnYb+ark2I6b3flRIS3wgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAaiRCAIDVhl4dodRxShelBVSxmqpgMU3toiCsp1OU5gyezqYGZ7C1z+UyvnZ9Ek6GKKg6bzqbxXZaRlWqGWO6A37RgizXO486W/VI6OwRvXUFxOfLnlZRvnaiK5y1UGclDyc75gqIm0S+WRP65Jw3cnh0+3RvjRxgcoieR6FuUnlTizLVEBOFnFIGj5ww5dQqJ2E5XZvQ03sY8Y0QAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArPY5KZ/wpsbKuCtaxN1q9XFyXLQzGBUbL5sdpLKK2OQMZzAhtq/XyBOnT0J6jKf/fQqH2KQYEXXrXkW7xYez2Hhxdc6n2AQ9EmKjRG8DLjHCohK8zuCwGH1xK9WK84GTh5Mdk29BvlkT+uScN3J4RHtCfMr3qwEmh+h5FOomlTe1rAuRE4WcUowxrccr+963vpMTppxa5SQsp2sTenoPI74RAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNWGXvlEtlolnDUuU77YnZzmDEappbujc5KcwbJxs2Sz1Tvf+awu9ldWUZEzWJAmViTLx8970nNkswXy5NS3nkvX+qo0Lc4ZTC3OdwYDIZZKJ3nEOvLCvGRn8GD+aGewqerAWbp4Np4YUU6QVSA6YIzJkHUdbvFo/aTCbGdwcm6ibLbyUONn9LDf5OFkx2RxS0a8HHf65BxVp9HXJXa6OCfJ6qLL4ZEUoiAh4BMdk0O0NK3cGSxrbD9LF/tF36Qhbmq1c4OeKOSUYow5Wb6r733ruyw1YcqpVU7Ccro2Iab37N31zmBdn/fq+fSh+/drAAB8PpAIAQBWIxECAKxGIgQAWI1ECACwGokQAGC1C6J8wu0yMWo17UVqbfrMybnOYM6M8bJlV4pYdxvjEceaoFZgj768UDbr657rDDYcLHMGPdFirXbORF2VcdlEsVR6pCpIcMn9DXIvks0WfuESZ/DLtS3O4MbDp5zBU90+2eyEZPHWSheOcAbTJ45xBv0xCbLZeLX7xF+MHuYMVs4sdQbLy3RVRlPVx86gN02c8MLLp4oOjOnk9EIAABRlSURBVFM1BsbkJqqtGzxiDXfsyIudweJrdbHH1cv3OoObG/q658nMDL0dRPG1og+yYwGPuPVyE/V0IU9O08kvOoNHd25zBjsaa2WzyfmiY0WlE0UH1PCIj9af8v0eMfDkEC1deFT8/jsVstkPmkRlSGq0KOGYPSrVGZQ3qQlxU/vU7S8nCjmlGGPaWxc5g7V7NoljdYv3lVEibj0TYsKUU6uchOV0bUJM71cfEpPV5h01soWz4hshAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWI1ECACw2gVRR1iQnXjXeFHvEp8pdo3JnFTiDCZM1HUt/rgUZ1CWsIwZJqqLbi4dLpvdpEp2Ki4b4Qy6PeKjxvgCUUhkjJk1Kt0ZzE8WhXF6O5y0PBnOmDnDGZzojRHH2nfYGexu65bNJhWI4q2sKaIeK6bkUmfQF6Nr3eJd4oxdmiNKkTpnj3AGt+TojY2ON14mjhUvTsKUkeIqzBihN4hJ8aq9ftTHy+gCsX9Q/pW6otSbLnauKf6kWr7YKbU4xEiYIorwZMe63WJm0G/WmNmjMpxBj6oH3V4oRn5bW5dsNlPdZTOKxaiTwyNUHWEgIAaeHKJFN4rCTTnsjTGllSecwWhVCZ0xbqQzmHL5ZNmsvKnl7S8nimvVvGqMSVEjf68qx/T7/M7giGwxPo0xs4rFSJBTq5yE5XRtQkzvlwTEblTDxh6ULZwV3wgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAahdE+UR83rDRX5nnjLvixFL4qCxR0uDK0OvFfWqvnyi15VO6V5yKKXl6OW9Oolip3Nguygzc6lhZCWLtsjEmP0k0mxwj1qyrbVhMIMTi46iRYhOTtETx4uSxYhOTQI9e3e5OEhUFUdkFooVUsXNWIErvlxSr3ltekjhjsy4SHRiRpqsymrvE1kjeKPFBMFdd3JxEfcnio9SVcItL5ksQK8tjL9FlP1lpYmOjjCn18sVOnrQsGY/KEbvkyI7Jt6DfrDFFqs4hQe1ANC5XLLvv6BEL9I0xSTHilpRFApmqSiE2RG8DAdFCID3fGfSq7dLysvXWbP7mRmfQFSWGjWeYuB3cmeLGMSEqCuTtLyeK8Vm6migtTpyxqapGyO8XVQry140xw9XWbHJqlZNwIMTWbJ68ImcwMVaMOu8I8cq+4BshAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWO2CKJ9wexOihheLeKxYjGsS1RrfEFsZBDziDcpV1fJp6ElqRbIxJl+tEk5Rq4TdaqVzSqw+7fJ5+dGqY1LAo9c0B2LFEmq5htulViSbHr37hCtePYE+QWwvEIhW11HtMmGM8agz5lVL4dP6fMKNMe3dPmcwRu0NIq9jnCq0MKFWgatXynIRv1dsm2CMicoWNULuBP3If/FKVRsT6nCyYwF1l8g3a0KcnExVIyRPeJfa38AYE6cKMFJiRVAODzmQjDHy078coq5EsQ9JVIhxG0gWLzZR4pZ0J4l7xK9uUhP6pnaSE0WoLThkjVC8OuF+tclDoqpsMSEmTDm1ymsjp2sTYnp3p2Y6g9FR/cxofCMEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNUGNxH6fL79+/c3NDQM6lEAAOg3V0Ctjg2L/fv3X3fddYmJiVVVVffff/8///M/h3rl9OnTf/CDH0ybNm2QegIAQCiD+I3woYce+trXvrZnz57333//6aef/vDDDwfvWAAA9M9gJcLGxsa33nrrr//6r40xhYWF11577S9/+ctBOhYAAP02WE+WqaysjI6OHj78Dw/IKCoqOnr0aKgXd3V1ffTRR1F/fChAcnJySUnJIHUMAIAzDVYibGlpiYv70/O64uPjm5qaQr24trZ22bJlCQl/2J64pKSEr48AgPNjsBJhdnZ2U1OTz+fzeDzGmJMnT+bk5IR6cWFhIYtlAAARMVj/R1hQUJCenr5169bgH7ds2XLZZZcN0rEAAOi3wfpGGBMTc8899zz44INPP/30xo0bDxw48NWvfnWQjgUAQL8N4jZMjzzySEJCwne/+93s7Oy1a9cmJfV1ExkAAM6bQSyo7zsK6gEAkcKzRgEAViMRAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWI1ECACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAaiRCAIDVSIQAAKuRCAEAViMRAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWI1ECACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALAaiRAAYDUSIQDAaiRCAIDVSIQAAKuRCAEAViMRAgCsRiIEAFiNRAgAsBqJEABgNRIhAMBqJEIAgNVIhAAAq5EIAQBWIxECAKxGIgQAWI1ECACwGokQAGA1EiEAwGpRA2+ipaVlzZo1u3bt6u7ufvTRR3vjPp/vxz/+8erVq/Py8r797W8XFRUN/FgAAIRXGL4R7ty58/vf//6+ffueeuqpM+PLli376U9/+q1vfSsjI2Pu3LltbW0DPxYAAOEVhkQ4Z86cdevWPfzww2cGu7u7n3322R/96EfXXHPNY489lp+f/z//8z8DPxYAAOE1WP9HWFlZWV9fP2vWrOAfZ8+eXVZWNkjHAgCg3/r0f4QdHR3V1dXOeEFBQXR0tPyVurq6pKSkqKg/tJ+RkbF9+/ZQ7R87duy+++5LSUkJ/nH48OE///nP+9IxAAAGqE+JcPfu3XfccYczvnLlyuLiYvkrCQkJHR0dvX9sb29PTEwM1f6wYcO+/vWvjxkzJvjHnJycvvQKAICB61MinDZt2oEDB86p3fz8/K6urpqamtzcXGNMRUVFYWFhqBd7vd7S0tJp06ad0yEAABi4wfo/woyMjPnz57/44ovGmNra2pUrV958882DdCwAAPotDHWENTU148aN8/l87e3t6enpF1100fvvv2+MefLJJ6+77rpVq1aVl5cvWbJk0qRJAz8WAADhFYZEmJ2dXV5e3vtHt/sP3zInTZpUXl7+wQcfZGdnf8a/iwIAEEFhSIRutzstLU3+VfA//wZ+CAAABgnPGgUAWI1ECACwGokQAGA1EiEAwGokQgCA1UiE4fdv//ZvPp8v0r0Iv02bNq1duzbSvQi/QCDw2GOPRboXg2L16tXbtm2LdC/Cr6ur64knnoh0LwbF66+//uGHH0a6F+HX1NT0wx/+MNK9CIlEGH7Lli1rbW2NdC/C7//+7/9+//vfR7oX4efz+R555JFI92JQvP322xs3box0L8KvsbHxU7uffm68+eabn8uNeo4dO/aTn/wk0r0IiUQIALAaiRAAYDUSIQDAaq5AIBDpPpi8vDyPxxMTExPpjoTHkSNHCgsLXS5XpDsSZqdPn/b7/aEepzekVVRUjBgxItK9CL+TJ09GRUUlJydHuiNh5vf7jx079rl8gvGJEye8Xu9n7N46RHV3d9fX1+fn55//Q3/ta1979NFHP/s1F0QirKur+zytLuns7IyNjY10L8IvuBTW4/FEuiPh93m9ZD09PS6Xi0s2hHR3d3s8nt6tCz5PInXJcnNz4+LiPvs1F0QiBAAgUj6HnzsAAOg7EiEAwGokQgCA1UiEAACrhWGHestVV1fv2LGjpqbm6quvPnM9d3l5+X/91391dXXdeuutkyZNimAP+6ehoeF3v/vd3r17k5OTFy9ePG7cuN6/evvtt99+++2cnJy77747PT09gp3snzfffHPHjh3Nzc0lJSW33357UlJSMF5bW/viiy82NDR86UtfmjNnTmQ7ORC7du3atm3bLbfckpqaGoysX7/+jTfeyMjIuPPOO3NyciLbvX54+eWXOzo6gj+PHDly4cKFwZ+PHDny0ksvtba23nzzzaWlpZHrYP/5fL5f/epX27dvT0tLW7x48fjx440xgUDg17/+9datW0eMGPHNb37zrIseLzSHDx9+5513zoxcf/31wYG3f//+V155xRhz2223jR07NjL9c+Ab4UBNnTr1iSeeWLp06Z49e3qDR44cKS0t7erqSk1NnTt37lB8eOBDDz305ptvZmdnnz59eurUqb3D+uc///mdd945cuTIPXv2zJ49u6urK7L97IdXXnklOjp65MiRK1asmD59enCGbW5unjZtWkVFRWFh4U033bRixYpId7Ofmpub77jjjnvuuaeuri4YWbFixeLFiwsKCo4cOTJt2rSmpqbI9rAfHnrooe3btx86dOjQoUP19fXBYG1tbWlp6alTp7KyshYuXLh+/frIdrIffD7fdddd9+yzz+bn5/v9/i1btgTjjzzyyPe+972SkpJVq1YtWrQosp3sh5aWlkN/tHbt2r/5m78JFoTs379/+vTp0dHRsbGxM2bM2LdvX6R7+kcBDIzP5wsEAkVFRb/97W97gw8//PDtt98e/Pm73/3uLbfcEpnODUB7e3vvz0uXLr355psDgYDf7y8pKXn99deDP0+YMOFXv/pVxLo4YN3d3YmJiVu2bAkEAs8///zs2bOD8RdffLG0tDSiXeu/b33rW88995wx5qOPPgpGpk6d+p//+Z/Bn+fMmfPcc89Frnf9lJmZ2ft2en3ve9+74YYbgj8/8cQT11577Xnv10D97Gc/GzduXFdX15nBlpaWlJSUnTt3BgKBjo6OjIyM9957L0IdDINvf/vbixcvDv58zz333HvvvcGfH3jggbvvvjty/fozfCMcKFn6un79+iuvvDL488KFC9etW3d+OxUGXq+39+fOzs7goy5qamoOHjwY/Icpl8u1YMGCofjWeu3cudPtdo8aNco4LllZWVlbW1tEe9cf69at27179ze/+c3eSEdHx7Zt23r/LXGIjkZjzKuvvvrMM8+cuZnG5+AuW7ly5e233/7WW289/fTTmzdvDgZ37doVHR192WWXGWNiY2PnzJkzFN9aUE9PzyuvvHLnnXcG/7h+/freoXjllVdeOO+LRDgoampqMjMzgz9nZWUdP368p6cnsl3qt927d7/88st/+7d/a4ypqamJj4/vff5TdnZ2dXV1RHvXT0uWLMnLy5s3b95///d/Z2VlGcclC0Yi2cVz19bWdu+99/7sZz8788NZ8F0E35EZspdsxowZnZ2dFRUVixcvfvDBB4PBT12y1tbWIfevvocPH37hhReWL1/e0tJy8803P/PMM8aY2tra3utlhuwlC/rd737ndruvvvrq4B8/dckunFuMxTKDIioqqjfz9fT0DN1nJh05cuSGG2546qmnJkyYYIyJjo4+M6N3d3cP0cdc/ehHP2pqalq5cuWSJUu2bdtWVFT0qUtmjBlyD7/9x3/8x1tvvXXs2LFn7gsdHR1t/viOzJC9ZG+88Ubwh3vvvfeSSy65//77R40a5bxkwTc7hLjd7pKSkpdfftkYM23atFtuueWBBx44830ZY7q7u4fu02JffPHFv/zLv+x9yN+nLtmFc4sNydn5wpefn9/7Ia6qqio3N3coJsIjR47Mmzfv7//+7++6665gJC8vr6ur6/jx48E/Bt9a5DrYf4mJiXl5eXffffell166cuVK8+eX7NixYx6PJzs7O6J9PGevvvrq8uXLp0yZMnXqVGPMTTfdFFzu5PF4qqqqgq8ZupcsqKSkJDMz8/Dhw8Zxl6Wnpw+51ZX5+fm9KyfHjRt3+vTp06dP5+Xl1dbW9n6aGbqXrLa29u23316yZElv5FOXLC8vL0Jd+7ShNzsPCYsWLVq+fHkgEDDGLF++fCiu+zp27Nj8+fOXLl16zz339AaHDRs2Y8aM5cuXG2Pa2tpWrlx5/fXXR66P/dHZ2en3+4M/NzU1HThwIFj0smjRohUrVgQXwf7mN7+56qqrLpyPq320evXqF1988Sc/+cl//Md/GGP+5V/+ZebMmdHR0VdffXXwknV3d7/xxhtD7pJ1dHQE/vhI5G3btp04cWLMmDHGmEWLFr322mvBqzlE77Ibb7xx69atwXf33nvv5eXlpaamXnbZZcnJyatXrzbG1NXVbdiw4Ytf/GKke9ofL7300owZM4qLi3sjwYkx+POvf/3rC+iSRXixztC3ZMmSyZMnx8bGFhcXT548ed++fYFAoLGxcdy4cfPnz7/pppvy8/MrKioi3c1z9uUvf9nr9U7+ozvuuCMYX7NmTUZGxte//vVJkyZdf/31fr8/sv08V1u3bg0WSNx66605OTm33HJLcN1vV1fXvHnzpk6dettttw0bNqysrCzSPe2/4L8+9S6z3L59e0ZGxm233TZt2rR58+Z9ao3ihW/VqlVFRUVf+cpXvvSlLyUlJf37v/97MN7S0nL55ZfPmTPnlltuyc7O/vjjjyPbz35ob2+fNWvWnDlz7rrrrszMzOB67EAg8Morr2RmZi5ZsqS4uPi+++6LbCf7bcyYMS+//PKZkdra2qKiomuvvfaLX/ziqFGjampqItW3T2H3iYH6+OOPW1paev84ZsyYhIQEY0xHR8e7777b2dm5YMGClJSUyHWwn8rLy0+dOtX7x4SEhODHcGNMVVXVhg0bsrOz586dOxT/yffgwYN79+71+Xxjx449s6S3p6dn7dq1J0+evOKKK85crTDkBAKBnTt3jhs3rnfpb319/dq1a9PT06+44oqoqCG2MsDn8+3Zs+fAgQPBT2bDhw/v/avOzs41a9a0tLQsWLBgiO6UGRx1TU1N06dPP3O7voMHD27fvn3kyJHTp0+PYPf6raenZ/fu3ePHj//U/0m3tra+++67gUBgwYIFF862iyRCAIDVht7HeQAAwohECACwGokQAGA1EiEAwGokQgCA1UiEAACrkQgBAFYjEQIArEYiBABYjUQIALAaiRAAYLX/D28sEmUZSqqmAAAAAElFTkSuQmCC" /><p>Clearly the charge-sloshing mode is no longer dominating.</p><p>The largest eigenvalue is now</p><pre><code class="language-julia hljs">maximum(real.(λ_Kerker))</code></pre><pre><code class="nohighlight hljs">4.72358578078536</code></pre><p>Since the smallest eigenvalue in this case remains of similar size (it is now around 0.8), this implies that the conditioning improves noticeably when <code>KerkerMixing</code> is used.</p><p><strong>Note:</strong> Since LdosMixing requires solving a linear system at each application of <span>$P^{-1}$</span>, determining the eigenvalues of <span>$P^{-1} \varepsilon^\dagger$</span> is slightly more expensive and thus not shown. The results are similar to <code>KerkerMixing</code>, however.</p><p>We could repeat the exercise for an insulating system (e.g. a Helium chain). In this case you would notice that the condition number without mixing is actually smaller than the condition number with Kerker mixing. In other words employing Kerker mixing makes the convergence <em>worse</em>. A closer investigation of the eigenvalues shows that Kerker mixing reduces the smallest eigenvalue of the dielectric operator this time, while keeping the largest value unchanged. Overall the conditioning thus workens.</p><p><strong>Takeaways:</strong></p><ul><li>For metals the conditioning of the dielectric matrix increases steeply with system size.</li><li>The Kerker preconditioner tames this and makes SCFs on large metallic systems feasible by keeping the condition number of order 1.</li><li>For insulating systems the best approach is to not use any mixing.</li><li><strong>The ideal mixing</strong> strongly depends on the dielectric properties of system which is studied (metal versus insulator versus semiconductor).</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../compare_solvers/">« Comparison of DFT solvers</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 25 February 2026 20:14">Wednesday 25 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
