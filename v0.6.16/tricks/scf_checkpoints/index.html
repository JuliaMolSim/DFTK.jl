<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Saving SCF results on disk and SCF checkpoints · DFTK.jl</title><meta name="title" content="Saving SCF results on disk and SCF checkpoints · DFTK.jl"/><meta property="og:title" content="Saving SCF results on disk and SCF checkpoints · DFTK.jl"/><meta property="twitter:title" content="Saving SCF results on disk and SCF checkpoints · DFTK.jl"/><meta name="description" content="Documentation for DFTK.jl."/><meta property="og:description" content="Documentation for DFTK.jl."/><meta property="twitter:description" content="Documentation for DFTK.jl."/><meta property="og:url" content="https://docs.dftk.org/stable/tricks/scf_checkpoints/"/><meta property="twitter:url" content="https://docs.dftk.org/stable/tricks/scf_checkpoints/"/><link rel="canonical" href="https://docs.dftk.org/stable/tricks/scf_checkpoints/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../../examples/metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../../examples/collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../../examples/convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../../examples/pseudopotentials/">Pseudopotentials</a></li><li><a class="tocitem" href="../../examples/supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../../examples/gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../../examples/graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../../examples/geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../../examples/energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../../examples/polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../../examples/forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../../examples/dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../../examples/atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../../examples/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../examples/wannier/">Wannierization using Wannier.jl or Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../parallelization/">Timings and parallelization</a></li><li class="is-active"><a class="tocitem" href>Saving SCF results on disk and SCF checkpoints</a><ul class="internal"><li><a class="tocitem" href="#Checkpointing-of-SCF-calculations"><span>Checkpointing of SCF calculations</span></a></li></ul></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../../examples/custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../../examples/scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../../examples/compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../../examples/gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../../examples/gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../../examples/custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../../examples/cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../../examples/anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../../examples/arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../../examples/error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/setup/">Developer setup</a></li><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li><li><a class="tocitem" href="../../developer/gpu_computations/">GPU computations</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tipps and tricks</a></li><li class="is-active"><a href>Saving SCF results on disk and SCF checkpoints</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Saving SCF results on disk and SCF checkpoints</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/docs/src/tricks/scf_checkpoints.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Saving-SCF-results-on-disk-and-SCF-checkpoints"><a class="docs-heading-anchor" href="#Saving-SCF-results-on-disk-and-SCF-checkpoints">Saving SCF results on disk and SCF checkpoints</a><a id="Saving-SCF-results-on-disk-and-SCF-checkpoints-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-SCF-results-on-disk-and-SCF-checkpoints" title="Permalink"></a></h1><p>For longer DFT calculations it is pretty standard to run them on a cluster in advance and to perform postprocessing (band structure calculation, plotting of density, etc.) at a later point and potentially on a different machine.</p><p>To support such workflows DFTK offers the two functions <a href="../../api/#DFTK.save_scfres-Tuple{AbstractString, NamedTuple}"><code>save_scfres</code></a> and <a href="../../api/#DFTK.load_scfres"><code>load_scfres</code></a>, which allow to save the data structure returned by <a href="../../api/#DFTK.self_consistent_field-Union{Tuple{PlaneWaveBasis{T, VT} where VT&lt;:Real}, Tuple{T}} where T"><code>self_consistent_field</code></a> on disk or retrieve it back into memory, respectively. For this purpose DFTK uses the <a href="https://github.com/JuliaIO/JLD2.jl">JLD2.jl</a> file format and Julia package.</p><div class="admonition is-info"><header class="admonition-header">Availability of `load_scfres`, `save_scfres` and checkpointing</header><div class="admonition-body"><p>As JLD2 is an optional dependency of DFTK these three functions are only available once one has <em>both</em> imported DFTK and JLD2 (<code>using DFTK</code> and <code>using JLD2</code>).</p></div></div><div class="admonition is-warning"><header class="admonition-header">DFTK data formats are not yet fully matured</header><div class="admonition-body"><p>The data format in which DFTK saves data as well as the general interface of the <a href="../../api/#DFTK.load_scfres"><code>load_scfres</code></a> and <a href="../../api/#DFTK.save_scfres-Tuple{AbstractString, NamedTuple}"><code>save_scfres</code></a> pair of functions are not yet fully matured. If you use the functions or the produced files expect that you need to adapt your routines in the future even with patch version bumps.</p></div></div><p>To illustrate the use of the functions in practice we will compute the total energy of the O₂ molecule at PBE level. To get the triplet ground state we use a collinear spin polarisation (see <a href="../../examples/collinear_magnetism/#Collinear-spin-and-magnetic-systems">Collinear spin and magnetic systems</a> for details) and a bit of temperature to ease convergence:</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra
using JLD2

d = 2.079  # oxygen-oxygen bondlength
a = 9.0    # size of the simulation box
lattice = a * I(3)
O = ElementPsp(:O; psp=load_psp(&quot;hgh/pbe/O-q6.hgh&quot;))
atoms     = [O, O]
positions = d / 2a * [[0, 0, 1], [0, 0, -1]]
magnetic_moments = [1., 1.]

Ecut  = 10  # Far too small to be converged
model = model_PBE(lattice, atoms, positions; temperature=0.02, smearing=Smearing.Gaussian(),
                  magnetic_moments)
basis = PlaneWaveBasis(model; Ecut, kgrid=[1, 1, 1])

scfres = self_consistent_field(basis, tol=1e-2, ρ=guess_density(basis, magnetic_moments))
save_scfres(&quot;scfres.jld2&quot;, scfres);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)   Magnet   Diag   Δtime
---   ---------------   ---------   ---------   ------   ----   ------
  1   -27.64588026674                   -0.13    0.001    6.5   94.6ms
  2   -28.92273842916        0.11       -0.82    0.681    2.0   76.4ms
  3   -28.93110928550       -2.08       -1.14    1.187    2.5    118ms
  4   -28.93771876354       -2.18       -1.19    1.772    2.0   70.6ms
  5   -28.93951992311       -2.74       -1.44    1.998    1.5   77.0ms
  6   -28.93960102541       -4.09       -2.06    1.979    1.0    110ms</code></pre><pre><code class="language-julia hljs">scfres.energies</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Energy breakdown (in Ha):
    Kinetic             16.7701775
    AtomicLocal         -58.4937464
    AtomicNonlocal      4.7105709 
    Ewald               -4.8994689
    PspCorrection       0.0044178 
    Hartree             19.3603323
    Xc                  -6.3908252
    Entropy             -0.0010590

    total               -28.939601025405</code></pre><p>The <code>scfres.jld2</code> file could now be transferred to a different computer, Where one could fire up a REPL to inspect the results of the above calculation:</p><pre><code class="language-julia hljs">using DFTK
using JLD2
loaded = load_scfres(&quot;scfres.jld2&quot;)
propertynames(loaded)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:α, :history_Δρ, :converged, :occupation, :occupation_threshold, :algorithm, :basis, :runtime_ns, :n_iter, :history_Etot, :εF, :energies, :ρ, :n_bands_converge, :eigenvalues, :ψ, :ham)</code></pre><pre><code class="language-julia hljs">loaded.energies</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Energy breakdown (in Ha):
    Kinetic             16.7701775
    AtomicLocal         -58.4937464
    AtomicNonlocal      4.7105709 
    Ewald               -4.8994689
    PspCorrection       0.0044178 
    Hartree             19.3603323
    Xc                  -6.3908252
    Entropy             -0.0010590

    total               -28.939601025405</code></pre><p>Since the loaded data contains exactly the same data as the <code>scfres</code> returned by the SCF calculation one could use it to plot a band structure, e.g. <code>plot_bandstructure(load_scfres(&quot;scfres.jld2&quot;))</code> directly from the stored data.</p><p>Notice that both <code>load_scfres</code> and <code>save_scfres</code> work by transferring all data to/from the master process, which performs the IO operations without parallelisation. Since this can become slow, both functions support optional arguments to speed up the processing. An overview:</p><ul><li><code>save_scfres(&quot;scfres.jld2&quot;, scfres; save_ψ=false)</code> avoids saving the Bloch wave, which is usually faster and saves storage space.</li><li><code>load_scfres(&quot;scfres.jld2&quot;, basis)</code> avoids reconstructing the basis from the file, but uses the passed basis instead. This save the time of constructing the basis twice and allows to specify parallelisation options (via the passed basis). Usually this is useful for continuing a calculation on a supercomputer or cluster.</li></ul><p>See also the discussion on <a href="../../examples/input_output/#Input-and-output-formats">Input and output formats</a> on JLD2 files.</p><h2 id="Checkpointing-of-SCF-calculations"><a class="docs-heading-anchor" href="#Checkpointing-of-SCF-calculations">Checkpointing of SCF calculations</a><a id="Checkpointing-of-SCF-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Checkpointing-of-SCF-calculations" title="Permalink"></a></h2><p>A related feature, which is very useful especially for longer calculations with DFTK is automatic checkpointing, where the state of the SCF is periodically written to disk. The advantage is that in case the calculation errors or gets aborted due to overrunning the walltime limit one does not need to start from scratch, but can continue the calculation from the last checkpoint.</p><p>The easiest way to enable checkpointing is to use the <a href="../../api/#DFTK.kwargs_scf_checkpoints-Tuple{DFTK.AbstractBasis}"><code>kwargs_scf_checkpoints</code></a> function, which does two things. (1) It sets up checkpointing using the <a href="../../api/#DFTK.ScfSaveCheckpoints"><code>ScfSaveCheckpoints</code></a> callback and (2) if a checkpoint file is detected, the stored density is used to continue the calculation instead of the usual atomic-orbital based guess. In practice this is done by modifying the keyword arguments passed to # <a href="../../api/#DFTK.self_consistent_field-Union{Tuple{PlaneWaveBasis{T, VT} where VT&lt;:Real}, Tuple{T}} where T"><code>self_consistent_field</code></a> appropriately, e.g. by using the density or orbitals from the checkpoint file. For example:</p><pre><code class="language-julia hljs">checkpointargs = kwargs_scf_checkpoints(basis; ρ=guess_density(basis, magnetic_moments))
scfres = self_consistent_field(basis; tol=1e-2, checkpointargs...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-7.847975050004954 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057803 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [5.660687204883955 5.430189423521898 … 4.799729928112022 5.430186046300199; 5.43018437600445 5.210099789252063 … 4.6108436754474695 5.210091297775344; … ; 4.799721210017378 4.610838361367349 … 4.099991447862748 4.610844460672134; 5.430184873949137 5.210094320866144 … 4.610851237634245 5.210096909768915;;; 5.5400530380404795 5.337756098289187 … 4.7587134804500995 5.337750212760438; 5.337745515959134 5.139509199127048 … 4.579385158661678 5.139496469778237; … ; 4.758711773886423 4.579386591348073 … 4.0843308275141785 4.579394231571466; 5.337754136338312 5.139507654148144 … 4.579396993877761 5.139510383365402;;; 5.246346391274313 5.103576751371843 … 4.634186808047783 5.103570404967808; 5.103557921098564 4.951671324388312 … 4.475650725301795 4.951652519285912; … ; 4.634188103992829 4.475656473271028 … 4.016037845224851 4.475671296009651; 5.103578926361959 4.951673490850062 … 4.475673098747112 4.951681927867899;;; … ;;; 4.914412006838948 4.8098471960108675 … 4.415287222608904 4.809838483060078; 4.809853119449727 4.6886156877184435 … 4.272568240076573 4.688584627266074; … ; 4.415243540780435 4.27253362306247 … 3.844192620660163 4.2725564743201545; 4.809815203822692 4.6885623864707044 … 4.27258327659908 4.688577622807004;;; 5.2463991970772055 5.103627521160467 … 4.634233065491213 5.103624114138177; 5.103631054935368 4.951739797074689 … 4.475695568373353 4.951717203846751; … ; 4.634195201228519 4.475665025185416 … 4.0160620475391235 4.475686979524041; 5.103605515383636 4.951699939450032 … 4.475710687574694 4.9517161170864945;;; 5.540077013505925 5.337776643903721 … 4.758733587376022 5.337774986679939; 5.337775837720017 5.139535788782547 … 4.579402810234464 5.13952350180369; … ; 4.758711182300834 4.5793855541152455 … 4.084339600478135 4.579398524657231; 5.337765847899609 5.139516968476281 … 4.5794134025078295 5.139526133492394]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-1.0071933804923108 -0.9754648231263993 … -0.8483124011237588 -0.9754763678755034; -0.9754345928991668 -0.930979034387413 … -0.8471763571842483 -0.9309705783133035; … ; -0.8482979666767809 -0.8472389016578712 … -0.6667359886507563 -0.847243530651961; -0.9754377801958041 -0.9309813398592682 … -0.8471759592289698 -0.9309669368862966;;; -0.9896102080182825 -0.9543153324309138 … -0.9003567346402598 -0.9543143325717789; -0.9543083299859366 -0.9325648856489065 … -0.878597949573787 -0.9325582085879709; … ; -0.9003616602939167 -0.8786002642997214 … -0.7907133130900146 -0.8786092711371062; -0.954296370529241 -0.9325576244170274 … -0.8785904252247841 -0.9325623774117895;;; -0.7543977583643844 -0.856572142018156 … -0.9142754400778438 -0.8565722998693428; -0.8565581108933135 -0.8894309088606245 … -0.9070585469696447 -0.889409467969974; … ; -0.9142655659877559 -0.9070524518609325 … -0.8645909129247856 -0.9070667849223263; -0.8565602527683257 -0.8894076812428235 … -0.9070676683237889 -0.8894324030894549;;; … ;;; -0.6143689858713025 -0.8434537820857362 … -0.9681662907125581 -0.8434421726348897; -0.8434465978112169 -0.9184426964517891 … -0.9579486438712194 -0.9183757034576845; … ; -0.9681264990102703 -0.9579201516487824 … -0.9347470187942374 -0.9579542044056707; -0.8434066251705162 -0.9183598654997882 … -0.957983091901088 -0.9184165547402127;;; -0.7543919005687126 -0.856575607214692 … -0.9142867268325677 -0.8565712452387131; -0.8565660841129022 -0.8894532900829308 … -0.9070612542817893 -0.8894118472745215; … ; -0.9142564232861355 -0.9070440136040437 … -0.8646016091959352 -0.9070681636117768; -0.8565507876653952 -0.8894051170501319 … -0.9070947782655808 -0.8894460466242832;;; -0.9895970829980835 -0.9543110721831422 … -0.9003479837452196 -0.9543079995962055; -0.9543051887467922 -0.9325729356764495 … -0.8785813722678064 -0.9325635592622381; … ; -0.9003399969442333 -0.8785810682770303 … -0.7907072318717203 -0.8785949193370151; -0.954306324519844 -0.9325567249197493 … -0.8786051064710111 -0.9325726837989045]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-3.194481225613309 -2.813703839810184 … -2.035014646491227 -2.813718761780985; -2.8136786571003984 -2.5026286929344264 … -1.890995353004296 -2.5026287283370356; … ; -2.0350089301388925 -1.8910632115580397 … -1.4016116919508907 -1.8910617412473438; -2.8136813464523494 -2.5026364667922008 … -1.890987392862242 -2.502619474916458;;; -4.348991575752526 -3.7042235981723137 … -2.5146335906006168 -3.704228483841928; -3.7042271780573897 -3.210817490057204 … -2.256510611894731 -3.2108235423450795; … ; -2.514640222817948 -2.25651149393427 … -1.6903337895715467 -2.256512860548264; -3.7042065982215164 -3.210811773804229 … -2.2564912523296456 -3.210813797581733;;; -12.702516148147877 -7.9680112266757375 … -3.540236165497665 -7.968017730930957; -7.968016025824176 -5.683250859231601 … -3.0729162622250987 -5.68324822344335; … ; -3.5402249954625287 -3.072904419147155 … -2.1393265307614917 -3.0729039294699256; -7.967997162435792 -5.6832254651520495 … -3.072903010133926 -5.683241749980844;;; … ;;; -28.841009493577378 -14.82384976281868 … -4.218810472032715 -14.823846866318618; -14.823836655105302 -8.85927903615299 … -3.6083277603061736 -8.859243103611256; … ; -4.218814362158895 -3.60833388509784 … -2.4248672706319216 -3.6083450865970437; -14.823834598091636 -8.85924950644873 … -3.608347171813536 -8.859290959352855;;; -12.70245748454931 -7.967963922083648 … -3.5402011948089576 -7.967962967129958; -7.967950865206959 -5.68320476776753 … -3.0728741264656856 -5.683185918187059; … ; -3.5402087555252186 -3.072887428975877 … -2.1393130247183674 -3.072889624644986; -7.967961108311184 -5.6831964523593905 … -3.0728925312481357 -5.683221204297079;;; -4.348954475266882 -3.704198792310008 … -2.514604732779654 -3.7041973769468535; -3.7041937150573627 -3.210798950429247 … -2.256476383015964 -3.210801860993893; … ; -2.514619151053854 -2.2564933351444068 … -1.6903189353892962 -2.256494215662407; -3.7042048406508234 -3.2108015599788136 … -2.2564895249458043 -3.210808353841856]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, NamedTuple{(:ψ_reals,), Tuple{Array{ComplexF64, 3}}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)]), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-7.847975050004954 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057803 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [5.660687204883955 5.430189423521898 … 4.799729928112022 5.430186046300199; 5.43018437600445 5.210099789252063 … 4.6108436754474695 5.210091297775344; … ; 4.799721210017378 4.610838361367349 … 4.099991447862748 4.610844460672134; 5.430184873949137 5.210094320866144 … 4.610851237634245 5.210096909768915;;; 5.5400530380404795 5.337756098289187 … 4.7587134804500995 5.337750212760438; 5.337745515959134 5.139509199127048 … 4.579385158661678 5.139496469778237; … ; 4.758711773886423 4.579386591348073 … 4.0843308275141785 4.579394231571466; 5.337754136338312 5.139507654148144 … 4.579396993877761 5.139510383365402;;; 5.246346391274313 5.103576751371843 … 4.634186808047783 5.103570404967808; 5.103557921098564 4.951671324388312 … 4.475650725301795 4.951652519285912; … ; 4.634188103992829 4.475656473271028 … 4.016037845224851 4.475671296009651; 5.103578926361959 4.951673490850062 … 4.475673098747112 4.951681927867899;;; … ;;; 4.914412006838948 4.8098471960108675 … 4.415287222608904 4.809838483060078; 4.809853119449727 4.6886156877184435 … 4.272568240076573 4.688584627266074; … ; 4.415243540780435 4.27253362306247 … 3.844192620660163 4.2725564743201545; 4.809815203822692 4.6885623864707044 … 4.27258327659908 4.688577622807004;;; 5.2463991970772055 5.103627521160467 … 4.634233065491213 5.103624114138177; 5.103631054935368 4.951739797074689 … 4.475695568373353 4.951717203846751; … ; 4.634195201228519 4.475665025185416 … 4.0160620475391235 4.475686979524041; 5.103605515383636 4.951699939450032 … 4.475710687574694 4.9517161170864945;;; 5.540077013505925 5.337776643903721 … 4.758733587376022 5.337774986679939; 5.337775837720017 5.139535788782547 … 4.579402810234464 5.13952350180369; … ; 4.758711182300834 4.5793855541152455 … 4.084339600478135 4.579398524657231; 5.337765847899609 5.139516968476281 … 4.5794134025078295 5.139526133492394]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-1.0124391714199676 -0.9779267397591492 … -0.9022625083464118 -0.9779332670212225; -0.9779056117267536 -0.9435921238269602 … -0.8435190007384193 -0.9435840323051246; … ; -0.9021391981220493 -0.8436569252949604 … -0.7653513830169646 -0.8436677097683289; -0.9779081175324905 -0.9435953816567945 … -0.8435199394490132 -0.9435865006659677;;; -1.0022758033484909 -0.9662701887245403 … -0.8942531388486158 -0.9662683110619307; -0.9662574508437306 -0.938273624744277 … -0.8654768741600669 -0.938270722581362; … ; -0.8942194679830832 -0.8655275835804279 … -0.7840485686059728 -0.8655255146468707; -0.9662663089168092 -0.9382824739921414 … -0.8654842657515185 -0.9382764612101968;;; -0.8145481572075444 -0.8332228163445471 … -0.8253416532461453 -0.8332114387872873; -0.8331957822977577 -0.8334154941341444 … -0.8162038978865171 -0.8334102374914067; … ; -0.8253756727005807 -0.8162272446185819 … -0.7768321385485348 -0.816228158166433; -0.8332173188219884 -0.833434386887772 … -0.8162198424185052 -0.833419205566413;;; … ;;; -0.690930150648172 -0.7868100595390544 … -0.8343064211448801 -0.7868160638806847; -0.7868349286201878 -0.8127116239947859 … -0.8260908591235101 -0.8127461815235498; … ; -0.834310826652287 -0.8260876232938519 … -0.8100193611527224 -0.8260769002864584; -0.7868163426091533 -0.8127258317282444 … -0.8260657068664183 -0.8126926297206378;;; -0.8145655337863439 -0.8332186105827196 … -0.8253498194592668 -0.833223168148886; -0.8332183034306994 -0.8334129091377667 … -0.8162246846143155 -0.8334319117078131; … ; -0.8253664952131319 -0.8162171398906605 … -0.7768196988504888 -0.8162154514497874; -0.8332091350394425 -0.8334183129196281 … -0.8162082574661756 -0.8334071684062748;;; -1.0022840829429756 -0.966270400239965 … -0.8942579653811449 -0.966273267077401; -0.9662609500310099 -0.9382708504795846 … -0.8654955699937421 -0.9382755695817461; … ; -0.8942293170856987 -0.8655243171279309 … -0.7840448106371015 -0.8655222172468334; -0.9662653095589946 -0.9382741075551022 … -0.8654901969663389 -0.9382699163549981]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-3.199727016540966 -2.816165756442934 … -2.0889647537138796 -2.8161756609267043; -2.816149675927985 -2.5152417823739732 … -1.887337996558467 -2.5152421823288567; … ; -2.088850161584161 -1.887481235195129 … -1.500227086317099 -1.8874859203637118; -2.8161516837890357 -2.5152505085897268 … -1.8873313730822854 -2.5152390386961287;;; -4.361657171082735 -3.71617845446594 … -2.5085299948089728 -3.7161824623320796; -3.7161762989151836 -3.2165262291525747 … -2.2433895364810112 -3.2165360563384704; … ; -2.5084980305071145 -2.2434388132149765 … -1.683669045087505 -2.2434291040580288; -3.7161765366090846 -3.2165366233793433 … -2.24338509285638 -3.21652788138014;;; -12.762666546991039 -7.944661901002128 … -3.4513023786659662 -7.944656869848902; -7.94465369722862 -5.627235444505121 … -2.982061613141971 -5.627248992964783; … ; -3.4513351021753538 -2.9820792119048045 … -2.051567756385241 -2.9820653027140325; -7.944654228489456 -5.627252170796998 … -2.982055184228642 -5.627228552457803;;; … ;;; -28.917570658354247 -14.767206040271997 … -4.084950602465037 -14.767220757564413; -14.767224985914272 -8.753547963695988 … -3.476469975558464 -8.753613581677122; … ; -4.084998689800912 -3.4765013567429093 … -2.3001396129904066 -3.4764677824778314; -14.767244315530274 -8.753615472677186 … -3.4764297867788665 -8.75356703433328;;; -12.76263111776694 -7.944606925451676 … -3.4512642874356567 -7.944614890040132; -7.944603084524756 -5.627164386822367 … -2.982037556798212 -5.62720598262035; … ; -3.451318827452215 -2.982060555262494 … -2.051531114372921 -2.9820369124829966; -7.944619455685231 -5.627209648228886 … -2.9820060104487305 -5.627182326079071;;; -4.361641475211774 -3.716158120366831 … -2.5085147144155795 -3.7161626444280493; -3.7161494763415805 -3.216496865232382 … -2.2433905807418997 -3.216513871313401; … ; -2.5085084711953196 -2.243436583995307 … -1.6836565141546775 -2.2434215135722253; -3.716163825689974 -3.216518942614167 … -2.243374615441132 -3.2165055863979495]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, NamedTuple{(:ψ_reals,), Tuple{Array{ComplexF64, 3}}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)])]), basis = PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), energies = Energies(total = -28.93960345658775), converged = true, occupation_threshold = 1.0e-6, ρ = [0.4340450181540018 0.38353941597180535 … 0.25505646749193756 0.3835393122509116; 0.3835407890745086 0.33716881310006996 … 0.222187395481287 0.3371681731737376; … ; 0.25505891195044383 0.22218908809894602 … 0.1447186160531636 0.22218952667746272; 0.38354037481876946 0.3371680196687881 … 0.2221881162617144 0.33716858657624726;;; 0.3631705632670393 0.34779620560579727 … 0.27198012101177643 0.3477955091296435; 0.3477983073934624 0.3262053652084331 … 0.24595053606158618 0.32620009172949516; … ; 0.2719790598817561 0.24594508387225078 … 0.1735848697793241 0.2459501090028444; 0.34779420994105814 0.3261953334517622 … 0.2459491974004035 0.32620005363887833;;; 0.21370686859294774 0.27316109274454137 … 0.3101261680294397 0.2731606508026212; 0.27315449622781796 0.30452964084099043 … 0.2989479193979348 0.30451238566987904; … ; 0.31011568055109645 0.29893427006605955 … 0.23790790780966425 0.29895279022821114; 0.27315751854811693 0.30451087906031604 … 0.29895728979572966 0.30452894699063193;;; … ;;; 0.1440138432506288 0.24598421576552248 … 0.3456197053411254 0.24597868023933986; 0.24597940249459121 0.3072875762113384 … 0.34238336293123484 0.30724154391973746; … ; 0.3455744976764452 0.3423567349527161 … 0.28563892730478074 0.3423941780835998; 0.24595366139566066 0.3072295692097322 … 0.3424222289350383 0.30726550521431745;;; 0.21370572207266986 0.27316949052075234 … 0.31013875018764697 0.27316795646378406; 0.2731638453440678 0.3045474547183789 … 0.2989442204512405 0.3045152345995345; … ; 0.31010728655720377 0.2989279275760804 … 0.23792053936220903 0.298957149694553; 0.2731517858559677 0.30451034122351933 … 0.2989776039236393 0.3045393180705814;;; 0.36316948207850286 0.3477958880150706 … 0.2719795216920382 0.34779615576151285; 0.3477927505922822 0.3262023573194207 … 0.24593854447326483 0.32619097797830093; … ; 0.27196993942381503 0.2459359773251577 … 0.17358610768055757 0.24594716875926653; 0.34779200198605054 0.32619215136056173 … 0.24595430365376666 0.32620373650040796;;;; 0.43835199273321135 0.38780513990909266 … 0.25922622729137934 0.38780382458105617; 0.3878014032435458 0.34139594094595554 … 0.22628238368328654 0.3413972306308475; … ; 0.25922571484303375 0.22628247903919035 … 0.1485061875058233 0.22628107891275054; 0.3878061862300851 0.3414014130459969 … 0.22628223383160748 0.34139855166498095;;; 0.36537498319422473 0.3373502213665551 … 0.24781848766494388 0.3373449545314394; 0.33734266216042297 0.30790101881559767 … 0.22149293333705575 0.307897605151064; … ; 0.2478241374408818 0.22150130661863474 … 0.15364853560197533 0.2214999469703621; 0.33735159176857377 0.30790931741526717 … 0.22149838713540157 0.30790452561447357;;; 0.2126529032251746 0.23124519006446936 … 0.2227889932368635 0.2312371188913998; 0.23123528223440984 0.23693920231507778 … 0.21020841408691085 0.23693270331842434; … ; 0.2228035897598474 0.21022610929492488 … 0.16307006011604433 0.21022514764805939; 0.23124947912437055 0.23695159522364043 … 0.21021915384211293 0.23694518527740094;;; … ;;; 0.1423709798361319 0.18287761305241307 … 0.21226891471595905 0.1828777274130438; 0.18289128194498724 0.20500434510528265 … 0.2058620191366452 0.20501026091611757; … ; 0.21226673999902793 0.2058526206238313 … 0.16764049609413723 0.2058497659277857; 0.18287339465941632 0.20499471447785053 … 0.2058490983342735 0.20498927466831793;;; 0.21265660658936011 0.23124063337128317 … 0.22279154094129103 0.23124327210871692; 0.23124937003141677 0.23694333791150446 … 0.21022004649858445 0.23694985938301003; … ; 0.22278790171815505 0.21021040254759432 … 0.16305738643087644 0.21020995746505797; 0.23124063511439702 0.23693895469915166 … 0.21021098627851723 0.23693732948488022;;; 0.36537784299560666 0.3373481269302391 … 0.2478216844223618 0.3373499351643933; 0.337349783940137 0.3079026915254822 … 0.22150074016955099 0.30790757474481506; … ; 0.24781858889288033 0.22149497321128264 … 0.15364312432575683 0.2214942724465364; 0.3373497165790125 0.30790449923303725 … 0.22149604202661283 0.30790320942296584], α = 0.8, eigenvalues = [[-1.335162686261445, -0.7240211634989027, -0.4460268417236975, -0.4459765171853096, -0.4074014310969641, -0.05960078456640969, -0.05954780984707565, 0.014991362203442358, 0.19476311786834388, 0.2077882347707377, 0.2420263837328374], [-1.3030158643679781, -0.6645018967578127, -0.39224944057151123, -0.3922349507606333, -0.37557269736580345, 0.01220169783618898, 0.012217371317045056, 0.026884616978362544, 0.2067088348799348, 0.21355771933635748, 0.2593953221650206]], occupation = [[1.0, 1.0, 1.0, 1.0, 1.0, 0.9937000864891833, 0.9936332717606021, 0.002721486038290925, 1.98403704173918e-54, 7.799154550071653e-61, 2.0113367937189803e-79], [1.0, 1.0, 1.0, 1.0, 1.0, 0.004906954058717223, 0.004891217068458902, 0.0001469845847470061, 2.7341504514772255e-60, 8.658262080751394e-64, 8.001375065818833e-90]], εF = -0.024317794977571618, n_bands_converge = 8, n_iter = 6, ψ = Matrix{ComplexF64}[[-0.11821633484993962 + 0.23701981107157225im -1.4055696872150964e-6 + 2.9634341825705796e-6im … -0.016167573828414848 + 0.07886425395543414im 1.5724192373423544e-6 + 2.1806054351740266e-6im; -0.08928407247924566 + 0.1790124729822496im 3.449898438459417e-5 + 6.171332604430774e-6im … -0.021551962539750457 + 0.0951654939254597im 0.34054470102801465 - 0.019017499857711954im; … ; -0.027172234398718177 + 0.05447961298332534im -0.0584262417320896 - 0.0261397454111476im … -0.0038203516706509805 + 0.017505770198134138im 0.0009492607956043014 - 0.012639887557372803im; -0.049871820167264456 + 0.0999895680397302im -0.1256690762835807 - 0.05621141091472531im … -0.003528978332813421 + 0.015419310711324312im -0.017023050961252693 - 0.02872723165055257im], [-0.26016927200008994 - 0.025717184217141538im -1.0379858667079817e-5 + 2.6662144297705663e-6im … 0.07010159125696581 - 0.04603952649084879im -7.539221850863461e-6 - 8.568011450137384e-6im; -0.196417013953985 - 0.019421148884473792im -1.7537011753236396e-5 - 1.735400147007219e-5im … 0.07989168348855352 - 0.05153112438723773im -0.08830300174100587 - 0.3321608546529886im; … ; -0.06058294551391053 - 0.0059883847308797415im -0.016050373861858903 - 0.06256665927516455im … 0.014366647845926526 - 0.009341634594447824im -0.013049364083338507 - 0.00038942452546533995im; -0.1108983163994691 - 0.010965787175884489im -0.034384911649624865 - 0.13403103252536117im … 0.012680618994643159 - 0.008163338685680971im -0.02654830460394253 + 0.021001357920273262im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :n_iter, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-1.335162686261445, -0.7240211634989027, -0.4460268417236975, -0.4459765171853096, -0.4074014310969641, -0.05960078456640969, -0.05954780984707565, 0.014991362203442358, 0.19476311786834388, 0.2077882347707377, 0.2420263837328374], [-1.3030158643679781, -0.6645018967578127, -0.39224944057151123, -0.3922349507606333, -0.37557269736580345, 0.01220169783618898, 0.012217371317045056, 0.026884616978362544, 0.2067088348799348, 0.21355771933635748, 0.2593953221650206]], X = [[-0.11821633484993962 + 0.23701981107157225im -1.4055696872150964e-6 + 2.9634341825705796e-6im … -0.016167573828414848 + 0.07886425395543414im 1.5724192373423544e-6 + 2.1806054351740266e-6im; -0.08928407247924566 + 0.1790124729822496im 3.449898438459417e-5 + 6.171332604430774e-6im … -0.021551962539750457 + 0.0951654939254597im 0.34054470102801465 - 0.019017499857711954im; … ; -0.027172234398718177 + 0.05447961298332534im -0.0584262417320896 - 0.0261397454111476im … -0.0038203516706509805 + 0.017505770198134138im 0.0009492607956043014 - 0.012639887557372803im; -0.049871820167264456 + 0.0999895680397302im -0.1256690762835807 - 0.05621141091472531im … -0.003528978332813421 + 0.015419310711324312im -0.017023050961252693 - 0.02872723165055257im], [-0.26016927200008994 - 0.025717184217141538im -1.0379858667079817e-5 + 2.6662144297705663e-6im … 0.07010159125696581 - 0.04603952649084879im -7.539221850863461e-6 - 8.568011450137384e-6im; -0.196417013953985 - 0.019421148884473792im -1.7537011753236396e-5 - 1.735400147007219e-5im … 0.07989168348855352 - 0.05153112438723773im -0.08830300174100587 - 0.3321608546529886im; … ; -0.06058294551391053 - 0.0059883847308797415im -0.016050373861858903 - 0.06256665927516455im … 0.014366647845926526 - 0.009341634594447824im -0.013049364083338507 - 0.00038942452546533995im; -0.1108983163994691 - 0.010965787175884489im -0.034384911649624865 - 0.13403103252536117im … 0.012680618994643159 - 0.008163338685680971im -0.02654830460394253 + 0.021001357920273262im]], residual_norms = [[0.000628293145588369, 0.0014616800682611438, 0.0006294230070569281, 0.0006035984258488821, 0.0005254473569099554, 0.0007933396026455503, 0.0007539278074451025, 0.0011859255301829344, 0.0012443595243434964, 0.0017282357934637357, 0.002464399543838246], [0.0004933181118064525, 0.001235974991404451, 0.0010397481888953614, 0.0009010875809596211, 0.000680922664190879, 0.0017835863387674622, 0.0018008389049090296, 0.0022918187482137394, 0.0017534964781692605, 0.002972904458240536, 0.0073467039802806]], n_iter = [1, 1], converged = 1, n_matvec = 44)], stage = :finalize, history_Δρ = [0.7350510306672371, 0.15035455887392785, 0.07205997504658086, 0.06565353348956729, 0.018277266910288352, 0.007425921019838952], history_Etot = [-27.64717782290865, -28.92275440516894, -28.93092544533578, -28.93760575605639, -28.939575552534478, -28.93960345658775], runtime_ns = 0x0000000023739315, algorithm = &quot;SCF&quot;)</code></pre><p>Notice that the <code>ρ</code> argument is now passed to kwargs<em>scf</em>checkpoints instead. If we run in the same folder the SCF again (here using a tighter tolerance), the calculation just continues.</p><pre><code class="language-julia hljs">checkpointargs = kwargs_scf_checkpoints(basis; ρ=guess_density(basis, magnetic_moments))
scfres = self_consistent_field(basis; tol=1e-3, checkpointargs...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-7.847975050004954 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057803 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [5.659892306894449 5.429402408182405 … 4.799065895878188 5.4294319978019665; 5.429405564120005 5.209328440475215 … 4.610208010059866 5.209360153165644; … ; 4.79905470080579 4.610192474188792 … 4.099441198841275 4.610210739835335; 5.429427483131016 5.209351680991841 … 4.610216791705164 5.209375054048088;;; 5.539247065263989 5.336936700109839 … 4.758054203553172 5.337000037271248; 5.336952410779278 5.138702255767231 … 4.578752872916298 5.13876700023813; … ; 4.758020101011732 4.578708610887069 … 4.083769148874233 4.5787431824421345; 5.336979421793848 5.138732923052011 … 4.578759493416404 5.138782511313888;;; 5.245447414414027 5.102652549249118 … 4.63346314483938 5.102742527924359; 5.1026776246552465 4.9507629991546755 … 4.47496132824538 4.9508532254936055; … ; 4.6334147356407325 4.474897613809994 … 4.015416003667578 4.4749458460426315; 5.102711440500031 4.950801176085872 … 4.474968062263365 4.950872131446709;;; … ;;; 4.913258476890449 4.808714417674927 … 4.414323038212813 4.808737831833969; 4.8087251086428715 4.687506671941628 … 4.2716592236426285 4.687526456894876; … ; 4.41431452380765 4.271643144944809 … 3.8434143754404295 4.271663281448291; 4.808731927036441 4.687510634600363 … 4.271666082960423 4.6875343763433595;;; 5.245390050206039 5.102628259182222 … 4.633375807755413 5.102658747454442; 5.102635726449021 4.95075432987586 … 4.47488038794444 4.950780486159107; … ; 4.633372060296225 4.474870301245895 … 4.015363675307936 4.474893979446102; 5.102656714342563 4.950770925885117 … 4.4748950386862045 4.950800330369815;;; 5.539200085613928 5.336913770016891 … 4.757992138944212 5.3369367068510405; 5.336915095979416 5.1386887898278015 … 4.578695239376555 5.138710876052109; … ; 4.757991704452727 4.578691250163234 … 4.083734778821063 4.578708397004913; 5.336938442895832 5.138709885118862 … 4.578708867554709 5.138730499507407]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-1.0075912116455035 -0.9757119659246801 … -0.8487210285876461 -0.9757009312091918; -0.9757007424024835 -0.9296289276540746 … -0.8471899408256194 -0.9296016669376365; … ; -0.8488103865801502 -0.84715797788278 … -0.6673922317154795 -0.8471410145995559; -0.975708987605829 -0.9296378165062263 … -0.8471882035645182 -0.9295977467308972;;; -0.9898530184764953 -0.9544376016529078 … -0.9009267246321743 -0.9544767954810808; -0.9544356405123764 -0.9323082731460802 … -0.8786030324191654 -0.9323639070931505; … ; -0.9009008952348034 -0.878563242947693 … -0.7913790342073488 -0.8785761539729866; -0.954453201328496 -0.9323455291628326 … -0.8785915738276284 -0.932371545032683;;; -0.7547190156572098 -0.8565767075021791 … -0.9145165884442535 -0.8567253183637386; -0.8566201086399288 -0.8894104478370561 … -0.9072014459162472 -0.8895235283475945; … ; -0.9144779046341001 -0.9071560692730946 … -0.8647913525508044 -0.9071861405384893; -0.8566699295540806 -0.8894609966303437 … -0.9071941455984609 -0.8895318423759037;;; … ;;; -0.6146128561799657 -0.8437164967058826 … -0.9685837766656036 -0.843785015134571; -0.8437322013326268 -0.9185914902797925 … -0.958240173219096 -0.918630249536358; … ; -0.9685746575522555 -0.9582269920928381 … -0.9351551383227065 -0.9582516874616526; -0.8437705855614863 -0.9186050603039038 … -0.9582513973713362 -0.9186558769331009;;; -0.7546920754134006 -0.8566003523235761 … -0.9144664936246876 -0.8566493012840607; -0.8566025852785084 -0.8894453304422448 … -0.9071523649798454 -0.8894655049763802; … ; -0.9144863030991961 -0.9071594945931195 … -0.8647805351057188 -0.9071839310818687; -0.8566590357121163 -0.8894717493291671 … -0.9071715951184627 -0.8895035840958623;;; -0.9898030660216415 -0.9544030978676245 … -0.9008856047964616 -0.9544127818076461; -0.9543937085054837 -0.9323056002379527 … -0.8785059039608196 -0.9323040762749599; … ; -0.9008916011772187 -0.8785450509837001 … -0.7913821900497717 -0.8785567406775742; -0.9544322291921978 -0.932330499776038 … -0.878531101583349 -0.9323247743982538]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-3.1956739547560087 -2.814737997947958 … -2.036087306188948 -2.814697373612906; -2.81472361848816 -2.5020499349779364 … -1.8916446020332707 -2.501990961571069; … ; -2.0361878592538494 -1.8916281749615054 … -1.402818184037087 -1.8915929460317384; -2.8147099446804953 -2.5020355833134613 … -1.8916340831268714 -2.5019721404818855;;; -4.350040358987229 -3.705165265573656 … -2.515862857489459 -3.70514112224042; -3.7051475937636855 -3.211367820914195 … -2.257147980485489 -3.211358710390366; … ; -2.515871130633527 -2.257152453043246 … -1.6915611893288263 -2.257130792513476; -3.705138143565235 -3.211374409646167 … -2.2571299013938457 -3.21135083725414;;; -12.70373638230099 -7.9689399942824855 … -3.5412009770724775 -7.968998626468803; -7.968958320014108 -5.684138723441669 … -3.0737485582281168 -5.684161577613278; … ; -3.54121070246097 -3.0737668960203504 … -2.140148811944783 -3.0737487350531083; -7.968974325083476 -5.6841510953037595 … -3.0737345238923455 -5.6841509856884835;;; … ;;; -28.842406893834543 -14.825245255774766 … -4.220192142381851 -14.82529036004441; -14.825250269433566 -8.86053684575781 … -3.609528306087995 -8.860555820061128; … ; -4.220191537673665 -3.6095312036595564 … -2.426053635380124 -3.6095357625248896; -14.825281835268857 -8.860546453123186 … -3.609532670922441 -8.860573528009388;;; -12.703766806265165 -7.968987929170777 … -3.5412382193368783 -7.969006389859041; -7.968982694858912 -5.684182275325673 … -3.073780417592655 -5.684176293576562; … ; -3.541261776270573 -3.0737976339044737 … -2.1401903228593393 -3.073798392193017; -7.969018157398978 -5.68419209820334 … -3.0737849969895077 -5.684194528485337;;; -4.3500373861824375 -3.7051536918813204 … -2.5158838022627057 -3.705140438987193; -3.705142976556655 -3.2113786139454956 … -2.257108485566887 -3.2113550037581957; … ; -2.5158902331349466 -2.2571516218030876 … -1.691598715224419 -2.2571461646552837; -3.705158150326955 -3.211382418192521 … -2.257120055011263 -3.2113560784261925]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, NamedTuple{(:ψ_reals,), Tuple{Array{ComplexF64, 3}}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)]), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-7.847975050004954 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057803 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [5.659892306894449 5.429402408182405 … 4.799065895878188 5.4294319978019665; 5.429405564120005 5.209328440475215 … 4.610208010059866 5.209360153165644; … ; 4.79905470080579 4.610192474188792 … 4.099441198841275 4.610210739835335; 5.429427483131016 5.209351680991841 … 4.610216791705164 5.209375054048088;;; 5.539247065263989 5.336936700109839 … 4.758054203553172 5.337000037271248; 5.336952410779278 5.138702255767231 … 4.578752872916298 5.13876700023813; … ; 4.758020101011732 4.578708610887069 … 4.083769148874233 4.5787431824421345; 5.336979421793848 5.138732923052011 … 4.578759493416404 5.138782511313888;;; 5.245447414414027 5.102652549249118 … 4.63346314483938 5.102742527924359; 5.1026776246552465 4.9507629991546755 … 4.47496132824538 4.9508532254936055; … ; 4.6334147356407325 4.474897613809994 … 4.015416003667578 4.4749458460426315; 5.102711440500031 4.950801176085872 … 4.474968062263365 4.950872131446709;;; … ;;; 4.913258476890449 4.808714417674927 … 4.414323038212813 4.808737831833969; 4.8087251086428715 4.687506671941628 … 4.2716592236426285 4.687526456894876; … ; 4.41431452380765 4.271643144944809 … 3.8434143754404295 4.271663281448291; 4.808731927036441 4.687510634600363 … 4.271666082960423 4.6875343763433595;;; 5.245390050206039 5.102628259182222 … 4.633375807755413 5.102658747454442; 5.102635726449021 4.95075432987586 … 4.47488038794444 4.950780486159107; … ; 4.633372060296225 4.474870301245895 … 4.015363675307936 4.474893979446102; 5.102656714342563 4.950770925885117 … 4.4748950386862045 4.950800330369815;;; 5.539200085613928 5.336913770016891 … 4.757992138944212 5.3369367068510405; 5.336915095979416 5.1386887898278015 … 4.578695239376555 5.138710876052109; … ; 4.757991704452727 4.578691250163234 … 4.083734778821063 4.578708397004913; 5.336938442895832 5.138709885118862 … 4.578708867554709 5.138730499507407]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-1.012518544120524 -0.9779635647795922 … -0.9029644269704781 -0.9779714491040992; -0.9779663251803212 -0.9436469820350868 … -0.843193672126228 -0.9436589972190285; … ; -0.9029249307069229 -0.8432089624338174 … -0.7667340552900931 -0.8432159124782304; -0.977969819131923 -0.943648331547268 … -0.8431976857679631 -0.9436625471517824;;; -1.0024682879685234 -0.9662172500935869 … -0.8942657837308055 -0.9662172492375638; -0.9662265369230814 -0.9380680786735115 … -0.8653975247859437 -0.9380620904968027; … ; -0.8942644013375636 -0.8653975014546262 … -0.7841221338133013 -0.8653983465078965; -0.9662284083372056 -0.9380608791639715 … -0.8654021687437694 -0.9380605240185534;;; -0.8144896277188366 -0.8329343522293307 … -0.8251765857004569 -0.832905157206168; -0.8329248792297543 -0.8330232259906791 … -0.815897740653633 -0.833003471879132; … ; -0.8251792126458912 -0.8159007261375898 … -0.7766233305192433 -0.8158983258522423; -0.8329186827126217 -0.8330150869424665 … -0.8159040590338259 -0.8330041778155435;;; … ;;; -0.6906335934806488 -0.7862972435346751 … -0.8336756407304529 -0.78626839443648; -0.7862881610081811 -0.8120521639373106 … -0.8254422175612004 -0.8120407618620382; … ; -0.8336769325955208 -0.8254480375163092 … -0.8094634681552045 -0.8254396510392117; -0.7862724044092445 -0.8120495988267532 … -0.8254371259397568 -0.8120283121681191;;; -0.8144940755595672 -0.8329243803136106 … -0.8251844361377797 -0.8329198522415884; -0.8329242750136404 -0.8330097122595961 … -0.8159062566880715 -0.8330130426861342; … ; -0.825170336872789 -0.815895012675373 … -0.7766220751523537 -0.8158944555406029; -0.832910527879274 -0.833006188784078 … -0.8159022074855987 -0.8330029798252175;;; -1.0024735606827282 -0.9662264731229978 … -0.894262967471946 -0.9662277685158926; -0.9662226842116528 -0.9380604264765718 … -0.8654068208093585 -0.9380631298134495; … ; -0.8942630598259652 -0.8654008070503486 … -0.7841162073053639 -0.8654004018400412; -0.9662170908199561 -0.9380556613102413 … -0.865402821837689 -0.9380589585434908]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-3.200601287231029 -2.81698959680287 … -2.09033070457178 -2.8169678915078133; -2.816989201265998 -2.5160679893589486 … -1.8876483333338792 -2.516048291852461; … ; -2.0903024033806217 -1.8876791595125426 … -1.5021600076117005 -1.8876678439104129; -2.816970776206589 -2.516046098354503 … -1.8876435653303163 -2.5160369409027705;;; -4.362655628479257 -3.716944914014335 … -2.50920191658809 -3.716881575996903; -3.7169384901743903 -3.217127626441626 … -2.2439424728522677 -3.217056893794018; … ; -2.509234636736287 -2.2439867115501793 … -1.6843042889347788 -2.2439529850483857; -3.7169133505739445 -3.217089759647306 … -2.243940496309987 -3.217039816240011;;; -12.763506994362617 -7.945297639009637 … -3.4518609743286808 -7.9451784653112325; -7.945263090603934 -5.627751501595292 … -2.9824448529655028 -5.627641521144815; … ; -3.4519120104727614 -2.9825115528848456 … -2.051980789913222 -2.982460920366861; -7.945223078242017 -5.627705185615882 … -2.9824444373277106 -5.627623321128123;;; … ;;; -28.918427631135224 -14.767826002603558 … -4.085284006446701 -14.767773739346318; -14.767806229109121 -8.753997519415329 … -3.4767303504300995 -8.753966332386808; … ; -4.08529381271693 -3.476752249083028 … -2.300361965212622 -3.4767237261024486; -14.767783654116615 -8.753990991646036 … -3.4767183994908613 -8.753945963244405;;; -12.763568806411332 -7.945311957160811 … -3.4519561618499703 -7.945276940816569; -7.945304384594044 -5.627746657143025 … -2.982534309300881 -5.627723831286316; … ; -3.4519458100441662 -2.9825331519867273 … -2.052031862905974 -2.982508916651751; -7.945269649566135 -5.627726537658251 … -2.9825156093566436 -5.627693924214693;;; -4.362707880843524 -3.716977067136694 … -2.50926116493819 -3.7169554256954394; -3.716971952262824 -3.217133440184115 … -2.2440094024154256 -3.217114057296685; … ; -2.509261691783693 -2.2440073778697363 … -1.6843327324800113 -2.243989825817751; -3.7169430119547133 -3.217107579726725 … -2.243991775265603 -3.2170902625714293]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, NamedTuple{(:ψ_reals,), Tuple{Array{ComplexF64, 3}}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)])]), basis = PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), energies = Energies(total = -28.939612592760124), converged = true, occupation_threshold = 1.0e-6, ρ = [0.43403281661029447 0.3835248820223661 … 0.25501257538513866 0.3835156652182107; 0.3835116207127048 0.3371350297998207 … 0.22214060766038882 0.3371347591856318; … ; 0.2550235845752251 0.2221549245101254 … 0.1446670453863161 0.2221445677802511; 0.383527633592372 0.33715504026257775 … 0.2221410108120755 0.33714030898236536;;; 0.36323673631215214 0.3478462058076826 … 0.27206196972567964 0.34789084146573596; 0.3478538525003908 0.32623524367540074 … 0.2460191263207903 0.32628570132534396; … ; 0.2720397082279217 0.24599359074841096 … 0.1736131243768998 0.24600446722038072; 0.3478757319082211 0.3262647991706011 … 0.24601496268060508 0.32628964985675685;;; 0.21384163370418488 0.27330072399560174 … 0.3104055703666369 0.27339940448577543; 0.2733270058847987 0.3046747878995452 … 0.29921478113921596 0.30477447432805643; … ; 0.31035941705646514 0.29915733108527953 … 0.2380933007297486 0.2991927801246487; 0.2733642871677927 0.30471968953857015 … 0.2992125157973033 0.3047870243821606;;; … ;;; 0.14405184176861352 0.24609728259653177 … 0.3458816305592452 0.24612800264774937; 0.24610902905055868 0.3074452069759713 … 0.3426712743103124 0.307469231088283; … ; 0.34587697275401547 0.3426568124597049 … 0.28587346654814494 0.34268335638512193; 0.2461246789024996 0.3074537911505974 … 0.34268312848742466 0.3074864749132982;;; 0.2138211548163215 0.273313855271952 … 0.3103492416558243 0.2733464580774468; 0.27331796280790677 0.3047009673752286 … 0.2991593763400158 0.30472605980344003; … ; 0.31035878275547457 0.2991623204392097 … 0.2380805575422215 0.2991854806559576; 0.27335382301360184 0.30472699280282856 … 0.29917955404408636 0.3047590734953379;;; 0.3631916722631762 0.34782927737350383 … 0.27200877057772177 0.347828847075499; 0.3478180948670976 0.32622782927119093 … 0.24596861698274575 0.3262290351686477; … ; 0.2720304247562584 0.24599093673197073 … 0.17359914730649634 0.24599087047811352; 0.34784739885487514 0.3262531367054604 … 0.2459813630635401 0.3262519166315476;;;; 0.4383655459095072 0.38781312785984795 … 0.25924790934927977 0.3878141662233091; 0.38781326757554274 0.3414086365240195 … 0.2263106619027825 0.34140917341960497; … ; 0.2592444273611088 0.2263081444282084 … 0.1485535303583336 0.22630850609048003; 0.38781185688602565 0.3414073745989327 … 0.2263104146420075 0.3414081453564167;;; 0.3653142223444276 0.33726051651484357 … 0.24772457102133913 0.3372585920910546; 0.33725932377635576 0.3078045663302282 … 0.22141097525151862 0.30780226321538157; … ; 0.24772379012956497 0.22141175172980365 … 0.15359884207989194 0.2214101691920668; 0.33725828575963473 0.307803476795025 … 0.22141094019500276 0.3078015958758997;;; 0.21246829972318687 0.2309753977920654 … 0.22245703810316284 0.2309705703784434; 0.2309738628373748 0.23662953635832898 … 0.20989254092188725 0.23662493978842022; … ; 0.2224584903301511 0.20989591018891052 … 0.16281177689086074 0.2098916176941862; 0.23097164675876136 0.23662790703550476 … 0.20989139277649155 0.23662281874663016;;; … ;;; 0.1421846860110566 0.18256019628070175 … 0.21181850423296825 0.18255917322182205; 0.1825592397759792 0.204597047558374 … 0.20540784488052044 0.20459790263403022; … ; 0.21181712086910778 0.20540651898240475 … 0.16727101342752138 0.20540526571391374; 0.1825590610786787 0.20459825921939603 … 0.20540605087166314 0.20459613572910684;;; 0.212466449998671 0.23096978580871888 … 0.22245947343230982 0.2309714723662806; 0.23097032347500987 0.23662245111257676 … 0.20989481856568243 0.23662497831577714; … ; 0.222454831440542 0.20989045781185822 … 0.1628124993044192 0.20989042590677348; 0.23096865295449923 0.2366220389180702 … 0.20989277139609328 0.23662238896295273;;; 0.36530952876733863 0.3372539404659293 … 0.24772499442929466 0.3372567168737089; 0.3372550158295871 0.3077982826706351 … 0.2214118259953659 0.30780092624811844; … ; 0.24771968669573588 0.22140702163256132 … 0.15359844867991926 0.2214079391973905; 0.33725310789517304 0.3077970814830153 … 0.22141061323663722 0.30779890601121646], α = 0.8, eigenvalues = [[-1.333971864171026, -0.7234075247601387, -0.44535905952267474, -0.44535630111776603, -0.4063806394376469, -0.05927327143350612, -0.05927175472326241, 0.015454932891916658, 0.19527162775221066, 0.20827337149034397, 0.24222781989854011], [-1.3007257662207852, -0.6619273951169418, -0.3898740671524499, -0.3898698437987964, -0.3737833006440771, 0.01486354738570066, 0.014868883172233217, 0.02829324220912514, 0.20793285818309074, 0.2144777924603007, 0.25877106938790334]], occupation = [[1.0, 1.0, 1.0, 1.0, 1.0, 0.9947167693865153, 0.9947151404400495, 0.003192135655792526, 4.249127376309853e-54, 1.795246467912401e-60, 7.633097248441372e-79], [1.0, 1.0, 1.0, 1.0, 1.0, 0.0036205704750913396, 0.0036164847094446876, 0.00013889933310681207, 2.665175186803862e-60, 1.2119245589344319e-63, 1.0652098322254428e-88]], εF = -0.023115808166216164, n_bands_converge = 8, n_iter = 2, ψ = Matrix{ComplexF64}[[-0.25407577719326685 + 0.07528385091345767im -2.1977270021769507e-6 + 2.273250462722042e-7im … -0.0789382912549916 - 0.013520872831357717im 9.445788194136496e-6 + 1.3750245004295613e-5im; -0.19188983380869948 + 0.056858110011009586im -6.914080830943418e-6 + 3.4544458913528477e-6im … -0.09849172218305395 - 0.019533560477483083im -0.4214650856907196 + 0.07487915849790987im; … ; -0.05836099258514729 + 0.017289372749912466im 0.010290185248974508 + 0.06315155318795904im … -0.017827581599642046 - 0.003236139049707026im -0.027585737033392194 + 0.0026611436985767576im; -0.10711658795870199 + 0.03173365083393655im 0.02213099329064466 + 0.13586252936319093im … -0.015666442388120014 - 0.0029573208332233014im -0.03859109684329301 + 0.00029256211128800757im], [0.11823401821319998 - 0.23322227900444037im 9.071720013111314e-6 + 6.265589411541955e-6im … 0.06532340507670598 - 0.053707644996029265im 5.41077840324217e-6 - 5.504822230558591e-6im; 0.0892436806861745 - 0.17604458473369897im 5.664559721612477e-6 + 7.94882814879202e-6im … 0.07511794011490004 - 0.06041921204504741im 0.4488316689521702 - 0.04433473312034675im; … ; 0.027518129531018846 - 0.05427616171730382im 0.03668287665855045 - 0.05317439147208615im … 0.013411129055646266 - 0.010959616992538277im 0.02710613168255349 + 0.0021387399433699062im; 0.050388425768197014 - 0.09938874358528162im 0.07860347150171573 - 0.11394222862845875im … 0.011815957641910492 - 0.00962679955834401im 0.03791278067844953 + 0.008454142478779835im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :n_iter, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-1.333971864171026, -0.7234075247601387, -0.44535905952267474, -0.44535630111776603, -0.4063806394376469, -0.05927327143350612, -0.05927175472326241, 0.015454932891916658, 0.19527162775221066, 0.20827337149034397, 0.24222781989854011], [-1.3007257662207852, -0.6619273951169418, -0.3898740671524499, -0.3898698437987964, -0.3737833006440771, 0.01486354738570066, 0.014868883172233217, 0.02829324220912514, 0.20793285818309074, 0.2144777924603007, 0.25877106938790334]], X = [[-0.25407577719326685 + 0.07528385091345767im -2.1977270021769507e-6 + 2.273250462722042e-7im … -0.0789382912549916 - 0.013520872831357717im 9.445788194136496e-6 + 1.3750245004295613e-5im; -0.19188983380869948 + 0.056858110011009586im -6.914080830943418e-6 + 3.4544458913528477e-6im … -0.09849172218305395 - 0.019533560477483083im -0.4214650856907196 + 0.07487915849790987im; … ; -0.05836099258514729 + 0.017289372749912466im 0.010290185248974508 + 0.06315155318795904im … -0.017827581599642046 - 0.003236139049707026im -0.027585737033392194 + 0.0026611436985767576im; -0.10711658795870199 + 0.03173365083393655im 0.02213099329064466 + 0.13586252936319093im … -0.015666442388120014 - 0.0029573208332233014im -0.03859109684329301 + 0.00029256211128800757im], [0.11823401821319998 - 0.23322227900444037im 9.071720013111314e-6 + 6.265589411541955e-6im … 0.06532340507670598 - 0.053707644996029265im 5.41077840324217e-6 - 5.504822230558591e-6im; 0.0892436806861745 - 0.17604458473369897im 5.664559721612477e-6 + 7.94882814879202e-6im … 0.07511794011490004 - 0.06041921204504741im 0.4488316689521702 - 0.04433473312034675im; … ; 0.027518129531018846 - 0.05427616171730382im 0.03668287665855045 - 0.05317439147208615im … 0.013411129055646266 - 0.010959616992538277im 0.02710613168255349 + 0.0021387399433699062im; 0.050388425768197014 - 0.09938874358528162im 0.07860347150171573 - 0.11394222862845875im … 0.011815957641910492 - 0.00962679955834401im 0.03791278067844953 + 0.008454142478779835im]], residual_norms = [[0.0001830048465151627, 0.0001732710328178816, 0.00018550624252461036, 0.00032224838127665865, 0.00035831607509567606, 0.0004955395623641758, 0.0006099883182688384, 0.00018870986805020687, 0.0008889621564962561, 0.001138517615643509, 0.001172165300464308], [3.905447501434481e-5, 0.0001521928816787799, 0.00015798946281470966, 0.00016715388911061214, 0.0001026845366474534, 0.00036358515605470435, 0.0003431666841654122, 0.00016925482220901298, 0.0002245465733104237, 0.0006613548309479322, 0.007203686719824771]], n_iter = [1, 1], converged = 1, n_matvec = 44)], stage = :finalize, history_Δρ = [0.0011893541448270153, 0.0004071165364578123], history_Etot = [-28.939610397683424, -28.939612592760124], runtime_ns = 0x000000000fc827b0, algorithm = &quot;SCF&quot;)</code></pre><p>Since only the density is stored in a checkpoint (and not the Bloch waves), the first step needs a slightly elevated number of diagonalizations. Notice, that reconstructing the <code>checkpointargs</code> in this second call is important as the <code>checkpointargs</code> now contain different data, such that the SCF continues from the checkpoint. By default checkpoint is saved in the file <code>dftk_scf_checkpoint.jld2</code>, which can be changed using the <code>filename</code> keyword argument of <a href="../../api/#DFTK.kwargs_scf_checkpoints-Tuple{DFTK.AbstractBasis}"><code>kwargs_scf_checkpoints</code></a>. Note that the file is not deleted by DFTK, so it is your responsibility to clean it up. Further note that warnings or errors will arise if you try to use a checkpoint, which is incompatible with your calculation.</p><p>We can also inspect the checkpoint file manually using the <code>load_scfres</code> function and use it manually to continue the calculation:</p><pre><code class="language-julia hljs">oldstate = load_scfres(&quot;dftk_scf_checkpoint.jld2&quot;)
scfres   = self_consistent_field(oldstate.basis, ρ=oldstate.ρ, ψ=oldstate.ψ, tol=1e-4);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)   Magnet   Diag   Δtime
---   ---------------   ---------   ---------   ------   ----   ------
  1   -28.93883500656                   -2.38    1.986    5.5   90.4ms
  2   -28.93950837938       -3.17       -2.78    1.985    1.0    136ms
  3   -28.93961205002       -3.98       -2.66    1.985    4.0   95.5ms
  4   -28.93961256257       -6.29       -2.79    1.985    1.0   65.1ms
  5   -28.93961288825       -6.49       -2.93    1.985    1.0   93.0ms
  6   -28.93961295936       -7.15       -3.01    1.985    1.0   61.9ms
  7   -28.93961310023       -6.85       -3.26    1.985    1.0   62.4ms
  8   -28.93961315017       -7.30       -3.59    1.985    1.5   94.7ms
  9   -28.93961316638       -7.79       -3.77    1.985    1.5   67.8ms
 10   -28.93961317205       -8.25       -4.85    1.985    1.5   68.5ms</code></pre><p>Some details on what happens under the hood in this mechanism: When using the <code>kwargs_scf_checkpoints</code> function, the <code>ScfSaveCheckpoints</code> callback is employed during the SCF, which causes the density to be stored to the JLD2 file in every iteration. When reading the file, the <code>kwargs_scf_checkpoints</code> transparently patches away the <code>ψ</code> and <code>ρ</code> keyword arguments and replaces them by the data obtained from the file. For more details on using callbacks with DFTK&#39;s <code>self_consistent_field</code> function see <a href="../../examples/scf_callbacks/#Monitoring-self-consistent-field-calculations">Monitoring self-consistent field calculations</a>.</p><p>(Cleanup files generated by this notebook)</p><pre><code class="language-julia hljs">rm(&quot;dftk_scf_checkpoint.jld2&quot;)
rm(&quot;scfres.jld2&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parallelization/">« Timings and parallelization</a><a class="docs-footer-nextpage" href="../../examples/custom_solvers/">Custom solvers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 26 December 2023 11:28">Tuesday 26 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
