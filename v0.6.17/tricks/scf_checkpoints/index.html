<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Saving SCF results on disk and SCF checkpoints · DFTK.jl</title><meta name="title" content="Saving SCF results on disk and SCF checkpoints · DFTK.jl"/><meta property="og:title" content="Saving SCF results on disk and SCF checkpoints · DFTK.jl"/><meta property="twitter:title" content="Saving SCF results on disk and SCF checkpoints · DFTK.jl"/><meta name="description" content="Documentation for DFTK.jl."/><meta property="og:description" content="Documentation for DFTK.jl."/><meta property="twitter:description" content="Documentation for DFTK.jl."/><meta property="og:url" content="https://docs.dftk.org/stable/tricks/scf_checkpoints/"/><meta property="twitter:url" content="https://docs.dftk.org/stable/tricks/scf_checkpoints/"/><link rel="canonical" href="https://docs.dftk.org/stable/tricks/scf_checkpoints/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../../examples/metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../../examples/collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../../examples/convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../../examples/pseudopotentials/">Pseudopotentials</a></li><li><a class="tocitem" href="../../examples/supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../../examples/gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../../examples/graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../../examples/geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../../examples/energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../../examples/polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../../examples/forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../../examples/dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../../examples/atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../../examples/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../examples/wannier/">Wannierization using Wannier.jl or Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../parallelization/">Timings and parallelization</a></li><li class="is-active"><a class="tocitem" href>Saving SCF results on disk and SCF checkpoints</a><ul class="internal"><li><a class="tocitem" href="#Checkpointing-of-SCF-calculations"><span>Checkpointing of SCF calculations</span></a></li></ul></li><li><a class="tocitem" href="../compute_clusters/">Using DFTK on compute clusters</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../../examples/custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../../examples/scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../../examples/compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../../examples/gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../../examples/gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../../examples/custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../../examples/cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../../examples/anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../../examples/arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../../examples/error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/setup/">Developer setup</a></li><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/style_guide/">Developer&#39;s style guide</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li><li><a class="tocitem" href="../../developer/gpu_computations/">GPU computations</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tipps and tricks</a></li><li class="is-active"><a href>Saving SCF results on disk and SCF checkpoints</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Saving SCF results on disk and SCF checkpoints</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/docs/src/tricks/scf_checkpoints.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Saving-SCF-results-on-disk-and-SCF-checkpoints"><a class="docs-heading-anchor" href="#Saving-SCF-results-on-disk-and-SCF-checkpoints">Saving SCF results on disk and SCF checkpoints</a><a id="Saving-SCF-results-on-disk-and-SCF-checkpoints-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-SCF-results-on-disk-and-SCF-checkpoints" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=v0.6.17/tricks/scf_checkpoints.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/v0.6.17/tricks/scf_checkpoints.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>For longer DFT calculations it is pretty standard to run them on a cluster in advance and to perform postprocessing (band structure calculation, plotting of density, etc.) at a later point and potentially on a different machine.</p><p>To support such workflows DFTK offers the two functions <a href="../../api/#DFTK.save_scfres-Tuple{AbstractString, NamedTuple}"><code>save_scfres</code></a> and <a href="../../api/#DFTK.load_scfres"><code>load_scfres</code></a>, which allow to save the data structure returned by <a href="../../api/#DFTK.self_consistent_field-Union{Tuple{PlaneWaveBasis{T, VT} where VT&lt;:Real}, Tuple{T}} where T"><code>self_consistent_field</code></a> on disk or retrieve it back into memory, respectively. For this purpose DFTK uses the <a href="https://github.com/JuliaIO/JLD2.jl">JLD2.jl</a> file format and Julia package.</p><div class="admonition is-info"><header class="admonition-header">Availability of `load_scfres`, `save_scfres` and checkpointing</header><div class="admonition-body"><p>As JLD2 is an optional dependency of DFTK these three functions are only available once one has <em>both</em> imported DFTK and JLD2 (<code>using DFTK</code> and <code>using JLD2</code>).</p></div></div><div class="admonition is-warning"><header class="admonition-header">DFTK data formats are not yet fully matured</header><div class="admonition-body"><p>The data format in which DFTK saves data as well as the general interface of the <a href="../../api/#DFTK.load_scfres"><code>load_scfres</code></a> and <a href="../../api/#DFTK.save_scfres-Tuple{AbstractString, NamedTuple}"><code>save_scfres</code></a> pair of functions are not yet fully matured. If you use the functions or the produced files expect that you need to adapt your routines in the future even with patch version bumps.</p></div></div><p>To illustrate the use of the functions in practice we will compute the total energy of the O₂ molecule at PBE level. To get the triplet ground state we use a collinear spin polarisation (see <a href="../../examples/collinear_magnetism/#Collinear-spin-and-magnetic-systems">Collinear spin and magnetic systems</a> for details) and a bit of temperature to ease convergence:</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra
using JLD2

d = 2.079  # oxygen-oxygen bondlength
a = 9.0    # size of the simulation box
lattice = a * I(3)
O = ElementPsp(:O; psp=load_psp(&quot;hgh/pbe/O-q6.hgh&quot;))
atoms     = [O, O]
positions = d / 2a * [[0, 0, 1], [0, 0, -1]]
magnetic_moments = [1., 1.]

Ecut  = 10  # Far too small to be converged
model = model_PBE(lattice, atoms, positions; temperature=0.02, smearing=Smearing.Gaussian(),
                  magnetic_moments)
basis = PlaneWaveBasis(model; Ecut, kgrid=[1, 1, 1])

scfres = self_consistent_field(basis, tol=1e-2, ρ=guess_density(basis, magnetic_moments))
save_scfres(&quot;scfres.jld2&quot;, scfres);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)   Magnet   Diag   Δtime
---   ---------------   ---------   ---------   ------   ----   ------
  1   -27.64408479343                   -0.13    0.001    6.5    145ms
  2   -28.92279357662        0.11       -0.83    0.667    2.0   79.9ms
  3   -28.93094210957       -2.09       -1.14    1.168    2.5   83.8ms
  4   -28.93760976502       -2.18       -1.18    1.762    2.0   70.1ms
  5   -28.93956793421       -2.71       -1.90    1.991    1.5   69.1ms
  6   -28.93960421066       -4.44       -2.28    1.982    1.0   75.2ms</code></pre><pre><code class="language-julia hljs">scfres.energies</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Energy breakdown (in Ha):
    Kinetic             16.7694430
    AtomicLocal         -58.4934607
    AtomicNonlocal      4.7115163 
    Ewald               -4.8994689
    PspCorrection       0.0044178 
    Hartree             19.3596619
    Xc                  -6.3907355
    Entropy             -0.0009782

    total               -28.939604210662</code></pre><p>The <code>scfres.jld2</code> file could now be transferred to a different computer, Where one could fire up a REPL to inspect the results of the above calculation:</p><pre><code class="language-julia hljs">using DFTK
using JLD2
loaded = load_scfres(&quot;scfres.jld2&quot;)
propertynames(loaded)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:α, :history_Δρ, :converged, :occupation, :occupation_threshold, :algorithm, :basis, :runtime_ns, :n_iter, :history_Etot, :εF, :energies, :ρ, :n_bands_converge, :eigenvalues, :ψ, :ham)</code></pre><pre><code class="language-julia hljs">loaded.energies</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Energy breakdown (in Ha):
    Kinetic             16.7694430
    AtomicLocal         -58.4934607
    AtomicNonlocal      4.7115163 
    Ewald               -4.8994689
    PspCorrection       0.0044178 
    Hartree             19.3596619
    Xc                  -6.3907355
    Entropy             -0.0009782

    total               -28.939604210662</code></pre><p>Since the loaded data contains exactly the same data as the <code>scfres</code> returned by the SCF calculation one could use it to plot a band structure, e.g. <code>plot_bandstructure(load_scfres(&quot;scfres.jld2&quot;))</code> directly from the stored data.</p><p>Notice that both <code>load_scfres</code> and <code>save_scfres</code> work by transferring all data to/from the master process, which performs the IO operations without parallelisation. Since this can become slow, both functions support optional arguments to speed up the processing. An overview:</p><ul><li><code>save_scfres(&quot;scfres.jld2&quot;, scfres; save_ψ=false)</code> avoids saving the Bloch wave, which is usually faster and saves storage space.</li><li><code>load_scfres(&quot;scfres.jld2&quot;, basis)</code> avoids reconstructing the basis from the file, but uses the passed basis instead. This save the time of constructing the basis twice and allows to specify parallelisation options (via the passed basis). Usually this is useful for continuing a calculation on a supercomputer or cluster.</li></ul><p>See also the discussion on <a href="../../examples/input_output/#Input-and-output-formats">Input and output formats</a> on JLD2 files.</p><h2 id="Checkpointing-of-SCF-calculations"><a class="docs-heading-anchor" href="#Checkpointing-of-SCF-calculations">Checkpointing of SCF calculations</a><a id="Checkpointing-of-SCF-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Checkpointing-of-SCF-calculations" title="Permalink"></a></h2><p>A related feature, which is very useful especially for longer calculations with DFTK is automatic checkpointing, where the state of the SCF is periodically written to disk. The advantage is that in case the calculation errors or gets aborted due to overrunning the walltime limit one does not need to start from scratch, but can continue the calculation from the last checkpoint.</p><p>The easiest way to enable checkpointing is to use the <a href="../../api/#DFTK.kwargs_scf_checkpoints-Tuple{DFTK.AbstractBasis}"><code>kwargs_scf_checkpoints</code></a> function, which does two things. (1) It sets up checkpointing using the <a href="../../api/#DFTK.ScfSaveCheckpoints"><code>ScfSaveCheckpoints</code></a> callback and (2) if a checkpoint file is detected, the stored density is used to continue the calculation instead of the usual atomic-orbital based guess. In practice this is done by modifying the keyword arguments passed to # <a href="../../api/#DFTK.self_consistent_field-Union{Tuple{PlaneWaveBasis{T, VT} where VT&lt;:Real}, Tuple{T}} where T"><code>self_consistent_field</code></a> appropriately, e.g. by using the density or orbitals from the checkpoint file. For example:</p><pre><code class="language-julia hljs">checkpointargs = kwargs_scf_checkpoints(basis; ρ=guess_density(basis, magnetic_moments))
scfres = self_consistent_field(basis; tol=1e-2, checkpointargs...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-7.847975050004952 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057807 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774725 -8.087664364030587 … -6.372990336410456 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [5.6607469268920685 5.430223231818384 … 4.799718038213248 5.430224173716247; 5.430223255968446 5.210114477291855 … 4.610825319692992 5.21011394016631; … ; 4.799717021806639 4.6108241492802575 … 4.099950000850433 4.610827085413336; 5.430224125878025 5.210113743335398 … 4.610827876083158 5.210116005498823;;; 5.540087562965547 5.337769321124851 … 4.758693261041707 5.337770171046389; 5.337769938595562 5.139510678946141 … 4.579364633388357 5.139510888448345; … ; 4.7586892815297155 4.579355434683088 … 4.084279004241907 4.579361691735591; 5.337768618883202 5.139506477212947 … 4.57936262195777 5.139510027526828;;; 5.246300492924033 5.103522626498906 … 4.634123127469127 5.1035230974833325; 5.103523019048231 4.951619109045358 … 4.475599369171467 4.951619861943347; … ; 4.634118447996318 4.475585567535413 … 4.015950342578479 4.475594056909884; 5.1035214088495495 4.951613652038264 … 4.475594188947043 4.951617729615564;;; … ;;; 4.914138293478508 4.809572711587556 … 4.415035968381053 4.809573186523542; 4.809574585414797 4.688328070939563 … 4.272329105340788 4.688325926792673; … ; 4.415040173697068 4.27234282597596 … 3.8439714691716205 4.272337560125268; 4.809574394066967 4.688330444942159 … 4.272338118632487 4.688328878546846;;; 5.246257407588313 5.103475959222614 … 4.6340699633166 5.103476064753971; 5.103475419418994 4.951568153449525 … 4.475536926244297 4.951565974940491; … ; 4.6340752114897406 4.475550731898628 … 4.015905378087407 4.475546666574567; 5.103478882622525 4.95157303848996 … 4.475546508227247 4.951571665610795;;; 5.540067236389163 5.337746641850952 … 4.758666122508396 5.337747192196187; 5.337745795326083 5.1394844846748615 … 4.579331729134973 5.139483012104043; … ; 4.758669024370355 4.579339552615403 … 4.0842566008430765 4.579338732711108; 5.337749177457317 5.1394877248605555 … 4.579338841187947 5.139488092143481]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-1.0073894896574074 -0.9756240861237712 … -0.8484344089832963 -0.9756242476862657; -0.9756203801285418 -0.9302213278663535 … -0.8472248057389163 -0.9302214407822971; … ; -0.8484392350926021 -0.8472211890011655 … -0.6668860985141718 -0.8472204197452413; -0.9756199161917648 -0.9302223930265575 … -0.8472233207524702 -0.9302203610549783;;; -0.9897965271980327 -0.954457764659959 … -0.9007087562556918 -0.9544582109822746; -0.9544534348766328 -0.9325338919655048 … -0.8786603037281151 -0.9325329572215016; … ; -0.9007067331679883 -0.8786474874155294 … -0.7910766809226257 -0.8786552204311532; -0.9544525198145978 -0.9325310590661301 … -0.8786544731251715 -0.9325327613066545;;; -0.7545431059382666 -0.8566452262526814 … -0.9144561175582627 -0.8566455565445984; -0.8566386817914845 -0.889507552306194 … -0.9071914614929478 -0.8895088689891523; … ; -0.9144473474744359 -0.9071804359867647 … -0.8647600004756567 -0.9071882571071653; -0.8566394831620365 -0.8895025180258163 … -0.9071846821871051 -0.8895065860887058;;; … ;;; -0.614486088977791 -0.8437246694144748 … -0.9685592939122445 -0.843717299405235; -0.8437166142924767 -0.9186787412533163 … -0.9582816563604029 -0.9186732483375284; … ; -0.9685545239567759 -0.9582905562114776 … -0.935128169462819 -0.9582835976627243; -0.8437203983893212 -0.9186864341825975 … -0.9582882266700288 -0.9186785311822925;;; -0.7545190855156543 -0.856631126511543 … -0.9144452331867637 -0.8566253527285108; -0.8566246068647234 -0.8894946419825154 … -0.9071761780360296 -0.8894912375946905; … ; -0.9144475445561565 -0.9071882647863474 … -0.8647530758342066 -0.9071778766093038; -0.8566299509047033 -0.8895039900159867 … -0.9071841110563478 -0.8894952034425267;;; -0.9897856191373012 -0.9544463313206462 … -0.9007040398458717 -0.9544445338843263; -0.9544430832084958 -0.9325212981677518 … -0.8786388917958943 -0.9325201919739464; … ; -0.900699043543498 -0.8786579820797674 … -0.7910732099844537 -0.8786506238574578; -0.9544454750635927 -0.9325236283598636 … -0.8786464626993458 -0.9325218384765817]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-3.194617612770291 -2.81382929451107 … -2.0351485442495383 -2.8138285141757; -2.8138255643657772 -2.5018562983735753 … -1.8910621573134412 -2.501856948415064; … ; -2.035154386765452 -1.8910597109884253 … -1.4018032488266208 -1.891056005599422; -2.813824230519421 -2.501858097490236 … -1.8910581159368298 -2.5018538033552318;;; -4.3491433700072095 -3.7043528075656953 … -2.515005831624441 -3.7043524039664724; -3.704347860311658 -3.2107850165547096 … -2.25659349132238 -3.2107838723085025; … ; -2.5150077880487274 -2.256589873715063 … -1.6907489806764295 -2.2565913496781858; -3.704348264961983 -3.2107863853885283 … -2.256589672150023 -3.2107845373151713;;; -12.702707394072041 -7.9681384357831995 … -3.5404805235567403 -7.9681382950906885; -7.968131498772681 -5.683379718020125 … -3.0731005328787306 -5.683380281805094; … ; -3.54047643294572 -3.073103309008602 … -2.139583120958735 -3.0731026407545317; -7.968133910341914 -5.6833801407468405 … -3.0730989337973114 -5.68338013123243;;; … ;;; -28.841400310044307 -14.824395134570729 … -4.219454729460252 -14.8243872896255; -14.82438520562149 -8.859802697733398 … -3.6088999075311428 -8.8597993489645; … ; -4.219445754188768 -3.6088950867470455 … -2.4254695727890456 -3.608893394048984; -14.824389181066165 -8.859808016660084 … -3.6088974645490692 -8.859801680055092;;; -12.702726458985147 -7.968171003318352 … -3.540522803337767 -7.968165124003963; -7.968165023475153 -5.683417763292279 … -3.0731476923489818 -5.683416537413487; … ; -3.5405198665340185 -3.0731459734449684 … -2.139621160808356 -3.0731396505919872; -7.968166904311603 -5.683422226285317 … -3.0731460433863496 -5.683414812591022;;; -4.349152788522863 -3.7043640535002815 … -2.515028253747931 -3.704361705718726; -3.7043616519129996 -3.2107986170282348 … -2.256604983643544 -3.2107989834052475; … ; -2.515020355583598 -2.256616250446986 … -1.6907679131370879 -2.2566097121289728; -3.7043606616368647 -3.2107977070346534 … -2.256605442494022 -3.210795549868446]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, @NamedTuple{ψ_reals::Array{ComplexF64, 3}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)]), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-7.847975050004952 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057807 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774725 -8.087664364030587 … -6.372990336410456 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [5.6607469268920685 5.430223231818384 … 4.799718038213248 5.430224173716247; 5.430223255968446 5.210114477291855 … 4.610825319692992 5.21011394016631; … ; 4.799717021806639 4.6108241492802575 … 4.099950000850433 4.610827085413336; 5.430224125878025 5.210113743335398 … 4.610827876083158 5.210116005498823;;; 5.540087562965547 5.337769321124851 … 4.758693261041707 5.337770171046389; 5.337769938595562 5.139510678946141 … 4.579364633388357 5.139510888448345; … ; 4.7586892815297155 4.579355434683088 … 4.084279004241907 4.579361691735591; 5.337768618883202 5.139506477212947 … 4.57936262195777 5.139510027526828;;; 5.246300492924033 5.103522626498906 … 4.634123127469127 5.1035230974833325; 5.103523019048231 4.951619109045358 … 4.475599369171467 4.951619861943347; … ; 4.634118447996318 4.475585567535413 … 4.015950342578479 4.475594056909884; 5.1035214088495495 4.951613652038264 … 4.475594188947043 4.951617729615564;;; … ;;; 4.914138293478508 4.809572711587556 … 4.415035968381053 4.809573186523542; 4.809574585414797 4.688328070939563 … 4.272329105340788 4.688325926792673; … ; 4.415040173697068 4.27234282597596 … 3.8439714691716205 4.272337560125268; 4.809574394066967 4.688330444942159 … 4.272338118632487 4.688328878546846;;; 5.246257407588313 5.103475959222614 … 4.6340699633166 5.103476064753971; 5.103475419418994 4.951568153449525 … 4.475536926244297 4.951565974940491; … ; 4.6340752114897406 4.475550731898628 … 4.015905378087407 4.475546666574567; 5.103478882622525 4.95157303848996 … 4.475546508227247 4.951571665610795;;; 5.540067236389163 5.337746641850952 … 4.758666122508396 5.337747192196187; 5.337745795326083 5.1394844846748615 … 4.579331729134973 5.139483012104043; … ; 4.758669024370355 4.579339552615403 … 4.0842566008430765 4.579338732711108; 5.337749177457317 5.1394877248605555 … 4.579338841187947 5.139488092143481]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-1.0125701927340351 -0.9780277974638115 … -0.9029389254528013 -0.9780284984858104; -0.9780310774206598 -0.9436766458578477 … -0.8432448779287119 -0.9436759954687987; … ; -0.9029522565352042 -0.8432315107128877 … -0.7667074473017255 -0.8432340365530232; -0.9780318699180017 -0.9436761026494167 … -0.8432474322756907 -0.9436782303821131;;; -1.0024099778051705 -0.9662572904392225 … -0.8942898074076946 -0.9662558225398911; -0.9662622821630081 -0.9381565729668346 … -0.8654223447642218 -0.9381553617434095; … ; -0.8942875677509 -0.8654325997553374 … -0.7841593589708595 -0.8654297857142447; -0.9662625867520944 -0.9381577419631625 … -0.8654251267478833 -0.9381568481955859;;; -0.8146435177296366 -0.8330505329785924 … -0.8252606309013547 -0.8330440316468798; -0.8330549327666001 -0.8331850366987066 … -0.8160126707439256 -0.8331811955213979; … ; -0.825271418583554 -0.8160252927698883 … -0.7766770098553968 -0.8160186272662765; -0.8330554361778549 -0.8331880527342576 … -0.8160163201666817 -0.8331835854019621;;; … ;;; -0.6908762323902238 -0.7864798437942477 … -0.8338121724256112 -0.7864942968250002; -0.7864986156894992 -0.8122423018656755 … -0.8255792205255443 -0.8122526579892256; … ; -0.8338173148145832 -0.8255701671124797 … -0.8095511640025234 -0.8255762147694484; -0.786488580560758 -0.812231716003161 … -0.8255740072463478 -0.8122431848221371;;; -0.8146714937976935 -0.8330575264794797 … -0.8252607407112423 -0.8330667841820187; -0.8330679288884605 -0.83318515843702 … -0.8160134173439586 -0.8331908660574107; … ; -0.8252623819093928 -0.8160037254863237 … -0.7766698123477891 -0.8160114408478717; -0.8330664022219293 -0.8331810072094438 … -0.8160099461139627 -0.833190129271101;;; -1.0024305811349357 -0.9662731891390375 … -0.8942972442425373 -0.966275897058479; -0.9662776714067847 -0.938167712297415 … -0.8654353999154616 -0.9381693099030646; … ; -0.8942978040376297 -0.8654273712148525 … -0.7841625825171261 -0.8654325375386569; -0.9662782276278992 -0.9381677166125132 … -0.865434416114969 -0.938170719698934]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-3.1997983158469188 -2.8162330058511102 … -2.0896530607190433 -2.8162327649752448; -2.8162362616578953 -2.5153116163650693 … -1.8870822295032368 -2.5153115031015654; … ; -2.089667408208054 -1.8870700327001475 … -1.5016245976141744 -1.8870696224072039; -2.8162361842456582 -2.515311807113095 … -1.8870822274600503 -2.5153116726823668;;; -4.361756820614347 -3.716152333344959 … -2.5085868827764437 -3.716150015524089; -3.7161567075980333 -3.2164076975560394 … -2.243355532358487 -3.2164062768304102; … ; -2.508588622631639 -2.243374986054871 … -1.6838316587246633 -2.2433659149612772; -3.7161583318994795 -3.2164130682855605 … -2.243360325772735 -3.216408624204103;;; -12.762807805863412 -7.944543742509111 … -3.4512850368998325 -7.94453677019297; -7.944547749747796 -5.6270572024126375 … -2.981921742129708 -5.62705260833734; … ; -3.451300504054838 -2.9819481657917253 … -2.051500130338475 -2.9819330109136426; -7.944549863357731 -5.627065675455282 … -2.9819305717768883 -5.627057130545687;;; … ;;; -28.91779045345674 -14.767150308950502 … -4.084707607973619 -14.767164287045265; -14.767167207018513 -8.753366258345759 … -3.4761974716962842 -8.753378758616199; … ; -4.084708545046575 -3.4761746976480477 … -2.29989256732875 -3.4761860111557077; -14.767157363237601 -8.753353298480647 … -3.4761832451253882 -8.753366333694936;;; -12.762878867267187 -7.944597403286289 … -3.4513383108622455 -7.9446065554574705; -7.9446083454988905 -5.627108279746784 … -2.9819849316569105 -5.627116165876208; … ; -3.451334703887255 -2.981961434144945 … -2.0515378973219383 -2.981973214830555; -7.9446033556288285 -5.627099243478773 … -2.9819718784439644 -5.6271097384195965;;; -4.361797750520498 -3.7161909113186726 … -2.5086214581445967 -3.716193068892879; -3.7161962401112887 -3.216445031157898 … -2.2434014917631107 -3.2164481013343655; … ; -2.5086191160777296 -2.2433856395820713 … -1.6838572856697602 -2.243391625810172; -3.716193414201171 -3.2164417952873032 … -2.243393395909645 -3.216444431090798]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, @NamedTuple{ψ_reals::Array{ComplexF64, 3}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)])]), basis = PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), energies = Energies(total = -28.939611790386113), converged = true, occupation_threshold = 1.0e-6, ρ = [0.43410709333695596 0.38358354466337197 … 0.2550536520274295 0.38358305390171216; 0.3835825128134244 0.33719407010340063 … 0.22217381225092264 0.3371938804382522; … ; 0.25505246055182773 0.22217310029068352 … 0.14468225508662272 0.22217295692753328; 0.3835826313214158 0.3371942492317946 … 0.22217369108210827 0.3371937733634468;;; 0.3632574600642434 0.3478906707464699 … 0.27205371027248115 0.3478908497569967; 0.3478891515179684 0.32629271502404944 … 0.2460135606994254 0.3262939646976804; … ; 0.2720491334997838 0.24600372944658494 … 0.1736080533004256 0.24600875291969038; 0.3478883837895787 0.3262892427619331 … 0.24600939269137626 0.32629195191178106;;; 0.21380977154383035 0.2733411124084339 … 0.31036881801044414 0.2733412792229701; 0.2733376932241145 0.3047469434279375 … 0.2991929657447601 0.30474869685043693; … ; 0.31036159101503613 0.29917695826132173 … 0.23808205526580103 0.2991855691972343; 0.2733375937238657 0.30474180536762585 … 0.2991862032280065 0.3047464627436469;;; … ;;; 0.1440459562521946 0.24613712854960487 … 0.34592130264945675 0.24613496090073927; 0.2461352505293779 0.30750177273543355 … 0.3427119540129691 0.3074982461868371; … ; 0.34592167332940604 0.3427259902113113 … 0.28590208830196107 0.3427159744935038; 0.2461361645679069 0.3075080180871593 … 0.3427204098114027 0.30750162298128264;;; 0.21380022846732658 0.2733329665616819 … 0.3103568300034546 0.2733296897445756; 0.2733292512493571 0.30473740484576717 … 0.29917185763391896 0.30473323450224615; … ; 0.3103600116013265 0.2991875356361974 … 0.23807704317618025 0.299178024776375; 0.2733329631866501 0.30474547415494835 … 0.2991804486604646 0.3047384671620307;;; 0.3632469037247608 0.34788209728582065 … 0.2720452255651764 0.3478800962695711; 0.3478796532324069 0.32628383664800714 … 0.24600022520423664 0.32628134657716085; … ; 0.2720473879614308 0.2460095326095415 … 0.17360581009366474 0.24600414057142045; 0.34788219006875637 0.3262887866198455 … 0.2460052393989795 0.3262846483536601;;;; 0.4384321886068777 0.3878731298873094 … 0.259283939766789 0.3878741597582645; 0.38787431435194936 0.3414620969330514 … 0.2263394965688482 0.34146178169171226; … ; 0.2592848443874775 0.22633968359171627 … 0.14856709908166496 0.22634119123590557; 0.3878750645512103 0.341461525646096 … 0.22634087031949662 0.34146339156660926;;; 0.36537755039645564 0.3373264275283432 … 0.24777743906500121 0.33732417307668694; 0.33732620555607773 0.3078693153370321 … 0.22145715195481078 0.30786647820408936; … ; 0.24778208195177148 0.2214621763948809 … 0.1536284664584577 0.22146105373180652; 0.3373274411390342 0.3078700160621538 … 0.22145910855801018 0.30786842798365394;;; 0.21255774676736472 0.23107772068912774 … 0.22255493716039249 0.23107312164931926; 0.23107696806615619 0.23673556360311787 … 0.20998149581377498 0.23673140124162956; … ; 0.22256403121672436 0.20999112224049257 … 0.16287648814659036 0.20998784550738378; 0.23107902800675245 0.23673801352146254 … 0.20998366906845023 0.2367335934204861;;; … ;;; 0.14228287416791327 0.18266616992380189 … 0.21192213281171535 0.1826729050445135; 0.18267546029926607 0.20471185805553743 … 0.20550313951865704 0.204717602639389; … ; 0.2119200325079265 0.20549538510597898 … 0.16733146657846099 0.20549979382246814; 0.18266957272439535 0.20470613939154228 … 0.2054994007473815 0.2047123634905467;;; 0.2125707092993704 0.23107751002496432 … 0.22255536898966505 0.23108375555409116; 0.23108382685242085 0.2367327087428322 … 0.2099814448191865 0.23673770225677693; … ; 0.22255360821915704 0.20997525143527532 … 0.16286885843883805 0.20997979835005554; 0.23108183369638957 0.236729807532569 … 0.20997975150595435 0.2367359702452344;;; 0.365397713850641 0.33733707396618173 … 0.2477848170555276 0.3373412743049799; 0.3373405294437978 0.30787647151761327 … 0.2214630869370211 0.3078791418138092; … ; 0.24778351288782538 0.2214592574001822 … 0.15362829425258828 0.22146288558198152; 0.33734046353461966 0.3078749135423977 … 0.22146320652822743 0.30787964337607915], α = 0.8, eigenvalues = [[-1.3349030610257784, -0.7241848678906839, -0.4460872903530766, -0.4460805163172553, -0.4070971674514567, -0.05995380841802984, -0.05994705125803386, 0.015189787945055329, 0.19504244692937153, 0.20806052521656487, 0.2422947841386776], [-1.3017375388502745, -0.662582667429851, -0.39060122597885266, -0.3905987242827076, -0.37442289960810826, 0.014268015146128686, 0.014270326136642687, 0.02742976539209582, 0.2073141296412299, 0.21386945243698896, 0.2605556579221653]], occupation = [[1.0, 1.0, 1.0, 1.0, 1.0, 0.9948147788509405, 0.9948076381671869, 0.002977687541002339, 2.8645173476484006e-54, 1.1601639143139924e-60, 3.187834885560073e-79], [1.0, 1.0, 1.0, 1.0, 1.0, 0.0036259570284352016, 0.0036241845648500724, 0.0001497538475839534, 2.7602239311855335e-60, 1.2409209500629728e-63, 3.673702648974076e-90]], εF = -0.023704314113764485, n_bands_converge = 8, n_iter = 7, ψ = Matrix{ComplexF64}[[0.07925915770695842 - 0.25279477390351396im -5.136262077665714e-6 - 2.030548696783415e-6im … 0.04695091868430456 - 0.06486188001185954im 2.574569450696492e-6 - 5.798068242534202e-6im; 0.05987015435161979 - 0.19095663096396895im -6.499969320726299e-6 + 3.437176633325934e-6im … 0.05459789718588487 - 0.07711695319810236im 0.08716787842539557 - 0.17009992785011463im; … ; 0.018214536081467392 - 0.0580876502248376im 0.02260006789228911 - 0.059878606767325704im … 0.01033180134425473 - 0.014368795840252557im 0.00603222271776451 + 0.015973865609459056im; 0.03342448200096085 - 0.10659023694913543im 0.04860832453349131 - 0.1287864689829003im … 0.008912390363945828 - 0.012437723094860922im 0.010070146611892726 + 0.046889335960759275im], [-0.06586834608263922 - 0.25296114339909626im -8.492102145633925e-6 + 7.842187813715401e-6im … 0.04622895705708321 + 0.07049377501734831im -1.1364925778108476e-5 - 1.0753898300444975e-5im; -0.04972124660475883 - 0.1909555174876637im -1.5201872925599242e-5 - 3.948575992930974e-6im … 0.05109306807829894 + 0.07692779633599583im -0.0705348607236403 - 0.19305932519669416im; … ; -0.01533553455362611 - 0.05890231114266483im -0.043896284452484356 - 0.04739002119885743im … 0.009392198330698041 + 0.014248944515178446im 0.014571863029611378 + 0.004642962561290118im; -0.028078026614821228 - 0.1078468772749125im -0.09405363352839446 - 0.10153756654868698im … 0.008201926191447469 + 0.012391573353207386im 0.04124629022001274 + 0.024341650339707872im]], diagonalization = @NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}[(λ = [[-1.3349030610257784, -0.7241848678906839, -0.4460872903530766, -0.4460805163172553, -0.4070971674514567, -0.05995380841802984, -0.05994705125803386, 0.015189787945055329, 0.19504244692937153, 0.20806052521656487, 0.2422947841386776], [-1.3017375388502745, -0.662582667429851, -0.39060122597885266, -0.3905987242827076, -0.37442289960810826, 0.014268015146128686, 0.014270326136642687, 0.02742976539209582, 0.2073141296412299, 0.21386945243698896, 0.2605556579221653]], X = [[0.07925915770695842 - 0.25279477390351396im -5.136262077665714e-6 - 2.030548696783415e-6im … 0.04695091868430456 - 0.06486188001185954im 2.574569450696492e-6 - 5.798068242534202e-6im; 0.05987015435161979 - 0.19095663096396895im -6.499969320726299e-6 + 3.437176633325934e-6im … 0.05459789718588487 - 0.07711695319810236im 0.08716787842539557 - 0.17009992785011463im; … ; 0.018214536081467392 - 0.0580876502248376im 0.02260006789228911 - 0.059878606767325704im … 0.01033180134425473 - 0.014368795840252557im 0.00603222271776451 + 0.015973865609459056im; 0.03342448200096085 - 0.10659023694913543im 0.04860832453349131 - 0.1287864689829003im … 0.008912390363945828 - 0.012437723094860922im 0.010070146611892726 + 0.046889335960759275im], [-0.06586834608263922 - 0.25296114339909626im -8.492102145633925e-6 + 7.842187813715401e-6im … 0.04622895705708321 + 0.07049377501734831im -1.1364925778108476e-5 - 1.0753898300444975e-5im; -0.04972124660475883 - 0.1909555174876637im -1.5201872925599242e-5 - 3.948575992930974e-6im … 0.05109306807829894 + 0.07692779633599583im -0.0705348607236403 - 0.19305932519669416im; … ; -0.01533553455362611 - 0.05890231114266483im -0.043896284452484356 - 0.04739002119885743im … 0.009392198330698041 + 0.014248944515178446im 0.014571863029611378 + 0.004642962561290118im; -0.028078026614821228 - 0.1078468772749125im -0.09405363352839446 - 0.10153756654868698im … 0.008201926191447469 + 0.012391573353207386im 0.04124629022001274 + 0.024341650339707872im]], residual_norms = [[0.00018088469430522057, 0.0007711813184544817, 0.0002507122644164483, 0.0002446402424907354, 0.0002783679873439717, 0.000804424602282496, 0.0008448838533083819, 0.0002126249315508499, 0.00094937820480989, 0.0013901859042858996, 0.003997015570481078], [0.0002722024549222929, 0.0006097325681819252, 0.0003825421004341001, 0.0003804934922258443, 0.00020483368752109702, 0.0008642108372648267, 0.0008536913165183485, 0.00047306059480268896, 0.0005912128577742645, 0.001420147796073882, 0.009083001922220293]], n_iter = [1, 1], converged = 1, n_matvec = 44)], stage = :finalize, history_Δρ = [0.7350518103970867, 0.1500150157297452, 0.07257237855619661, 0.06519470431073889, 0.04417475109039414, 0.01043891900261831, 0.000638764421032611], history_Etot = [-27.645102229525786, -28.92279761145919, -28.93102027540423, -28.937688552543687, -28.939489554889317, -28.939597101714842, -28.939611790386113], runtime_ns = 0x00000000289fdc02, algorithm = &quot;SCF&quot;)</code></pre><p>Notice that the <code>ρ</code> argument is now passed to kwargs<em>scf</em>checkpoints instead. If we run in the same folder the SCF again (here using a tighter tolerance), the calculation just continues.</p><pre><code class="language-julia hljs">checkpointargs = kwargs_scf_checkpoints(basis; ρ=guess_density(basis, magnetic_moments))
scfres = self_consistent_field(basis; tol=1e-3, checkpointargs...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-7.847975050004952 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057807 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774725 -8.087664364030587 … -6.372990336410456 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [5.659631891257464 5.429169713949474 … 4.798838770818832 5.429171928409948; 5.429170158064641 5.209120444624747 … 4.609998320400541 5.209121946396144; … ; 4.798837980281454 4.609998328780879 … 4.099259063639776 4.609998886104351; 5.429171262605423 5.209121429951212 … 4.609999474730762 5.20912316129785;;; 5.538941617388653 5.336679144039374 … 4.757765969155412 5.3366788209000475; 5.336676855205848 5.138473118272959 … 4.578486397391383 5.138472753488452; … ; 4.757770401440462 4.578492335877001 … 4.083548442371712 4.578491340692013; 5.336681203403962 5.1384771615196225 … 4.57848902305245 5.138476501226519;;; 5.2451480336246865 5.10241221008667 … 4.63315236262774 5.102409634573081; 5.1024076410155335 4.9505498800710805 … 4.474673326197852 4.9505477919029275; … ; 4.633160688187625 4.474683859345775 … 4.0151792368316395 4.4746815578033505; 5.1024142883255825 4.950556090835206 … 4.474677097345471 4.950553373496003;;; … ;;; 4.913174817052205 4.808644734106963 … 4.414244957339832 4.808649043953397; 4.8086493366373455 4.687443158990011 … 4.271589576368159 4.687446645056192; … ; 4.414236358483334 4.271579698194362 … 3.84334519986372 4.27158176351577; 4.80864424964823 4.687438498272574 … 4.271586687340217 4.687442289241488;;; 5.245251064734529 5.102508409745094 … 4.633247620241221 5.102514020903824; 5.102512283381055 4.950647582987354 … 4.4747660695964955 4.950651808933788; … ; 4.63323963170396 4.474757527904191 … 4.015250225924103 4.474760337708371; 5.102509541115183 4.95064479341865 … 4.474765010048173 4.950649803130529;;; 5.539006669743017 5.3367387305017795 … 4.757822359483708 5.336743328747215; 5.336741259221823 5.138532342635818 … 4.578540488249746 5.138535654150775; … ; 4.7578170633177175 4.578535355428009 … 4.083589028428055 4.578537437452565; 5.3367402085728255 5.138531168665634 … 4.578540592443358 5.1385351823940155]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-1.0076494372518106 -0.9757275422836951 … -0.8487259887526002 -0.9757293909255396; -0.9757278722652621 -0.9294378912709783 … -0.8473040975359948 -0.9294425099901545; … ; -0.848711999479939 -0.8473133467476611 … -0.667233843342842 -0.8473124327222437; -0.9757302497079937 -0.9294369251638113 … -0.8473061044157593 -0.9294395090796387;;; -0.9898303783013439 -0.9544031243082706 … -0.9009191658658526 -0.9544054936916475; -0.9544046116470837 -0.9322520383314498 … -0.8785200738994712 -0.9322539062099471; … ; -0.9009216867948141 -0.878517460737353 … -0.7914272949803857 -0.8785181080299388; -0.9544069653434245 -0.9322560252825186 … -0.8785194058402133 -0.932256070324335;;; -0.7546865524590856 -0.856612717071283 … -0.9144796485137543 -0.856613854401417; -0.8566098760549122 -0.8894518750677928 … -0.9071520504346526 -0.8894544074246967; … ; -0.9144812035093092 -0.9071529889412354 … -0.8647678952512021 -0.9071534046479466; -0.8566177462731296 -0.8894575135910552 … -0.9071516859698446 -0.8894564497267524;;; … ;;; -0.6145690562843968 -0.8437356050379026 … -0.968591178200348 -0.8437397193759248; -0.8437346734239226 -0.9186038705500604 … -0.9582364276516913 -0.9186066799699795; … ; -0.9685880556337861 -0.9582343349007632 … -0.9351658353152965 -0.958234008105128; -0.84374004678368 -0.9186077744470742 … -0.9582383608740735 -0.9186092475447007;;; -0.7547177695141335 -0.856627529630298 … -0.9144882669481719 -0.8566366139560915; -0.8566279028320363 -0.8894629888679402 … -0.9071593763793343 -0.8894697969045224; … ; -0.9144836504251244 -0.9071575070866018 … -0.8647721563343986 -0.9071582219031525; -0.8566331315290421 -0.8894674499691185 … -0.9071622564747404 -0.8894724662566506;;; -0.9898461802462032 -0.9544205369541834 … -0.9009319757427787 -0.9544249488713885; -0.9544187510080963 -0.9322689606516045 … -0.8785247704574493 -0.9322738804392219; … ; -0.9009269988709041 -0.8785237080104458 … -0.7914346856663536 -0.8785239494106329; -0.9544217437320794 -0.9322693773808218 … -0.8785289344875817 -0.9322733378380089]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), [-3.1959925959992983 -2.8149862685399043 … -2.0363193914132585 -2.814985902721272; -2.8149861544063026 -2.5020668944453077 … -1.891968448402971 -2.5020700113930867; … ; -2.036306192677974 -1.8919776892342992 … -1.402841930865948 -1.89197621788541; -2.8149874273082527 -2.5020649430116757 … -1.891969300952514 -2.5020657955808656;;; -4.350323166687414 -3.7053883442994833 … -2.5161435331208972 -3.705391036822187; -3.7053921204718225 -3.2115407235938362 … -2.2573314974907106 -3.2115429562568405; … ; -2.516141621764807 -2.2573229458429744 … -1.691830156604384 -2.2573245883205497; -3.70539012597005 -3.2115406672982414 … -2.2573282037703852 -3.2115413726331616;;; -12.704003299892205 -7.969216343014038 … -3.5414748193536183 -7.969220055857759; -7.969218071068805 -5.684393269756001 … -3.07398716479405 -5.6843978902810575; … ; -3.5414680487892864 -3.073977570152711 … -2.1403621214811195 -3.073980287401846; -7.969219293976973 -5.684392697515138 … -3.073983029181623 -5.684394350990038;;; … ;;; -28.842446753777214 -14.825334047674751 … -4.220277624789576 -14.825333852166334; -14.825328513530389 -8.860612738979695 … -3.60959420779506 -8.860612062333434; … ; -4.220283101079511 -3.609601993217929 … -2.4261335079494235 -3.6095996011008857; -14.82533897387926 -8.860621303594147 … -3.609599030045384 -8.860618985722859;;; -12.703931485837412 -7.969134955914627 … -3.5413881801745544 -7.96913842908169; -7.969131455480406 -5.6843066806398745 … -3.0739017473400883 -5.684309262730023; … ; -3.5413915521887667 -3.0739084197396602 … -2.140295393471851 -3.0739063247520315; -7.9691394264432835 -5.684313931309759 … -3.0739056869838173 -5.684313937885412;;; -4.350273916277911 -3.705346170482991 … -2.516099952669527 -3.705345984154761; -3.7053418558168607 -3.211498421551131 … -2.2572821031903256 -3.211500029823791; … ; -2.5161002719636416 -2.2572861735650585 … -1.691796961234009 -2.2572843329406913; -3.705345899189843 -3.2115000122505335 … -2.257286163026847 -3.211499958979339]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, @NamedTuple{ψ_reals::Array{ComplexF64, 3}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)]), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-7.847975050004952 -7.268428440205683 … -5.98643217347949 -7.268428440205681; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765; … ; -5.986432173479489 -5.654662671267517 … -4.834867151162882 -5.654662671267517; -7.268428440205682 -6.7817494477990765 … -5.654662671267517 -6.7817494477990765;;; -8.899434405774723 -8.087664364030587 … -6.3729903364104565 -8.087664364030587; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982624; -8.087664364030587 -7.417761803535345 … -5.957297820982622 -7.417761803535345;;; -17.194464781057807 -12.215015836029425 … -7.260147533467604 -12.215015836029423; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.64150844055725 … -5.290773463061557 -6.64150844055725; -12.215015836029426 -9.745491274759289 … -6.641508440557249 -9.745491274759289;;; … ;;; -33.141052514545024 -18.79024317674381 … -7.6659314039290605 -18.790243176743807; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646; … ; -7.66593140392906 -6.922947356511528 … -5.334312872497847 -6.922947356511528; -18.79024317674381 -12.629452027419646 … -6.922947356511528 -12.629452027419646;;; -17.194464781057807 -12.215015836029423 … -7.260147533467603 -12.215015836029423; -12.215015836029425 -9.745491274759289 … -6.641508440557249 -9.745491274759289; … ; -7.260147533467602 -6.641508440557249 … -5.290773463061556 -6.64150844055725; -12.215015836029425 -9.74549127475929 … -6.641508440557249 -9.74549127475929;;; -8.899434405774725 -8.087664364030587 … -6.372990336410456 -8.087664364030587; -8.087664364030587 -7.4177618035353445 … -5.957297820982622 -7.4177618035353445; … ; -6.372990336410455 -5.957297820982622 … -4.983951303995711 -5.957297820982623; -8.087664364030589 -7.417761803535345 … -5.957297820982623 -7.417761803535345]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [5.659631891257464 5.429169713949474 … 4.798838770818832 5.429171928409948; 5.429170158064641 5.209120444624747 … 4.609998320400541 5.209121946396144; … ; 4.798837980281454 4.609998328780879 … 4.099259063639776 4.609998886104351; 5.429171262605423 5.209121429951212 … 4.609999474730762 5.20912316129785;;; 5.538941617388653 5.336679144039374 … 4.757765969155412 5.3366788209000475; 5.336676855205848 5.138473118272959 … 4.578486397391383 5.138472753488452; … ; 4.757770401440462 4.578492335877001 … 4.083548442371712 4.578491340692013; 5.336681203403962 5.1384771615196225 … 4.57848902305245 5.138476501226519;;; 5.2451480336246865 5.10241221008667 … 4.63315236262774 5.102409634573081; 5.1024076410155335 4.9505498800710805 … 4.474673326197852 4.9505477919029275; … ; 4.633160688187625 4.474683859345775 … 4.0151792368316395 4.4746815578033505; 5.1024142883255825 4.950556090835206 … 4.474677097345471 4.950553373496003;;; … ;;; 4.913174817052205 4.808644734106963 … 4.414244957339832 4.808649043953397; 4.8086493366373455 4.687443158990011 … 4.271589576368159 4.687446645056192; … ; 4.414236358483334 4.271579698194362 … 3.84334519986372 4.27158176351577; 4.80864424964823 4.687438498272574 … 4.271586687340217 4.687442289241488;;; 5.245251064734529 5.102508409745094 … 4.633247620241221 5.102514020903824; 5.102512283381055 4.950647582987354 … 4.4747660695964955 4.950651808933788; … ; 4.63323963170396 4.474757527904191 … 4.015250225924103 4.474760337708371; 5.102509541115183 4.95064479341865 … 4.474765010048173 4.950649803130529;;; 5.539006669743017 5.3367387305017795 … 4.757822359483708 5.336743328747215; 5.336741259221823 5.138532342635818 … 4.578540488249746 5.138535654150775; … ; 4.7578170633177175 4.578535355428009 … 4.083589028428055 4.578537437452565; 5.3367402085728255 5.138531168665634 … 4.578540592443358 5.1385351823940155]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-1.0125324480676532 -0.9779411370009408 … -0.9029801515434916 -0.9779410660915903; -0.977940617590344 -0.9435932090075227 … -0.8431595946242495 -0.94359206127456; … ; -0.9029980492271912 -0.8431437369396323 … -0.7668256926001779 -0.8431453554626087; -0.9779396723137325 -0.9435931808699582 … -0.8431598255755895 -0.943594157701787;;; -1.002485891035877 -0.9662067004753297 … -0.8942832789676756 -0.9662062982274937; -0.9662056478745289 -0.9380000501307434 … -0.8653545354658166 -0.9379993154152563; … ; -0.8942850074696866 -0.8653570617243717 … -0.7841594400133419 -0.8653570522153644; -0.9662053773045184 -0.9379993252103314 … -0.8653554866821489 -0.9380001712544804;;; -0.8144982430074291 -0.8328715550317639 … -0.8251475975886302 -0.8328700971357169; -0.8328722117880567 -0.8329463881025327 … -0.8158419674822275 -0.8329434802713203; … ; -0.8251497685330766 -0.8158461368821486 … -0.7766017570692866 -0.8158453577899398; -0.8328706046341185 -0.8329447072169073 … -0.8158438007880681 -0.8329448008928082;;; … ;;; -0.6906035802056317 -0.7862496847366728 … -0.8336587171834449 -0.7862503181123989; -0.7862530693759646 -0.812007398710855 … -0.8254066642299339 -0.8120074361569214; … ; -0.8336572445445145 -0.8254022339627227 … -0.8094497536153635 -0.8254052360696156; -0.7862483791145152 -0.8120018206931112 … -0.8254044719147637 -0.8120050775066625;;; -0.8145003171357382 -0.8328843717223949 … -0.8251708398516285 -0.8328838582582475; -0.8328856758046921 -0.8329644751342381 … -0.8158671468469461 -0.8329623940923582; … ; -0.8251707881759157 -0.8158649277044935 … -0.776623034469168 -0.8158681194926446; -0.8328836030446883 -0.8329605790625045 … -0.8158664203968901 -0.832962492778728;;; -1.0024925546687842 -0.9662131691284102 … -0.8942964970182501 -0.9662138036330068; -0.9662135146519042 -0.9380088297870066 … -0.8653702920313502 -0.9380079416009677; … ; -0.8942974588677347 -0.8653692963921753 … -0.7841710167781833 -0.8653719800664574; -0.966213252827129 -0.9380079537151369 … -0.8653700862401057 -0.9380089798968222]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141))], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [0.0, 0.24369393582936685, 0.9747757433174674, 2.1932454224643014, 3.8991029732698697, 6.092348395734172, 8.772981689857206, 8.772981689857206, 6.092348395734172, 3.8991029732698697  …  2.680633294123035, 4.386490844928604, 6.5797362673929065, 9.260369561515938, 9.260369561515938, 6.5797362673929065, 4.386490844928604, 2.680633294123035, 1.4621636149762012, 0.7310818074881006]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), [-3.200875606815141 -2.8171998632571498 … -2.09057355420415 -2.817197577887323; -2.8171988997313844 -2.516222212181852 … -1.8878239454912258 -2.516219562677492; … ; -2.0905922424252266 -1.8878080794262706 … -1.502433780123284 -1.887809140625775; -2.817196849913991 -2.5162211987178225 … -1.8878230221123444 -2.5162204442030136;;; -4.362978679421947 -3.7171919204665427 … -2.50950764622272 -3.7171918413580336; -3.7171931566992678 -3.21728873539313 … -2.2441659590570557 -3.2172883654621494; … ; -2.5095049424396794 -2.244162546829993 … -1.6845623016373406 -2.2441635325059752; -3.717188537931144 -3.217283967226054 … -2.244164284612321 -3.217285473563307;;; -12.76381499044055 -7.945475180974518 … -3.4521427684284944 -7.945476298592059; -7.945480406801949 -5.627887782790741 … -2.982677081841625 -5.627886963127681; … ; -3.452136613813054 -2.9826707180936243 … -2.052195983299204 -2.9826722405438395; -7.945472152337962 -5.62787989114099 … -2.9826751439998462 -5.627882702156094;;; … ;;; -28.91848127769845 -14.76784812737352 … -4.085345163772673 -14.767844450902809; -14.767846909482431 -8.75401626714049 … -3.4767644443733023 -8.754012818520374; … ; -4.08535228999024 -3.476769892279888 … -2.3004174262494903 -3.476770829065373; -14.767847306210095 -8.754015349840184 … -3.4767651410860747 -8.754014815684819;;; -12.763714033459017 -7.945391798006724 … -3.452070753078011 -7.945385673383846; -7.945389228453062 -5.627808166906172 … -2.9826095178077 -5.6278018599178585; … ; -3.452078689939558 -2.982615840357552 … -2.0521462716066203 -2.9826162223415236; -7.94538989795893 -5.6278070604031445 … -2.9826098509059666 -5.62780396440749;;; -4.362920290700492 -3.717138802657218 … -2.5094644739449983 -3.7171348389163796; -3.7171366194606685 -3.217238290686533 … -2.2441276247642263 -3.217234090985537; … ; -2.509470731960472 -2.2441317619467878 … -1.6845332923458387 -2.2441323635965156; -3.7171374082848923 -3.2172385885848485 … -2.2441273147793708 -3.217235601038152]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), KPoint([     0,      0,      0], spin = 2, num. G vectors =  1141), ComplexF64[0.025674506039111318 + 0.0im 0.025674506039111318 + 0.0im; 0.025370853334774908 + 0.0im 0.025370853334774908 + 0.0im; … ; 0.017882114168679287 + 0.01586532494596619im 0.017882114168679287 - 0.01586532494596619im; 0.018531899211158255 + 0.016441825618465737im 0.018531899211158255 - 0.016441825618465737im], [18.33745811 0.0; 0.0 18.33745811]), nothing, @NamedTuple{ψ_reals::Array{ComplexF64, 3}}[(ψ_reals = [0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im],)])]), basis = PlaneWaveBasis(model = Model(gga_x_pbe+gga_c_pbe, spin_polarization = :collinear), Ecut = 10.0 Ha, kgrid = MonkhorstPack([1, 1, 1])), energies = Energies(total = -28.93961286221982), converged = true, occupation_threshold = 1.0e-6, ρ = [0.4340066029102616 0.3834946788259117 … 0.2550028337128703 0.3834980213444999; 0.38349570591345183 0.3371178394455411 … 0.22213129003493778 0.3371210315031226; … ; 0.255000310412723 0.22212969621699066 … 0.14465939686036408 0.22212984620122564; 0.38349624680311656 0.3371192939206818 … 0.22213140557434033 0.3371209914070929;;; 0.3631821588695239 0.3478207810530982 … 0.2720080390697934 0.34782270050598807; 0.3478199541002002 0.3262290791358699 … 0.24597255209504773 0.32623167234295064; … ; 0.27200879236868536 0.24597314289307273 … 0.17358973614978462 0.24597322279549494; 0.34782313119949543 0.3262325273421382 … 0.24597259929320725 0.3262331516863931;;; 0.2138091867072394 0.2733243697632534 … 0.31033608293574216 0.2733250384860549; 0.2733220226741228 0.30471977222219493 … 0.2991573580998079 0.3047217086893857; … ; 0.31033839157261955 0.29915889706512194 … 0.23806301639820227 0.2991589748129892; 0.2733265064775129 0.30472408254791256 … 0.29915720556030223 0.30472387194666073;;; … ;;; 0.14404135271956117 0.24611084085983542 … 0.3458781447309894 0.24611337692858892; 0.2461107910777462 0.3074642050649135 … 0.34267363836098924 0.30746638811134736; … ; 0.34587474625540776 0.3426726620089668 … 0.2858676837441638 0.3426726203813275; 0.24611245033447368 0.30746649198556575 … 0.3426757801036749 0.30746800320502965;;; 0.21382548959358705 0.27333605511142567 … 0.3103478013133856 0.2733417567940724; 0.27333669069136063 0.30473072442257343 … 0.29916542867719015 0.3047352665852679; … ; 0.31034272078407665 0.2991631024494197 … 0.23806791494509053 0.2991641228725991; 0.27333940005013 0.3047338999326468 … 0.2991680844840699 0.30473780145988044;;; 0.36320211235239613 0.34783549109418704 … 0.27201849205616496 0.3478406629433779; 0.3478367309069165 0.3262416779313761 … 0.24597986383929069 0.3262458935428411; … ; 0.2720137705290645 0.24597733036804129 … 0.17359312560703363 0.24597800869328312; 0.34783790261331216 0.3262436578026674 … 0.24598133190359278 0.32624693129300136;;;; 0.4383344905690616 0.38778287742637657 … 0.2592259566108207 0.3877830899677886; 0.3877833465760588 0.3413811038095369 … 0.22629200384639145 0.3413802872717531; … ; 0.2592264886752779 0.2262921273036203 … 0.14854555140375697 0.22629299396893024; 0.3877833085169067 0.34138002376900045 … 0.2262926234450026 0.34138106828383646;;; 0.36527841296658686 0.3372204402867562 … 0.24769176999019246 0.33722006924664616; 0.33722070031994855 0.3077647247743079 … 0.22138128199107057 0.3077634100808447; … ; 0.24769318918066327 0.22138278093726832 … 0.1535817440906909 0.22138288266224687; 0.33722071511526597 0.30776398379917613 … 0.2213821582231615 0.3077642684819627;;; 0.21243936973834832 0.23093276280135272 … 0.2224128872368817 0.23093166821246877; 0.23093250976473523 0.2365805046057447 … 0.20984936237955296 0.23657868429537499; … ; 0.2224156183798238 0.2098526747247624 … 0.1627831579893613 0.20985189947098834; 0.23093309916459265 0.23658060653966373 … 0.20985061915235736 0.23657995851062924;;; … ;;; 0.14216588014429754 0.1825332451360993 … 0.2117905564811371 0.18253470968398516; 0.18253507623211546 0.2045690529885389 … 0.20538102175290524 0.204569926207109; … ; 0.21178870593537413 0.20537724390882772 … 0.16725183994448564 0.20537928058683105; 0.18253341515502589 0.20456655651146097 … 0.20537973560290523 0.2045687552941755;;; 0.21244849361177576 0.23094566311423978 … 0.2224327221396159 0.23094684575104174; 0.2309468708720405 0.23659687648018105 … 0.20986935196594103 0.2365970750191739; … ; 0.22243180771439156 0.20986685058641802 … 0.16279718515254257 0.20986897109258848; 0.2309462753835867 0.23659493642258486 … 0.20986906593440705 0.23659718332369162;;; 0.36528911756176197 0.33723195068308964 … 0.24770440851566203 0.3372327067114357; 0.33723268805730916 0.30777687173470913 … 0.22139338529098573 0.30777654332978355; … ; 0.24770425365997 0.2213922472520763 … 0.15359004396073467 0.22139385247979457; 0.3372325956456356 0.30777546186036564 … 0.22139370716373385 0.30777722885579595], α = 0.8, eigenvalues = [[-1.3338443842313403, -0.7233659880740952, -0.4453003017458639, -0.44529906212772363, -0.4063263939466899, -0.05924833621607942, -0.05924731686850451, 0.015411423698798807, 0.19521841590182482, 0.20823186623666423, 0.2420673910620458], [-1.3005659835973047, -0.6618073485436247, -0.3897645061729962, -0.38976316062862293, -0.37369379927914015, 0.014976602426214295, 0.014978074948982376, 0.028053543378925412, 0.20775428749088598, 0.2142967677944485, 0.2578574597064979]], occupation = [[1.0, 1.0, 1.0, 1.0, 1.0, 0.9947345595040451, 0.9947334680536563, 0.0032507911559087393, 4.714156925178331e-54, 1.97692942608607e-60, 9.985029738249084e-79], [1.0, 1.0, 1.0, 1.0, 1.0, 0.0035661421342624844, 0.003565029399567126, 0.00015000975256063408, 3.4396192374561627e-60, 1.5799612594021993e-63, 4.0978824130075893e-88]], εF = -0.023074281456679457, n_bands_converge = 9, n_iter = 1, ψ = Matrix{ComplexF64}[[0.2616899782347602 - 0.041839152995329774im 4.653866677376605e-6 - 3.10637103182149e-6im … -0.06977709296156878 - 0.03919785723770287im 3.255985193573921e-5 + 2.50344537999159e-5im; 0.19763925099632249 - 0.03159795419256281im 2.811970543728214e-6 - 2.153198236389751e-6im … -0.08504877199309274 - 0.0476746361242396im 0.3634101080210916 + 0.07021779759669966im; … ; 0.06010557354525842 - 0.009610422724685317im -0.03598153525076404 - 0.052902361551884165im … -0.015609345529941341 - 0.008765539795785928im 0.005748102773919352 + 0.014486104713454797im; 0.11030722192019982 - 0.01764012404692722im -0.07741291494265609 - 0.11382049208416112im … -0.01360705507567513 - 0.00764454231874827im -0.009374650841891397 + 0.031328095393765236im], [0.13493035949330895 + 0.22399749524658927im 2.57426897879665e-6 - 5.821145789117784e-6im … 0.08446584622401451 + 0.0018906919737413529im 5.408638048160449e-7 + 2.0991775110781524e-5im; 0.10184614845914725 + 0.16907457303760215im -2.1173557303080947e-6 - 5.067035678113681e-6im … 0.09522722273239494 + 0.002097897620898131im 0.3321213136890745 - 0.1734711789955827im; … ; 0.03139967374515935 + 0.052124263881485146im -0.059073870901573684 - 0.02613846273309671im … 0.017195171185356385 + 0.00038505248770208253im 0.016440294282562083 + 0.007539379303504099im; 0.05749963125436195 + 0.09545056314393356im -0.1265856105122918 - 0.056011562912137054im … 0.014998149051485067 + 0.00033739651734685715im 0.019174843584207794 + 0.03016016708938067im]], diagonalization = @NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}[(λ = [[-1.3338443842313403, -0.7233659880740952, -0.4453003017458639, -0.44529906212772363, -0.4063263939466899, -0.05924833621607942, -0.05924731686850451, 0.015411423698798807, 0.19521841590182482, 0.20823186623666423, 0.2420673910620458], [-1.3005659835973047, -0.6618073485436247, -0.3897645061729962, -0.38976316062862293, -0.37369379927914015, 0.014976602426214295, 0.014978074948982376, 0.028053543378925412, 0.20775428749088598, 0.2142967677944485, 0.2578574597064979]], X = [[0.2616899782347602 - 0.041839152995329774im 4.653866677376605e-6 - 3.10637103182149e-6im … -0.06977709296156878 - 0.03919785723770287im 3.255985193573921e-5 + 2.50344537999159e-5im; 0.19763925099632249 - 0.03159795419256281im 2.811970543728214e-6 - 2.153198236389751e-6im … -0.08504877199309274 - 0.0476746361242396im 0.3634101080210916 + 0.07021779759669966im; … ; 0.06010557354525842 - 0.009610422724685317im -0.03598153525076404 - 0.052902361551884165im … -0.015609345529941341 - 0.008765539795785928im 0.005748102773919352 + 0.014486104713454797im; 0.11030722192019982 - 0.01764012404692722im -0.07741291494265609 - 0.11382049208416112im … -0.01360705507567513 - 0.00764454231874827im -0.009374650841891397 + 0.031328095393765236im], [0.13493035949330895 + 0.22399749524658927im 2.57426897879665e-6 - 5.821145789117784e-6im … 0.08446584622401451 + 0.0018906919737413529im 5.408638048160449e-7 + 2.0991775110781524e-5im; 0.10184614845914725 + 0.16907457303760215im -2.1173557303080947e-6 - 5.067035678113681e-6im … 0.09522722273239494 + 0.002097897620898131im 0.3321213136890745 - 0.1734711789955827im; … ; 0.03139967374515935 + 0.052124263881485146im -0.059073870901573684 - 0.02613846273309671im … 0.017195171185356385 + 0.00038505248770208253im 0.016440294282562083 + 0.007539379303504099im; 0.05749963125436195 + 0.09545056314393356im -0.1265856105122918 - 0.056011562912137054im … 0.014998149051485067 + 0.00033739651734685715im 0.019174843584207794 + 0.03016016708938067im]], residual_norms = [[8.27167507889814e-5, 5.116981018168566e-5, 7.48592473636605e-5, 7.237031751920091e-5, 3.4111592232526636e-5, 9.925402536841353e-5, 6.58504885850331e-5, 6.879527825395837e-6, 8.929200757438833e-5, 0.00020679116430971206, 0.005041224375420502], [1.21086502654768e-5, 4.256399818412339e-5, 3.551922387368096e-5, 4.3839920027825366e-5, 4.676638264413225e-6, 4.2872617636930036e-5, 4.3337738486130485e-5, 9.96776818217159e-7, 9.952418504212912e-6, 3.4805416064092e-5, 0.005478852175358315]], n_iter = [18, 6], converged = 1, n_matvec = 233)], stage = :finalize, history_Δρ = [0.00043762046821938915], history_Etot = [-28.93961286221982], runtime_ns = 0x000000000dff880e, algorithm = &quot;SCF&quot;)</code></pre><p>Since only the density is stored in a checkpoint (and not the Bloch waves), the first step needs a slightly elevated number of diagonalizations. Notice, that reconstructing the <code>checkpointargs</code> in this second call is important as the <code>checkpointargs</code> now contain different data, such that the SCF continues from the checkpoint. By default checkpoint is saved in the file <code>dftk_scf_checkpoint.jld2</code>, which can be changed using the <code>filename</code> keyword argument of <a href="../../api/#DFTK.kwargs_scf_checkpoints-Tuple{DFTK.AbstractBasis}"><code>kwargs_scf_checkpoints</code></a>. Note that the file is not deleted by DFTK, so it is your responsibility to clean it up. Further note that warnings or errors will arise if you try to use a checkpoint, which is incompatible with your calculation.</p><p>We can also inspect the checkpoint file manually using the <code>load_scfres</code> function and use it manually to continue the calculation:</p><pre><code class="language-julia hljs">oldstate = load_scfres(&quot;dftk_scf_checkpoint.jld2&quot;)
scfres   = self_consistent_field(oldstate.basis, ρ=oldstate.ρ, ψ=oldstate.ψ, tol=1e-4);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)   Magnet   Diag   Δtime
---   ---------------   ---------   ---------   ------   ----   ------
  1   -28.93862290754                   -2.30    1.986    5.5    107ms
  2   -28.93946589654       -3.07       -2.72    1.985    1.0   64.9ms
  3   -28.93961163896       -3.84       -2.59    1.985    4.0   89.1ms
  4   -28.93961236534       -6.14       -2.72    1.985    1.0   60.2ms
  5   -28.93961285353       -6.31       -2.88    1.985    1.0   61.4ms
  6   -28.93961293052       -7.11       -2.95    1.985    1.0   61.2ms
  7   -28.93961309827       -6.78       -3.23    1.985    1.0   74.0ms
  8   -28.93961314562       -7.32       -3.47    1.985    1.0   62.5ms
  9   -28.93961316225       -7.78       -3.74    1.985    1.5   67.0ms
 10   -28.93961317204       -8.01       -4.63    1.985    2.0   69.9ms</code></pre><p>Some details on what happens under the hood in this mechanism: When using the <code>kwargs_scf_checkpoints</code> function, the <code>ScfSaveCheckpoints</code> callback is employed during the SCF, which causes the density to be stored to the JLD2 file in every iteration. When reading the file, the <code>kwargs_scf_checkpoints</code> transparently patches away the <code>ψ</code> and <code>ρ</code> keyword arguments and replaces them by the data obtained from the file. For more details on using callbacks with DFTK&#39;s <code>self_consistent_field</code> function see <a href="../../examples/scf_callbacks/#Monitoring-self-consistent-field-calculations">Monitoring self-consistent field calculations</a>.</p><p>(Cleanup files generated by this notebook)</p><pre><code class="language-julia hljs">rm(&quot;dftk_scf_checkpoint.jld2&quot;)
rm(&quot;scfres.jld2&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parallelization/">« Timings and parallelization</a><a class="docs-footer-nextpage" href="../compute_clusters/">Using DFTK on compute clusters »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Monday 15 January 2024 13:24">Monday 15 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
