<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Modelling atomic chains · DFTK.jl</title><meta name="title" content="Modelling atomic chains · DFTK.jl"/><meta property="og:title" content="Modelling atomic chains · DFTK.jl"/><meta property="twitter:title" content="Modelling atomic chains · DFTK.jl"/><meta name="description" content="Documentation for DFTK.jl."/><meta property="og:description" content="Documentation for DFTK.jl."/><meta property="twitter:description" content="Documentation for DFTK.jl."/><meta property="og:url" content="https://docs.dftk.org/stable/guide/atomic_chains/"/><meta property="twitter:url" content="https://docs.dftk.org/stable/guide/atomic_chains/"/><link rel="canonical" href="https://docs.dftk.org/stable/guide/atomic_chains/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li></ul></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../periodic_problems/">Periodic problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../discretisation/">Comparing discretization techniques</a></li><li class="is-active"><a class="tocitem" href>Modelling atomic chains</a><ul class="internal"><li><a class="tocitem" href="#Monoatomic-chain"><span>Monoatomic chain</span></a></li><li><a class="tocitem" href="#Diatomic-chain"><span>Diatomic chain</span></a></li><li><a class="tocitem" href="#Solutions"><span>Solutions</span></a></li></ul></li><li><a class="tocitem" href="../density_functional_theory/">Introduction to density-functional theory</a></li><li><a class="tocitem" href="../self_consistent_field/">Self-consistent field methods</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../../examples/metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../../examples/collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../../examples/convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../../examples/pseudopotentials/">Pseudopotentials</a></li><li><a class="tocitem" href="../../examples/supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../../examples/gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../../examples/graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../../examples/geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../../examples/energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../../examples/polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../../examples/forwarddiff/">Polarizability using automatic differentiation</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../../examples/atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../../examples/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../examples/wannier/">Wannierization using Wannier.jl or Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../../tricks/compute_clusters/">Using DFTK on compute clusters</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../../examples/custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../../examples/scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../../examples/compare_solvers/">Comparison of DFT solvers</a></li><li><a class="tocitem" href="../../examples/analysing_scf_convergence/">Analysing SCF convergence</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../../examples/gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../../examples/gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../../examples/custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../../examples/cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../../examples/anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../../examples/arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../../examples/error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/setup/">Developer setup</a></li><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/style_guide/">Developer&#39;s style guide</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li><li><a class="tocitem" href="../../developer/gpu_computations/">GPU computations</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Background</a></li><li class="is-active"><a href>Modelling atomic chains</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Modelling atomic chains</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/docs/src/guide/atomic_chains.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Modelling-atomic-chains"><a class="docs-heading-anchor" href="#Modelling-atomic-chains">Modelling atomic chains</a><a id="Modelling-atomic-chains-1"></a><a class="docs-heading-anchor-permalink" href="#Modelling-atomic-chains" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=v0.6.19/guide/atomic_chains.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/v0.6.19/guide/atomic_chains.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>In <a href="../periodic_problems/#periodic-problems">Periodic problems and plane-wave discretisations</a> we already summarised the net effect of Bloch&#39;s theorem. In this notebook, we will explore some basic facts about periodic systems, starting from the very simplest model, a tight-binding monoatomic chain. The solutions to the hands-on exercises are given at the bottom of the page.</p><h2 id="Monoatomic-chain"><a class="docs-heading-anchor" href="#Monoatomic-chain">Monoatomic chain</a><a id="Monoatomic-chain-1"></a><a class="docs-heading-anchor-permalink" href="#Monoatomic-chain" title="Permalink"></a></h2><p>In this model, each site of an infinite 1D chain is a degree of freedom, and the Hilbert space is <span>$\ell^2(\mathbb Z)$</span>, the space of square-summable biinfinite sequences <span>$(\psi_n)_{n \in \mathbb Z}$</span>.</p><p>Each site interacts by a &quot;hopping term&quot; with its neighbors, and the Hamiltonian is</p><p class="math-container">\[H = \left(\begin{array}{ccccc}
  \dots&amp;\dots&amp;\dots&amp;\dots&amp;\dots \\
  \dots&amp; 0 &amp; 1 &amp; 0 &amp; \dots\\
  \dots&amp;1 &amp; 0 &amp;1&amp;\dots \\
  \dots&amp;0 &amp; 1 &amp; 0&amp; \dots  \\
  \dots&amp;\dots&amp;\dots&amp;\dots&amp;…
\end{array}\right)\]</p><div class="admonition is-success"><header class="admonition-header">Exercise 1</header><div class="admonition-body"><p>Find the eigenstates and eigenvalues of this Hamiltonian by solving the second-order recurrence relation.</p></div></div><div class="admonition is-success"><header class="admonition-header">Exercise 2</header><div class="admonition-body"><p>Do the same when the system is truncated to a finite number of <span>$N$</span> sites with periodic boundary conditions.</p></div></div><p>We are now going to code this:</p><pre><code class="language-julia hljs">function build_monoatomic_hamiltonian(N::Integer, t)
    H = zeros(N, N)
    for n = 1:N-1
        H[n, n+1] = H[n+1, n] = t
    end
    H[1, N] = H[N, 1] = t  # Periodic boundary conditions
    H
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">build_monoatomic_hamiltonian (generic function with 1 method)</code></pre><div class="admonition is-success"><header class="admonition-header">Exercise 3</header><div class="admonition-body"><p>Compute the eigenvalues and eigenvectors of this Hamiltonian. Plot them, and check whether they agree with theory.</p></div></div><h2 id="Diatomic-chain"><a class="docs-heading-anchor" href="#Diatomic-chain">Diatomic chain</a><a id="Diatomic-chain-1"></a><a class="docs-heading-anchor-permalink" href="#Diatomic-chain" title="Permalink"></a></h2><p>Now we are going to consider a diatomic chain <code>A B A B ...</code>, where the coupling <code>A&lt;-&gt;B</code> (<span>$t_1$</span>) is different from the coupling <code>B&lt;-&gt;A</code> (<span>$t_2$</span>). We will use a new index <span>$\alpha$</span> to denote the <code>A</code> and <code>B</code> sites, so that wavefunctions are now sequences <span>$(\psi_{\alpha n})_{\alpha \in \{1, 2\}, n \in \mathbb Z}$</span>.</p><div class="admonition is-success"><header class="admonition-header">Exercise 4</header><div class="admonition-body"><p>Show that eigenstates of this system can be looked for in the form</p><p class="math-container">\[   \psi_{\alpha n} = u_{\alpha} e^{ikn}\]</p></div></div><div class="admonition is-success"><header class="admonition-header">Exercise 5</header><div class="admonition-body"><p>Show that, if <span>$\psi$</span> is of the form above</p><p class="math-container">\[   (H \psi)_{\alpha n} = (H_k u)_\alpha e^{ikn},\]</p><p>where</p><pre><code class="nohighlight hljs">H_k = \left(\begin{array}{cc}
0                &amp; t_1 + t_2 e^{-ik}\\
t_1 + t_2 e^{ik} &amp; 0
\end{array}\right)</code></pre></div></div><p>Let&#39;s now check all this numerically:</p><pre><code class="language-julia hljs">function build_diatomic_hamiltonian(N::Integer, t1, t2)
    # Build diatomic Hamiltonian with the two couplings
    # ... &lt;-t2-&gt;   A &lt;-t1-&gt; B &lt;-t2-&gt;   A &lt;-t1-&gt; B &lt;-t2-&gt;   ...
    # We introduce unit cells as such:
    # ... &lt;-t2-&gt; | A &lt;-t1-&gt; B &lt;-t2-&gt; | A &lt;-t1-&gt; B &lt;-t2-&gt; | ...
    # Thus within a cell the A&lt;-&gt;B coupling is t1 and across cell boundaries t2

    H = zeros(2, N, 2, N)
    A, B = 1, 2
    for n = 1:N
        H[A, n, B, n] = H[B, n, A, n] = t1  # Coupling within cell
    end
    for n = 1:N-1
        H[B, n, A, n+1] = H[A, n+1, B, n] = t2  # Coupling across cells
    end
    H[A, 1, B, N] = H[B, N, A, 1] = t2  # Periodic BCs (A in cell1 with B in cell N)
    reshape(H, 2N, 2N)
end

function build_diatomic_Hk(k::Integer, t1, t2)
    # Returns Hk such that H (u e^ikn) = (Hk u) e^ikn
    #
    # intra-cell AB hopping of t1, plus inter-cell hopping t2 between
    # site B (no phase shift) and site A (phase shift e^ik)
    [0                 t1 + t2*exp(-im*k);
     t1 + t2*exp(im*k) 0                 ]
end

using Plots
function plot_wavefunction(ψ)
    p = plot(real(ψ[1:2:end]), label=&quot;Re A&quot;)
    plot!(p, real(ψ[2:2:end]), label=&quot;Re B&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">plot_wavefunction (generic function with 1 method)</code></pre><div class="admonition is-success"><header class="admonition-header">Exercise 6</header><div class="admonition-body"><p>Check the above assertions. Use a <span>$k$</span> of the form <span>$2 π \frac{l}{N}$</span> in order to have a <span>$\psi$</span> that has the periodicity of the supercell (<span>$N$</span>).</p></div></div><div class="admonition is-success"><header class="admonition-header">Exercise 7</header><div class="admonition-body"><p>Plot the band structure, i.e. the eigenvalues of <span>$H_k$</span> as a function of <span>$k$</span> Use the function <code>build_diatomic_Hk</code> to build the Hamiltonians. Compare with the eigenvalues of the (&quot;supercell&quot;) Hamiltonian from <code>build_diatomic_hamiltonian</code>. In the case <span>$t_1 = t_2$</span>, how do the bands follow from the previous study of the monoatomic chain?</p></div></div><div class="admonition is-success"><header class="admonition-header">Exercise 8</header><div class="admonition-body"><p>Repeat the above analysis in the case of a finite-difference discretization of a continuous Hamiltonian <span>$H = - \frac 1 2 \Delta + V(x)$</span> where <span>$V$</span> is periodic <em>Hint:</em> It is advisable to work through <a href="../discretisation/#Comparing-discretization-techniques">Comparing discretization techniques</a> before tackling this question.</p></div></div><h2 id="Solutions"><a class="docs-heading-anchor" href="#Solutions">Solutions</a><a id="Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Solutions" title="Permalink"></a></h2><h3 id="Exercise-1"><a class="docs-heading-anchor" href="#Exercise-1">Exercise 1</a><a id="Exercise-1-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-1" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div><h3 id="Exercise-2"><a class="docs-heading-anchor" href="#Exercise-2">Exercise 2</a><a id="Exercise-2-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-2" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div><h3 id="Exercise-3"><a class="docs-heading-anchor" href="#Exercise-3">Exercise 3</a><a id="Exercise-3-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-3" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div><h3 id="Exercise-4"><a class="docs-heading-anchor" href="#Exercise-4">Exercise 4</a><a id="Exercise-4-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-4" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div><h3 id="Exercise-5"><a class="docs-heading-anchor" href="#Exercise-5">Exercise 5</a><a id="Exercise-5-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-5" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div><h3 id="Exercise-6"><a class="docs-heading-anchor" href="#Exercise-6">Exercise 6</a><a id="Exercise-6-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-6" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div><h3 id="Exercise-7"><a class="docs-heading-anchor" href="#Exercise-7">Exercise 7</a><a id="Exercise-7-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-7" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div><h3 id="Exercise-8"><a class="docs-heading-anchor" href="#Exercise-8">Exercise 8</a><a id="Exercise-8-1"></a><a class="docs-heading-anchor-permalink" href="#Exercise-8" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">TODO</header><div class="admonition-body"><p>This solution has not yet been written. Any help with a PR is appreciated.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../discretisation/">« Comparing discretization techniques</a><a class="docs-footer-nextpage" href="../density_functional_theory/">Introduction to density-functional theory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 9 May 2024 20:06">Thursday 9 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
