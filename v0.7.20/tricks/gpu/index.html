<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Using DFTK on GPUs · DFTK.jl</title><meta name="title" content="Using DFTK on GPUs · DFTK.jl"/><meta property="og:title" content="Using DFTK on GPUs · DFTK.jl"/><meta property="twitter:title" content="Using DFTK on GPUs · DFTK.jl"/><meta name="description" content="Documentation for DFTK.jl."/><meta property="og:description" content="Documentation for DFTK.jl."/><meta property="twitter:description" content="Documentation for DFTK.jl."/><meta property="og:url" content="https://docs.dftk.org/stable/tricks/gpu/"/><meta property="twitter:url" content="https://docs.dftk.org/stable/tricks/gpu/"/><link rel="canonical" href="https://docs.dftk.org/stable/tricks/gpu/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">General Tutorial</a></li><li><a class="tocitem" href="../../guide/tutorialmath/">Mathematical Tutorial</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../../examples/metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../../examples/collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../../examples/convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../../examples/pseudopotentials/">Pseudopotentials</a></li><li><a class="tocitem" href="../../examples/supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../../examples/gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../../examples/graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../../examples/geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../../examples/energy_cutoff_smearing/">Energy cutoff smearing</a></li><li><a class="tocitem" href="../../examples/hubbard/">Hubbard correction (DFT+U)</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../../examples/elastic_constants/">Elastic constants</a></li><li><a class="tocitem" href="../../examples/polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../../examples/forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../../examples/phonons/">Phonon computations</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../../ecosystem/atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../../ecosystem/atomscalculators/">AtomsCalculators integration</a></li><li><a class="tocitem" href="../../ecosystem/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../ecosystem/atomistic_simulation_environment/">Atomistic simulation environment (ASE)</a></li><li><a class="tocitem" href="../../ecosystem/wannier/">Wannierization using Wannier.jl or Wannier90</a></li></ul></li><li><span class="tocitem">Tips and tricks</span><ul><li><a class="tocitem" href="../achieving_convergence/">Achieving DFT convergence</a></li><li><a class="tocitem" href="../parallelization/">Timings and parallelization</a></li><li class="is-active"><a class="tocitem" href>Using DFTK on GPUs</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../compute_clusters/">Using DFTK on compute clusters</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../../examples/custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../../examples/scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../../examples/compare_solvers/">Comparison of DFT solvers</a></li><li><a class="tocitem" href="../../examples/analysing_scf_convergence/">Analysing SCF convergence</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../../examples/gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../../examples/gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../../examples/custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../../examples/cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../../examples/anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../../examples/arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../../examples/error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Theoretical Background</span><ul><li><a class="tocitem" href="../../guide/periodic_problems/">Periodic problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/discretisation/">Comparing discretization techniques</a></li><li><a class="tocitem" href="../../guide/atomic_chains/">Modelling atomic chains</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Introduction to density-functional theory</a></li><li><a class="tocitem" href="../../guide/self_consistent_field/">Self-consistent field methods</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/setup/">Developer setup</a></li><li><a class="tocitem" href="../../developer/testsystem/">Unit test system</a></li><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/style_guide/">Developer&#39;s style guide</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li><li><a class="tocitem" href="../../developer/gpu_computations/">GPU computations</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tips and tricks</a></li><li class="is-active"><a href>Using DFTK on GPUs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Using DFTK on GPUs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/docs/src/tricks/gpu.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-DFTK-on-GPUs"><a class="docs-heading-anchor" href="#Using-DFTK-on-GPUs">Using DFTK on GPUs</a><a id="Using-DFTK-on-GPUs-1"></a><a class="docs-heading-anchor-permalink" href="#Using-DFTK-on-GPUs" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=v0.7.20/tricks/gpu.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/v0.7.20/tricks/gpu.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>In this example we will look at how DFTK can be used on Graphics Processing Units. In its current state, runs based on Nvidia GPUs using the <a href="https://github.com/JuliaGPU/CUDA.jl">CUDA.jl</a> Julia package are better supported. Running on AMD GPUs is also possible with the <a href="https://github.com/JuliaGPU/AMDGPU.jl">AMDGPU.jl</a> package, albeit with lower performance.</p><div class="admonition is-info"><header class="admonition-header">GPU parallelism not supported everywhere</header><div class="admonition-body"><p>Not all features of DFTK are ported to the GPU. SCF and forces with standard Libxc functionals are fully supported. Stresses and response calculations are work in progress as of December 2025. In most cases there is no intrinsic limitation and typically it only takes minor code modifications to make it work on GPUs (and some extra work for optimization). If you require GPU support in one of our routines, where this is not yet supported, feel free to open an issue on github or otherwise get in touch.</p></div></div><pre><code class="language-julia hljs">using AtomsBuilder
using DFTK
using PseudoPotentialData</code></pre><p><strong>Model setup.</strong> First step is to set up a <a href="../../api/#DFTK.Model-Tuple{AtomsBase.AbstractSystem}"><code>Model</code></a> in DFTK. This proceeds exactly as in the standard CPU case (see also our <a href="../../guide/tutorial/#Tutorial">Tutorial</a>).</p><pre><code class="language-julia hljs">silicon = bulk(:Si)

model  = model_DFT(silicon;
                   functionals=PBE(),
                   pseudopotentials=PseudoFamily(&quot;dojo.nc.sr.pbe.v0_4_1.standard.upf&quot;))</code></pre><p>Next is the selection of the computational architecture. This effectively makes the choice, whether the computation will be run on the CPU or on a GPU.</p><p><strong>Nvidia GPUs.</strong> Supported via <a href="https://github.com/JuliaGPU/CUDA.jl">CUDA.jl</a>. If you install the CUDA package, all required Nvidia cuda libraries will be automatically downloaded. So literally, the only thing you have to do is:</p><pre><code class="language-julia hljs">using CUDA
architecture = DFTK.GPU(CuArray)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DFTK.GPU{CUDA.CuArray}()</code></pre><p><strong>AMD GPUs.</strong> Supported via <a href="https://github.com/JuliaGPU/AMDGPU.jl">AMDGPU.jl</a>. Here you need to <a href="https://rocm.docs.amd.com/">install ROCm</a> manually. With that in place you can then select:</p><pre><code class="language-julia hljs">using AMDGPU
architecture = DFTK.GPU(ROCArray)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DFTK.GPU{AMDGPU.ROCArray}()</code></pre><p><strong>Portable architecture selection.</strong> To make sure this script runs on the github CI (where we don&#39;t have GPUs available) we check for the availability of GPUs before selecting an architecture:</p><pre><code class="language-julia hljs">architecture = has_cuda() ? DFTK.GPU(CuArray) : DFTK.CPU()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DFTK.CPU()</code></pre><p><strong>Basis and SCF.</strong> Based on the <code>architecture</code> we construct a <a href="../../api/#DFTK.PlaneWaveBasis"><code>PlaneWaveBasis</code></a> object as usual:</p><pre><code class="language-julia hljs">basis  = PlaneWaveBasis(model; Ecut=30, kgrid=(5, 5, 5), architecture)</code></pre><p>... and run the SCF and some post-processing:</p><pre><code class="language-julia hljs">scfres = self_consistent_field(basis; tol=1e-6)
compute_forces(scfres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{StaticArraysCore.SVector{3, Float64}}:
 [-1.2258000951526476e-14, -1.6757029430602137e-14, -1.8476422401305985e-14]
 [1.3710837200105051e-14, 1.6541482744738826e-14, 1.964455268144933e-14]</code></pre><div class="admonition is-warning"><header class="admonition-header">GPU performance</header><div class="admonition-body"><p>Our current (December 2025) benchmarks show DFTK to have reasonable performance on Nvidia / CUDA GPUs with up to a 100-fold speed-up over single-threaded CPU execution (SCF + forces). A lot of work has been done to stabilize the AMDGPU implementation as well, but performance is typically lower (~20x speedup). There may still be rough edges, and we would appreciate experience or bug reports.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parallelization/">« Timings and parallelization</a><a class="docs-footer-nextpage" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 19 December 2025 17:06">Friday 19 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
